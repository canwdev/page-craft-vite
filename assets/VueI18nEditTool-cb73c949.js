import{_ as $,I as f,i as H,e as k}from"./translate-fb0da05f.js";import{d as z,j as h,q as d,m as u,a as F,r as D,s as J,u as x,b as A,o as B,K as P,i as E,L as M,k as s,l as a,T as W,F as L,z as U,n as g,p as Z,t as q,v as G,x as r,y as T,A as b,M as K,N as Q,O as X,D as Y,P as ee,G as ne}from"./index-e73e820f.js";import{_ as I,d as C,u as oe,a as te,b as ae}from"./use-file-drop-58f1619b.js";const se={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},ie=u("g",{fill:"none"},[u("path",{d:"M3 5a2 2 0 0 1 2-2h8.379a2 2 0 0 1 1.414.586l1.621 1.621A2 2 0 0 1 17 6.621V15a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5zm2-1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1v-4.5A1.5 1.5 0 0 1 6.5 10h7a1.5 1.5 0 0 1 1.5 1.5V16a1 1 0 0 0 1-1V6.621a1 1 0 0 0-.293-.707l-1.621-1.621A1 1 0 0 0 13.379 4H13v2.5A1.5 1.5 0 0 1 11.5 8h-4A1.5 1.5 0 0 1 6 6.5V4H5zm2 0v2.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5V4H7zm7 12v-4.5a.5.5 0 0 0-.5-.5h-7a.5.5 0 0 0-.5.5V16h8z",fill:"currentColor"})],-1),le=[ie],re=z({name:"Save20Regular",render:function(n,c){return d(),h("svg",se,le)}}),V={types:[{description:"JSON",accept:{"application/JSON":[".json"]}}]},pe=z({name:"VueI18nEditTool",components:{DialogTextTransformer:F,TranslateTreeItem:$,DropZone:I,Save20Regular:re},setup(){const e=D(f.parseWithRoot()),n=J(),c=async o=>{try{const t=await P(o),i=JSON.parse(t);e.value=f.parseWithRoot(i)}catch(t){console.error(t),window.$message.error(t.message)}},y=async()=>{const[o]=await window.showOpenFilePicker(V);n.value=o;const t=await o.getFile();c(t)},_=async()=>{if(!n.value)return;const o=await n.value.createWritable(),t=JSON.stringify(k(e.value),null,2);await o.write(t),await o.close(),window.$message.success("Saved!")},m=async()=>{var p;console.log(e.value);const o=JSON.stringify(k(e.value),null,2),i=await(await window.showSaveFilePicker({suggestedName:(p=n.value)==null?void 0:p.name,...V})).createWritable();await i.write(o),await i.close(),window.$message.success("Saved!")},{metaTitle:v}=x(),w=D(!1);return A(()=>{if(n.value){_();return}m()}),B(async()=>{console.log(import.meta),await C("./lib/pinyinjs/pinyin_dict_notone.min.js"),await C("./lib/pinyinjs/pinyinUtil.js")}),{metaTitle:v,translateTreeRoot:e,fileHandle:n,handleImport:c,handleSelectFile:y,handleSaveFile:_,handleExport:m,loadDemo(){e.value=f.parseWithRoot({hello_world:{section_a:{test_str:"This is a test string",test_arr:["line 1","line 2","line 3"],test_number:114514},section_b:{"":"Blur this input and it'll generate the key automatically!"},section_c:{"":"中文 is Supported"}}})},iconTranslate:H,...oe({cb:async o=>{for(const t of o.dataTransfer.items)if(t.kind==="file"){const i=await t.getAsFileSystemHandle();if(i.kind!=="directory"){n.value=i;const p=await i.getFile();await c(p)}else window.$message.error("Please drag and drop a json file here!")}}}),isShowCopyDialog:w}}});const ce=e=>(Q("data-v-f95941a5"),e=e(),X(),e),de={class:"_container"},ue=ce(()=>u("div",{style:{height:"500px"}},null,-1));function _e(e,n,c,y,_,m){const v=I,w=te,o=Y,t=M("Save20Regular"),i=ee,p=ne,N=ae,O=F,j=Z,R=$;return d(),h("div",{class:"vue-i18n-copy-tool",onDragover:n[3]||(n[3]=g((...l)=>e.fileDragover&&e.fileDragover(...l),["prevent","stop"])),onDragleave:n[4]||(n[4]=g(l=>e.showDropzone=!1,["prevent","stop"])),onDrop:n[5]||(n[5]=g((...l)=>e.fileDrop&&e.fileDrop(...l),["prevent","stop"]))},[s(W,{name:"mc-fade"},{default:a(()=>[q(s(v,{text:"Drop json file here"},null,512),[[G,e.showDropzone]])]),_:1}),s(j,{size:"small",style:{position:"sticky",top:"0","z-index":"100","margin-bottom":"10px"}},{default:a(()=>[s(N,{subtitle:"",onBack:n[1]||(n[1]=l=>e.$router.push({name:"HomeView"}))},{title:a(()=>[r(T(e.metaTitle),1)]),avatar:a(()=>[s(w,{src:e.iconTranslate,style:{background:"none"}},null,8,["src"])]),extra:a(()=>[s(p,null,{default:a(()=>[s(o,{secondary:"",size:"small",onClick:n[0]||(n[0]=l=>e.isShowCopyDialog=!0)},{default:a(()=>[r(T(e.$t("common.text_transformer")),1)]),_:1}),s(o,{type:"primary",onClick:e.handleSelectFile,size:"small"},{default:a(()=>[r(" Open JSON ")]),_:1},8,["onClick"]),e.fileHandle?(d(),b(o,{key:0,onClick:e.handleSaveFile,size:"small",type:"info"},{icon:a(()=>[s(t)]),default:a(()=>[r(" Save")]),_:1},8,["onClick"])):K("",!0),s(o,{secondary:"",onClick:e.handleExport,size:"small"},{default:a(()=>[r("Save as...")]),_:1},8,["onClick"]),s(i,{onPositiveClick:e.loadDemo},{trigger:a(()=>[s(o,{tertiary:"",size:"small"},{default:a(()=>[r("Demo")]),_:1})]),default:a(()=>[r(" Load Demo? This will override editing content. ")]),_:1},8,["onPositiveClick"])]),_:1})]),_:1}),s(O,{visible:e.isShowCopyDialog,"onUpdate:visible":n[2]||(n[2]=l=>e.isShowCopyDialog=l)},null,8,["visible"])]),_:1}),u("div",de,[(d(!0),h(L,null,U(e.translateTreeRoot,(l,S)=>(d(),b(R,{key:S,item:l,index:S},null,8,["item","index"]))),128))]),ue],32)}const fe=E(pe,[["render",_e],["__scopeId","data-v-f95941a5"]]);export{fe as default};
