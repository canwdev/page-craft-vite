import{_ as z,i as B}from"./translate-6cb999a6.js";import{d as F,i as y,q as c,l as u,a as I,r as D,K as w,s as J,u as A,b as P,o as x,L as E,M,N as T,g as W,O as L,j as s,k as a,T as U,F as Z,z as q,m as g,n as G,t as K,v as Q,x as r,y as b,A as h,P as C,Q as X,R as Y,D as ee,S as ne,G as oe}from"./index-b5795ec7.js";import{_ as N,d as V,u as te,a as ae,b as se}from"./use-file-drop-3c515e56.js";const ie={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},le=u("g",{fill:"none"},[u("path",{d:"M3 5a2 2 0 0 1 2-2h8.379a2 2 0 0 1 1.414.586l1.621 1.621A2 2 0 0 1 17 6.621V15a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5zm2-1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1v-4.5A1.5 1.5 0 0 1 6.5 10h7a1.5 1.5 0 0 1 1.5 1.5V16a1 1 0 0 0 1-1V6.621a1 1 0 0 0-.293-.707l-1.621-1.621A1 1 0 0 0 13.379 4H13v2.5A1.5 1.5 0 0 1 11.5 8h-4A1.5 1.5 0 0 1 6 6.5V4H5zm2 0v2.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5V4H7zm7 12v-4.5a.5.5 0 0 0-.5-.5h-7a.5.5 0 0 0-.5.5V16h8z",fill:"currentColor"})],-1),re=[le],pe=F({name:"Save20Regular",render:function(n,d){return c(),y("svg",ie,re)}}),$={types:[{description:"JSON",accept:{"application/JSON":[".json"]}}]},ce=F({name:"VueI18nEditTool",components:{DialogTextTransformer:I,TranslateTreeItem:z,DropZone:N,Save20Regular:pe},setup(){const e=D(w.parseWithRoot()),n=J(),d=async o=>{try{const t=await M(o),i=JSON.parse(t);e.value=w.parseWithRoot(i)}catch(t){console.error(t),window.$message.error(t.message)}},S=async()=>{const[o]=await window.showOpenFilePicker($);n.value=o;const t=await o.getFile();d(t)},m=async()=>{if(!n.value)return;const o=await n.value.createWritable(),t=JSON.stringify(T(e.value),null,2);await o.write(t),await o.close(),window.$message.success("Saved!")},_=async()=>{var p;console.log(e.value);const o=JSON.stringify(T(e.value),null,2),i=await(await window.showSaveFilePicker({suggestedName:(p=n.value)==null?void 0:p.name,...$})).createWritable();await i.write(o),await i.close(),window.$message.success("Saved!")},{metaTitle:v}=A(),f=D(!1);return P(()=>{if(n.value){m();return}_()}),x(async()=>{console.log(import.meta),await V("./lib/pinyinjs/pinyin_dict_notone.min.js"),await V("./lib/pinyinjs/pinyinUtil.js")}),E(()=>!!n.value),{metaTitle:v,translateTreeRoot:e,fileHandle:n,handleImport:d,handleSelectFile:S,handleSaveFile:m,handleExport:_,loadDemo(){e.value=w.parseWithRoot({hello_world:{section_a:{test_str:"This is a test string",test_arr:["line 1","line 2","line 3"],test_number:114514},section_b:{"":"Blur this input and it'll generate the key automatically!"},section_c:{"":"中文 is Supported"}}})},iconTranslate:B,...te({cb:async o=>{for(const t of o.dataTransfer.items)if(t.kind==="file"){const i=await t.getAsFileSystemHandle();if(i.kind!=="directory"){n.value=i;const p=await i.getFile();await d(p)}else window.$message.error("Please drag and drop a json file here!")}}}),isShowCopyDialog:f}}});const de=e=>(X("data-v-38f95210"),e=e(),Y(),e),ue={class:"_container"},me=de(()=>u("div",{style:{height:"500px"}},null,-1));function _e(e,n,d,S,m,_){const v=N,f=ae,o=ee,t=L("Save20Regular"),i=ne,p=oe,O=se,R=I,j=G,H=z;return c(),y("div",{class:"vue-i18n-copy-tool",onDragover:n[3]||(n[3]=g((...l)=>e.fileDragover&&e.fileDragover(...l),["prevent","stop"])),onDragleave:n[4]||(n[4]=g(l=>e.showDropzone=!1,["prevent","stop"])),onDrop:n[5]||(n[5]=g((...l)=>e.fileDrop&&e.fileDrop(...l),["prevent","stop"]))},[s(U,{name:"mc-fade"},{default:a(()=>[K(s(v,{text:"Drop json file here"},null,512),[[Q,e.showDropzone]])]),_:1}),s(j,{size:"small",style:{position:"sticky",top:"0","z-index":"100","margin-bottom":"10px"}},{default:a(()=>[s(O,{subtitle:"",onBack:n[1]||(n[1]=l=>e.$router.push({name:"HomeView"}))},{title:a(()=>[r(b(e.metaTitle),1)]),avatar:a(()=>[s(f,{src:e.iconTranslate,style:{background:"none"}},null,8,["src"])]),extra:a(()=>[s(p,null,{default:a(()=>[s(o,{secondary:"",size:"small",onClick:n[0]||(n[0]=l=>e.isShowCopyDialog=!0)},{default:a(()=>[r(b(e.$t("common.text_transformer")),1)]),_:1}),s(o,{type:"primary",onClick:e.handleSelectFile,size:"small"},{default:a(()=>[r(" Open JSON ")]),_:1},8,["onClick"]),e.fileHandle?(c(),h(o,{key:0,onClick:e.handleSaveFile,size:"small",type:"info"},{icon:a(()=>[s(t)]),default:a(()=>[r(" Save")]),_:1},8,["onClick"])):C("",!0),s(o,{secondary:"",onClick:e.handleExport,size:"small"},{default:a(()=>[r("Save as...")]),_:1},8,["onClick"]),e.fileHandle?C("",!0):(c(),h(i,{key:1,onPositiveClick:e.loadDemo},{trigger:a(()=>[s(o,{tertiary:"",size:"small"},{default:a(()=>[r("Demo")]),_:1})]),default:a(()=>[r(" Load Demo? This will override editing content. ")]),_:1},8,["onPositiveClick"]))]),_:1})]),_:1}),s(R,{visible:e.isShowCopyDialog,"onUpdate:visible":n[2]||(n[2]=l=>e.isShowCopyDialog=l)},null,8,["visible"])]),_:1}),u("div",ue,[(c(!0),y(Z,null,q(e.translateTreeRoot,(l,k)=>(c(),h(H,{key:k,item:l,index:k},null,8,["item","index"]))),128))]),me],32)}const ge=W(ce,[["render",_e],["__scopeId","data-v-38f95210"]]);export{ge as default};
