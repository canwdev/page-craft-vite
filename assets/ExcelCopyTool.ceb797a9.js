import{d as F,_ as $,r as g,s as O,w as R,o as j,c as N,h as M,g as T,a as B,b as E,e as X,f as L,i as c,j as u,F as z,k as D,l as I,m as S,n as J,p as K,q as V,t as W,u as A,v as H,x as U}from"./index.badd40a2.js";import{_ as P,a as q}from"./PageHeader.b8c0e958.js";let v=[];const G=(e,o)=>{const a=document.getElementById(e),r=o||function(){};if(!a){const t=document.createElement("script");t.src=e,t.id=e,document.body.appendChild(t),v.push(r),("onload"in t?f:_)(t)}a&&r&&r(null,a);function f(t){t.onload=function(){this.onerror=this.onload=null;for(const d of v)d(null,t);v=[]},t.onerror=function(){this.onerror=this.onload=null,r(new Error("Failed to load "+e),t)}}function _(t){t.onreadystatechange=function(){if(!(this.readyState!=="complete"&&this.readyState!=="loaded")){this.onreadystatechange=null;for(const d of v)d(null,t);v=[]}}}},Q=G,Y=""+new URL("excel.59df11bd.svg",import.meta.url).href,x=(e,o)=>{if(o===p.text)return e;let a=e.split(`
`);if(a=a.map(r=>r.trim()),o===p.json)return a.length===1?JSON.stringify(a[0]):JSON.stringify(a,null,2);if(o===p.html)return a.join("<br>")},Z=e=>e.tagName.toLowerCase()==="td",p={none:"none",text:"text",html:"html",json:"json"},ee=Object.values(p).map(e=>({label:e,value:e})),ne=F({name:"ExcelCopyTool",components:{FileChooser:$},setup(){const e=g(),o=g(),a=g(!1),r=O(),f=g([]),_=g(0);R(_,()=>{h()});const t=()=>{if(!a.value){const n="XLSX Not Ready!";throw window.$message.error(n),new Error(n)}},d=n=>(f.value=n.SheetNames,n.Sheets[f.value[_.value]]),h=()=>{const n=r.value;if(!n){o.value.innerHTML="";return}const i=window.XLSX.utils.sheet_to_html(d(n));o.value.innerHTML=i},y=async n=>{if(t(),!/\.xlsx$/g.test(n.name)){console.error("Only supports reading xlsx format!");return}const i=new FileReader;r.value=null,i.onload=function(l){const s=l.target.result;_.value=0,r.value=window.XLSX.read(s,{type:"binary"}),h()},i.readAsBinaryString(n)};j(()=>{Q("//unpkg.com/xlsx@0.16.9/xlsx.mini.js",()=>{window.$message.success("XLSX Ready!"),console.log("XLSX ready",window.XLSX),a.value=!0})});const m=g(p.json),C=n=>{let i=n.target;if(!Z(i)||!m.value||m.value===p.none||!i.innerText)return;let l=i.innerText.trim().replace(/Â /gi," ");console.log(m.value);let s="";n.ctrlKey&&n.altKey?l=x(l,s=p.json):n.ctrlKey?l=x(l,s=p.text):n.altKey?l=x(l,s=p.html):l=x(l,s=m.value),N(l),window.$message.success(s+" copied!");const b=document.createRange();b.selectNode(i);const k=window.getSelection();k&&(k.removeAllRanges(),k.addRange(b))},w=()=>{if(!r.value){const n="Please open Excel file first!";throw window.$message.error(n),new Error(n)}return window.XLSX.utils.sheet_to_json(d(r.value))};return{iconExcel:Y,sheetNames:f,sheetNameIndex:_,handleImport:y,importFileChooserRef:e,loadDemo(){t();const n=[["\u59D3\u540D","\u6027\u522B","\u5E74\u9F84","\u6CE8\u518C\u65F6\u95F4"],["\u5F20\u4E09","\u7537",18,new Date],["\u674E\u56DB","\u5973",22,new Date]],i=window.XLSX.utils.aoa_to_sheet(n),l=window.XLSX.utils.book_new();window.XLSX.utils.book_append_sheet(l,i,"Sheet1"),_.value=0,r.value=l,h()},tableWrapperRef:o,handleClick:C,copyMode:m,CopyModeOptions:ee,dropdownMenuOptions:[{label:"Copy Sheet JSON",props:{onClick:async()=>{const n=w();N(JSON.stringify(n,null,2)),window.$message.success("Sheet JSON Copied!")}}},{label:"Export Sheet JSON",props:{onClick:async()=>{const n=w();M(T(null,"excel_sheet_export"),JSON.stringify(n,null,2),".json")}}}]}}});const oe={class:"excel-copy-tool"},te=S(" ExcelCopyTool "),se=S(" CopyMode: "),le=S(" Import Excel "),ae=S("Export"),re=S("Demo");function ie(e,o,a,r,f,_){const t=P,d=J,h=K,y=V,m=W,C=q,w=A,n=H,i=U,l=$;return E(),X("div",oe,[L("div",null,[c(w,{size:"small"},{default:u(()=>[c(C,{subtitle:"",onBack:o[2]||(o[2]=s=>e.$router.push({name:"HomeView"}))},{title:u(()=>[te]),avatar:u(()=>[c(t,{src:e.iconExcel,style:{background:"none"}},null,8,["src"])]),extra:u(()=>[c(h,null,{default:u(()=>[c(h,{size:"small",align:"center"},{default:u(()=>[se,c(d,{size:"small",value:e.copyMode,"onUpdate:value":o[0]||(o[0]=s=>e.copyMode=s),options:e.CopyModeOptions,style:{width:"100px"}},null,8,["value","options"])]),_:1}),c(y,{type:"primary",onClick:o[1]||(o[1]=s=>e.importFileChooserRef.chooseFile()),size:"small"},{default:u(()=>[le]),_:1}),c(m,{options:e.dropdownMenuOptions,placement:"bottom-start","key-field":"label"},{default:u(()=>[c(y,{size:"small"},{default:u(()=>[ae]),_:1})]),_:1},8,["options"]),c(y,{onClick:e.loadDemo,size:"small"},{default:u(()=>[re]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),c(w,{class:"sheet-name-card",size:"small"},{default:u(()=>[c(i,{size:"small",type:"card",animated:"",value:e.sheetNameIndex,"onUpdate:value":o[3]||(o[3]=s=>e.sheetNameIndex=s)},{default:u(()=>[(E(!0),X(z,null,D(e.sheetNames,(s,b)=>(E(),I(n,{style:{padding:"0"},name:b,tab:s,key:s},null,8,["name","tab"]))),128))]),_:1},8,["value"])]),_:1})]),L("div",{ref:"tableWrapperRef",class:"excel-table-container",onClick:o[4]||(o[4]=(...s)=>e.handleClick&&e.handleClick(...s))},null,512),c(l,{ref:"importFileChooserRef",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onSelected:e.handleImport},null,8,["onSelected"])])}const de=B(ne,[["render",ie],["__scopeId","data-v-e26dac24"]]);export{de as default};
