import{d as e,I as a,bV as t,bW as o,_ as s,p as n,o as i,Q as l,e as r,F as c,m,bX as p,bY as d,r as u,L as g,aQ as b,P as y,a as _,bZ as h,u as k,aA as f,af as C,c as w,b_ as v,a8 as I,b$ as S,c0 as A,k as T,Z as x,y as P,aF as j,f as $,U as L,T as W,g as E,a1 as K}from"./index-BJklM7uy.js";import{T as O}from"./TabLayout-r0pFeegw.js";/* empty css                   */import{S as D}from"./enum-wriI_ogO.js";/* empty css                        */import{_ as U}from"./index.vue_vue_type_script_setup_true_lang-CqCeVzfa.js";import{u as N}from"./useIDBKeyval-vbfvgNrE.js";import{a as V,b as F,e as M,u as B,c as H,g as R}from"./use-common-ai-C7HWWNsI.js";import{A as z}from"./enum-CdO7LyZZ.js";import{I as q}from"./I18nToolSettings-lnRiPKNX.js";import"./use-model-wrapper-Cm8bqa9M.js";/* empty css                  */import"./RectSwitch-Dpia0p_L.js";import"./i18n-tool-settings-CZ9O6yuA.js";const G=s(e({name:"LanguageChooser",setup(){const{t:e}=a();return{languages:t,handleLanguageSelect(a){o(a),window.$dialog.confirm(e("msgs.refresh_page"),e("actions.confirm"),{type:"warning"}).then((()=>{location.reload()})).catch()}}}}),[["render",function(e,a,t,o,s,u){const g=p,b=d;return i(),n(b,{class:"language-chooser",modelValue:e.$i18n.locale,"onUpdate:modelValue":a[0]||(a[0]=a=>e.$i18n.locale=a),onChange:e.handleLanguageSelect},{default:l((()=>[(i(!0),r(c,null,m(e.languages,(e=>(i(),n(g,{key:e.locale,label:e.name,value:e.locale},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])}],["__scopeId","data-v-5abd5f5f"]]),J=e({__name:"SettingsCommon",setup(e){const{t:t}=a(),o=_(),{themeOptions:s}=h(),l=()=>{let e='<b><a style="color: inherit" href="https://www.dujin.org/12142.html" target="_blank">随机壁纸API</a></b>';return[{label:"Bing",url:"https://api.dujin.org/bing/1920.php"}].forEach((a=>{e+=`<br>${a.label}: <a style="color: inherit" href="${a.url}" target="_blank">${a.url}</a>`})),e},r=k(),c=f();C();const{isLoading:m,importAllSettings:p,exportAllSettings:d}=(()=>{const e=u(!1),{t:t}=a(),o=(e,a)=>{const{set:t,data:o,isFinished:s}=N(e,{});return new Promise((e=>{y(s,(s=>{s&&(t(a),e(o.value))}))}))},s=e=>{const{data:a,isFinished:t}=N(e,{});return new Promise((e=>{y(t,(t=>{t&&e(a.value)}))}))};return{isLoading:e,idbRestoreData:o,idbBackupData:s,importAllSettings:async()=>{try{e.value=!0;const a=await window.$mcUtils.handleImportJson();if(!a.backupSettingsVersion)throw new Error("Invalid settings json file!");for(const e in a.localStorageData){const t=a.localStorageData[e];t&&localStorage.setItem(e,t)}for(const e in a.idbKeyValData){const t=a.idbKeyValData[e];t&&await o(e,t)}location.reload()}catch(a){window.$message.error(a.message),console.error(a)}finally{e.value=!1}},exportAllSettings:async()=>{try{e.value=!0;const a={backupSettingsVersion:1,localStorageData:{},idbKeyValData:{}};Object.values(g).forEach((e=>{const t=localStorage.getItem(e);console.log("[LS_SettingsKey] Backup: ",{key:e,data:t}),a.localStorageData[e]=t}));for(const e in b){const t=b[e];if(/_handle_history$/.test(t))console.warn(`[IDBSettingsKey] Skip backup ${t} because it contains FileSystemFileHandle`);else{const e=await s(t);console.log("[IDBSettingsKey] Backup: ",{key:t,data:e}),a.idbKeyValData[t]=e}}console.log(a.idbKeyValData),window.$mcUtils.handleExportFile(await window.$mcUtils.promptGetFileName(void 0,"PageCraft_Toolbox_All_Settings"),JSON.stringify(a,null,2),".json")}catch(a){window.$message.error(a.message),console.error(a)}finally{e.value=!1}}}})(),j=w((()=>[{label:t("common.personalization"),key:"personalization",children:[{label:t("common.theme_color"),key:"themeColor",iconClass:"mdi mdi-palette",store:o,type:D.COLOR_PICKER},{label:t("common.wallpaper"),key:"desktopWallpaper",iconClass:"mdi mdi-wallpaper",store:o,type:D.INPUT,tips:l(),placeholder:"optional"},!o.desktopWallpaper&&{label:t("common.bg_color"),key:"desktopBgColor",iconClass:"mdi mdi-format-color-fill",store:o,type:D.COLOR_PICKER},{label:t("common.theme"),key:"customTheme",iconClass:"mdi mdi-palette-swatch-variant",store:o,type:D.SELECT,options:s.value,props:{"onUpdate:value":e=>{o.ldTheme=A.LIGHT}}},{label:t("actions.toggle_ld_theme"),key:"ldTheme",iconClass:"mdi mdi-brightness-4",store:o,type:D.MULTIPLE_SWITCH,options:v},{label:t("common.disable_animation"),subtitle:t("common.eink_optimization"),key:"disableAnimation",iconClass:"mdi mdi-transition",store:o,type:D.SWITCH}].filter(Boolean)},{label:"PageCraft",key:"pagecraft",children:[{label:t("common.top_layout"),key:"enableTopLayout",iconClass:"mdi mdi-dock-top",store:o,type:D.SWITCH},{label:t("common.sound_fx"),key:"enableSoundFx",iconClass:"mdi mdi-music-accidental-flat",store:o,type:D.SWITCH}]},{label:t("common.common"),key:"common",children:[{label:t("msgs.focus_auto_action")+" (ctrl+alt+a)",subtitle:t("msgs.focus_auto_action_desc"),iconClass:"mdi mdi-button-pointer",tips:'⚡ 搭配AHK脚本使用，效率更佳！<br><pre style="max-height: 300px;overflow: auto;color: greenyellow;box-sizing:border-box;padding:5px;background-color: black">\n#Persistent ; 让脚本持续运行\nSetTitleMatchMode, 2 ; 设置窗口标题匹配模式为包含模式\n; 按F2执行操作\nF2::\n    ; 按下 Ctrl+C\n    Send, ^c\n    ; 获取当前活动窗口的句柄\n    WinGet, originalWindow, ID, A\n    ; 切换到标题包含 "PageCraft" 的窗口\n    IfWinExist, PageCraft\n    {\n        WinActivate ; 激活找到的窗口\n        Sleep, 50 ; 等待50毫秒\n    }\n    ; 切换回原窗口\n    If (originalWindow)\n    {\n        WinActivate, ahk_id %originalWindow% ; 激活之前活动的窗口\n    }\n    ; 按下 Ctrl+V\n    Send, ^v\nreturn\n</pre>',key:"enableFocusAutoAction",store:o,type:D.SWITCH},{label:t("msgs.bei_fen_yu_huan_yuan"),subtitle:t("msgs.dao_ru_dao_chu_quan"),iconClass:"mdi mdi-backup-restore",actionRender:()=>I("div",{class:"flex-row-center-gap"},[I("button",{class:"vp-button",onClick(){window.$dialog.confirm(t("msgs.will_override_existe"),t("actions.confirm"),{type:"warning"}).then((()=>{p()}))}},t("actions.import")),I("button",{class:"vp-button",onClick(){d()}},t("actions.export"))])}]},{label:t("common.system"),key:"system",children:[{label:"Language",key:"language",iconClass:"mdi mdi-translate",actionRender:I(G)},window.__TAURI__&&{label:t("msgs.auto_check_update"),key:"autoCheckUpdate",iconClass:"mdi mdi-cellphone-arrow-down",subtitle:r.upgradeInfo,store:o,type:D.SWITCH},{label:S(),subtitle:`Copyright © 2022-${(new Date).getFullYear()} canwdev`,iconClass:"mdi mdi-github",actionRender:()=>I("div",{class:"flex-row-center-gap"},[I("button",{class:"vp-button",onClick(){c.createTaskById("os.pagecraft.richtext",{isReleaseNotes:!0})}},t("msgs.release_notes")),I("a",{style:"color: inherit;",href:"https://github.com/canwdev/page-craft-vite",target:"_blank",rel:"noopener noreferrer"},"Github")])}].filter(Boolean)}]));return(e,a)=>{const t=x;return T((i(),n(U,{"option-list":P(j)},null,8,["option-list"])),[[t,P(m)]])}}}),Q=e({__name:"SettingsAi",setup(e){const{t:t}=a(),o=V(),{requestChatMessage:s}=F(),{requestChatMessage:l}=M(),{requestChatMessage:r}=B(),c=u(!1),m=e=>({label:t("ai.lian_tong_xing_ce_sh"),key:"test",iconClass:"mdi mdi-test-tube",type:D.BUTTON,props:{class:"primary",onClick:()=>(async e=>{try{c.value=!0;const a=await e([{role:"user",content:"tell me your name briefly"}]);window.$dialog.alert(a,"Success",{type:"success"})}catch(a){console.error(a),window.$dialog.alert(a.message,"Error",{type:"error"})}finally{c.value=!1}})(e)},value:t("actions.test")}),p=w((()=>[{label:"OpenAI (Chat GPT)",key:"open_ai",children:[{label:"OpenAI API Key",key:"openAiApiKey",iconClass:"mdi mdi-key",type:D.INPUT,props:{placeholder:"sk-**********"}},{label:`API ${t("ai.dai_li_di_zhi")}`,tips:"推荐代理：<br>https://aihubmix.com/v1",key:"openAiApiProxy",iconClass:"mdi mdi-vpn",type:D.INPUT},m(s)]},{label:"Anthropic (Claude AI)",key:"anthropic",children:[{label:"Anthropic API Key",subtitle:"",key:"anthropicApiKey",iconClass:"mdi mdi-key",type:D.INPUT},{label:`API ${t("ai.dai_li_di_zhi")}`,tips:"推荐代理：<br>https://aihubmix.com",key:"anthropicApiProxy",iconClass:"mdi mdi-vpn",store:o,type:D.INPUT},m(l)]},{label:t("common.common"),key:"common",children:[{type:z.SELECT,options:H,key:"provider",label:t("ai.quan_ju_mo_ren_ti_go"),iconClass:"mdi mdi-domain",props:{filterable:!0,onChange(){o.model=R(o.provider)[0].value}}},{label:t("ai.quan_ju_mo_ren_mo_xi"),subtitle:o.model,key:"model",iconClass:"mdi mdi-head-snowflake",type:D.SELECT,options:R(o.provider),props:{allowCreate:!0,filterable:!0}},m((e=>r({provider:o.provider,model:o.model,messages:e}))),{label:t("ai.qi_yong_liu_shi_xian"),subtitle:t("ai.kuai_su_xiang_ying_d"),key:"stream",iconClass:"mdi mdi-network-pos",type:D.SWITCH},{label:t("ai.enter_key_send"),subtitle:o.isEnterSend?t("ai.enter_send_tips_1"):t("ai.enter_send_tips_2"),key:"isEnterSend",iconClass:"mdi mdi-wrap",type:D.SWITCH}]}]));return(e,a)=>{const t=x;return T((i(),n(U,{"option-list":P(p),store:P(o)},null,8,["option-list","store"])),[[t,P(c)]])}}}),Y={class:"settings-content"},Z=s(e({name:"SettingsApp",props:{appParams:{}},setup(e){const t=e,{t:o}=a(),s=u([{label:o("common.common"),value:j.COMMON},{label:"AI",value:j.AI},{label:o("i18n_tools.i18_n"),value:j.I18N}]),r=u(j.COMMON);return y((()=>t.appParams),(()=>{t.appParams&&(r.value=t.appParams.curTab)}),{immediate:!0}),(e,a)=>(i(),n(O,{class:"system-settings",horizontal:"",modelValue:P(r),"onUpdate:modelValue":a[0]||(a[0]=e=>K(r)?r.value=e:null),options:P(s)},{default:l((()=>[$("div",Y,[L(W,{mode:"out-in",name:"fade"},{default:l((()=>[P(r)===P(j).COMMON?(i(),n(J,{key:0})):P(r)===P(j).AI?(i(),n(Q,{key:1})):P(r)===P(j).I18N?(i(),n(q,{key:2})):E("",!0)])),_:1})])])),_:1},8,["modelValue","options"]))}}),[["__scopeId","data-v-0fe32b26"]]);export{Z as default};
