import{d as e,a as l,c as a,e as t,dj as n,j as s,dk as o,w as i,dl as u,Q as r,i as c,o as d,dm as v,dn as p,d8 as m,dp as w,dq as h,m as g,c3 as f,F as y,dr as b,ds as x,g as C,W as k,u as S,dt as V,Z as A,z,A as _,b as R,x as $,G as L,H as M,bU as B,B as E,cA as I,y as U,D as T,E as H,a2 as P,$ as N,c2 as O,bV as F,b$ as j,du as G,V as K,dv as q,dw as J,cU as D}from"./index-DyP2wrK1.js";const W={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Y=[t("g",{fill:"none"},[t("path",{d:"M15 3a.5.5 0 0 0-1 0v2h-2a.5.5 0 0 0 0 1h2v2a.5.5 0 0 0 1 0V6h2a.5.5 0 0 0 0-1h-2V3zM4.5 17A1.5 1.5 0 0 1 3 15.5v-11A1.5 1.5 0 0 1 4.5 3H9a1.5 1.5 0 0 1 1.5 1.5v5h5A1.5 1.5 0 0 1 17 11v4.5a1.5 1.5 0 0 1-1.5 1.5h-11zm6-6.5V16h5a.5.5 0 0 0 .5-.5V11a.5.5 0 0 0-.5-.5h-5zm-1 5.5v-5.5H4v5a.5.5 0 0 0 .5.5h5zm0-11.5A.5.5 0 0 0 9 4H4.5a.5.5 0 0 0-.5.5v5h5.5v-5z",fill:"currentColor"})],-1)],Q=e({name:"AppsAddIn20Regular",render:function(e,t){return l(),a("svg",W,Y)}}),Z={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},X=[t("g",{fill:"none"},[t("path",{d:"M7.5 2a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2a.5.5 0 0 1 .5-.5zM3.61 3.61a.5.5 0 0 1 .708 0l1.414 1.415a.5.5 0 1 1-.707.707L3.611 4.318a.5.5 0 0 1 0-.707zm7.78 0a.5.5 0 0 1 0 .708L9.974 5.732a.5.5 0 1 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zM2 7.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5zm6.64-.2A1 1 0 0 0 7 8.067v9.101c0 .924 1.145 1.354 1.753.659l2.026-2.316A1.5 1.5 0 0 1 11.908 15h3.211c.935 0 1.359-1.17.64-1.768L8.64 7.299zM8 17.17V8.067L15.119 14h-3.211a2.5 2.5 0 0 0-1.882.854L8 17.169z",fill:"currentColor"})],-1)],ee=e({name:"CursorClick20Regular",render:function(e,t){return l(),a("svg",Z,X)}}),le={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},ae=[t("g",{fill:"none"},[t("path",{d:"M2 6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v7a2 2 0 0 1-1.164 1.818a1.497 1.497 0 0 0-.275-.379l-.446-.446A1 1 0 0 0 17 13V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h5v1H4a2 2 0 0 1-2-2V6zm8.854 4.146A.5.5 0 0 0 10 10.5v7a.5.5 0 0 0 .91.287l1.571-2.245l2.943.452a.5.5 0 0 0 .43-.848l-5-5zM11 15.915v-4.207l3.066 3.067l-1.74-.268a.5.5 0 0 0-.486.207l-.84 1.2z",fill:"currentColor"})],-1)],te=e({name:"CursorHover20Regular",render:function(e,t){return l(),a("svg",le,ae)}}),ne={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},se=[t("g",{fill:"none"},[t("path",{d:"M5.5 1.999a.5.5 0 0 0-.5.5v8.504a2 2 0 0 0 2 2h1.004v2.998a2 2 0 1 0 4 0v-2.998H13a2 2 0 0 0 2-2V2.5a.5.5 0 0 0-.5-.5h-9zm.5 8.004h8v1a1 1 0 0 1-1 1h-1.496a.5.5 0 0 0-.5.5v3.498a1 1 0 1 1-2 0v-3.498a.5.5 0 0 0-.5-.5H7a1 1 0 0 1-1-1v-1zm8-1H6V3h4v1.5a.5.5 0 0 0 1 0v-1.5h1v2.502a.5.5 0 0 0 1 0V3h1v6.004z",fill:"currentColor"})],-1)],oe=e({name:"PaintBrush20Regular",render:function(e,t){return l(),a("svg",ne,se)}}),ie={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},ue=[t("g",{fill:"none"},[t("path",{d:"M16.5 2a.5.5 0 0 1 .5.5V3h.5a.5.5 0 0 1 0 1H17v.5a.5.5 0 0 1-1 0V4h-.5a.5.5 0 1 1 0-1h.5v-.5a.5.5 0 0 1 .5-.5zm-10 4a.5.5 0 0 0 0-1H6v-.5a.5.5 0 0 0-1 0V5h-.5a.5.5 0 0 0 0 1H5v.5a.5.5 0 0 0 1 0V6h.5zm9 9a.5.5 0 0 0 0-1H15v-.5a.5.5 0 0 0-1 0v.5h-.5a.5.5 0 1 0 0 1h.5v.5a.5.5 0 1 0 1 0V15h.5zm-2.066-8.434a1.914 1.914 0 0 0-2.707 0l-8.166 8.166a1.914 1.914 0 1 0 2.707 2.707l8.166-8.166a1.914 1.914 0 0 0 0-2.707zm-2 .707a.914.914 0 0 1 1.293 1.293l-.477.477l-1.293-1.293l.477-.477zM10.25 8.457l1.293 1.293l-6.982 6.982a.914.914 0 0 1-1.293-1.292l6.982-6.983z",fill:"currentColor"})],-1)],re=e({name:"Wand20Regular",render:function(e,t){return l(),a("svg",ie,ue)}}),ce=e({__name:"ElementByPoint",props:{parentClass:{default:void 0}},emits:["select"],setup(e,{emit:n}){const s=e,{parentClass:o}=r(s),i=n,u=c(null);d((()=>{o.value&&(u.value=document.querySelector(o.value))}));const{x:b,y:x}=v({type:"client"}),{element:C}=p({x:b,y:x}),k=m(w(C));h("scroll",k.update,!0);const S=g((()=>!(u.value&&!u.value.contains(C.value)||u.value===C.value))),V=g((()=>C.value&&S.value?{display:"block",width:`${k.width}px`,height:`${k.height}px`,left:`${k.left}px`,top:`${k.top}px`,transition:"all 0.05s linear"}:{display:"none"})),A=g((()=>({transform:`translate(calc(${b.value}px - 50%), calc(${x.value}px - 50%))`,color:S.value?"white":"grey"})));return h("click",(e=>{S.value&&(e.stopPropagation(),e.preventDefault(),i("select",C.value))}),{capture:!0}),(e,n)=>(l(),a(y,null,[t("div",{style:f(V.value),class:"mc-element-by-point-box"},null,4),t("div",{style:f(A.value),class:"mc-element-by-point-pointer"},null,4)],64))}}),de=["title"],ve=["title"],pe=["title"],me=["title"],we={class:"style-editor-inner"},he={key:0,class:"style-editor-action-bar"},ge={class:"code-editor-placeholder"},fe=e({__name:"index",props:{visible:{type:Boolean,default:!1},selecting:{type:Boolean,default:!1},selectingParentClass:{default:void 0},showTabs:{type:Boolean,default:!1},styleCode:{default:""}},emits:["update:visible","update:selecting","onFormat","onInsertCode","update:styleCode"],setup(e,{expose:v,emit:p}){const m=e,{showTabs:w}=r(m),f=p,{t:W}=C(),Y=k(m,"visible",f),Z=n(),{globalStyleCode:X}=(()=>{const e=n(),l=s(o.GLOBAL_STYLE,"");i(l,(e=>{a()}));const a=async()=>{try{e.globalCSS=l.value?await u(l.value):""}catch(a){window.$message.error(a.message)}};return{globalStyleCode:l}})(),le=s(o.VARIABLES_STYLE,""),ae=k(m,"styleCode",f,{passive:!0});i(ae,(()=>{xe()}));const ne=c(),se=c(!1),ie=()=>{const e=ne.value.getInstance();null==e||e.layout()},ue=()=>{se.value||setTimeout((()=>{ne.value.getInstance().focus()}),100)};i(Y,(e=>{e&&(ie(),ue())})),i(se,(e=>{e||ue()}));const fe=c(),ye=()=>{console.warn(fe.value.message,{...fe.value}),setTimeout((()=>{fe.value=null}),500)},be=c(""),xe=async(e=!1)=>{try{const l=le.value+"\n"+ae.value;if(be.value===l&&!e)return;be.value=l;const a=l?await u(l):"";Z.currentCSS=a,fe.value=""}catch(l){fe.value=l}};i(le,(()=>{xe()}),{immediate:!0}),S("PlaygroundPageStyleSync",(()=>{xe(!0)}));const Ce=async()=>{var e;const l=ne.value.getInstance(),a=l.getValue();if(a.trim()){const t=G(a);if(a.trim()!==t.trim()){const a=null==(e=l.getModel())?void 0:e.getFullModelRange();a?l.executeEdits(null,[{text:t,range:a}]):ae.value=t}}l.focus(),f("onFormat")},ke=()=>{const e=ne.value.getInstance().getValue();window.$qlUtils.copy(e)},Se=k(m,"selecting",f,{passive:!0}),Ve=e=>{Se.value&&(Ae({el:e}),Se.value=!1)},Ae=({el:e,code:l="",isAppend:a=!1})=>{K((()=>{if(e){let a=q(e);if(!a)return;l=`\n${a} {\n\n}\n`}l&&ze(l,a)}))},ze=(e,l=!1)=>{if(f("onInsertCode"),l)return void(ae.value=ae.value+"\n"+e);const a=ne.value.getInstance(),t=a.getSelection();a.executeEdits("",[{range:new J.Range((null==t?void 0:t.startLineNumber)||0,(null==t?void 0:t.startColumn)||0,(null==t?void 0:t.endLineNumber)||0,(null==t?void 0:t.endColumn)||0),text:e,forceMoveMarkers:!0}]),setTimeout((()=>{a.focus()}),100)},{snippetsOptions:_e,updateEditorAutoComplete:Re}=(({insertCode:e,vueMonacoRef:l})=>{const a=s(o.CUSTOM_SNIPPETS,[]),t=()=>{x.$monacoScssSnippetsCustom=[],i(a.value)};d((()=>{t()}));const n=(l,a)=>{const t={label:l.label,props:{}};if(l.code||l.snippet){a&&a(l);const n=l.snippet||l.code;t.props.onClick=async()=>{e(n)},t.props.onContextmenu=async()=>{window.$qlUtils.copy(n)}}return t},i=(e=[],l=[])=>(e.forEach((e=>{l.push({children:e.children?u(e.children):void 0,...n(e,(e=>{e.snippet&&x.$monacoScssSnippetsCustom.push({label:e.label,snippet:e.snippet})}))})})),l),u=(e=[],l=[])=>(e.forEach((e=>{l.push({children:e.children?u(e.children):void 0,...n(e)})})),l),{options:r}=b({fetchFn:async()=>{const e=await fetch("./scss-snippets.json");return await e.json()},mapFn:e=>n(e,(e=>{e.snippet&&x.$monacoScssSnippets.push({label:e.label,snippet:e.snippet})}))});return{snippetsOptions:g((()=>{const e=[...r.value,{label:"⚙️ Manage",children:[{label:"➕ Add custom snippet",props:{onClick:async()=>{const e=l.value.getInstance(),n=e.getSelection();let s=e.getModel().getValueInRange(n).trim();if(!s)return void window.$message.error("Please select code first!");let o=/\.(\w|-)+/g.exec(s)||[];console.log(o);let i=await window.$mcUtils.showInputPrompt({title:"Input snippet label",value:o[0]||""});i?(a.value.push({label:i,snippet:s}),t()):window.$message.error("Please input label!")}}},{label:"📥 Import JSON...",props:{onClick:async()=>{const e=await window.$mcUtils.handleImportJson();a.value=e||[],window.$message.success("Import success!")}}},{label:"📤 Export JSON...",props:{onClick:async()=>{window.$mcUtils.handleExportFile(await window.$mcUtils.promptGetFileName("ScssSnippets"),JSON.stringify(a.value,null,2),".json")}}},{label:"❌ Clear All...",children:[{label:"✅ Confirm Clear All Custom Snippets",props:{onClick:()=>{a.value=[],t()}}},{label:"❎ Cancel",props:{isBack:1}}]}]}];return a.value.length&&e.push({label:"🔮 Custom",children:[...u(a.value)]}),e})),updateEditorAutoComplete:e=>{const l=new Set;let a,t=/\.(\w|-)+/g,n=/\$[\w-]+/g;for(;null!==(a=t.exec(e));)l.add(a[0]);for(;null!==(a=n.exec(e));)l.add(a[0]);x.$monacoScssVariables=Array.from(l)}}})({insertCode:ze,vueMonacoRef:ne}),$e=c([{label:W("common.global_style"),value:V.GLOBAL},{label:W("common.variables"),value:V.VARIABLES},{label:W("actions.current"),value:V.CURRENT}]),Le=s(o.CURRENT_TAB,V.CURRENT,localStorage,{listenToStorageChanges:!1});i(w,(e=>{e||(Le.value=V.GLOBAL)}),{immediate:!0}),i((()=>Le),(e=>{Re(X.value+le.value)}),{immediate:!0});const Me=e=>{const l=e.key.toLowerCase();e.ctrlKey&&e.shiftKey&&"f"===l&&Ce()};return h(document,"keydown",(e=>{if(!Y.value)return;const l=e.key.toLowerCase();e.ctrlKey&&e.shiftKey&&"x"===l?Se.value=!Se.value:e.altKey&&"`"===l&&(se.value=!se.value)})),v({handleAddStyle:Ae}),(e,n)=>{const s=D;return l(),a(y,null,[A(Se)?(l(),z(ce,{key:0,onSelect:Ve,"parent-class":A(Le)===A(V).CURRENT?e.selectingParentClass:void 0},null,8,["parent-class"])):_("",!0),R(j,{class:"mc-style-editor-dialog",visible:A(Y),"onUpdate:visible":n[7]||(n[7]=e=>N(Y)?Y.value=e:null),onResize:ie,wid:"style_editor",onKeyup:Me,onOnActive:ue,"allow-maximum":"","init-win-options":{width:"400px",height:"500px"}},{titleBarLeft:$((()=>[R(s,{class:"window-icon",size:"18"},{default:$((()=>[R(A(oe))])),_:1}),L(M(A(W)("common.style_editor"))+" (scss) ",1)])),titleBarRightControls:$((()=>[t("button",{title:A(W)("msgs.select_an_element_in")+" (ctrl+shift+x)",class:B({active:A(Se)}),onClick:n[0]||(n[0]=E((e=>Se.value=!A(Se)),["stop","prevent"]))},[R(s,{size:"20"},{default:$((()=>[A(Se)?(l(),z(A(ee),{key:1})):(l(),z(A(te),{key:0}))])),_:1})],10,de),t("button",{onClick:n[1]||(n[1]=e=>se.value=!A(se)),title:A(W)("actions.add_tool_codes")},[R(s,{size:"20"},{default:$((()=>[R(A(Q))])),_:1})],8,ve),t("button",{title:A(W)("actions.beautify_code")+" (ctrl+shift+f)",onClick:Ce},[R(s,{size:"20"},{default:$((()=>[R(A(re))])),_:1})],8,pe),t("button",{title:A(W)("actions.copy_code")+" (ctrl+a ctrl+c)",onClick:ke},[R(s,{size:"20"},{default:$((()=>[R(A(I))])),_:1})],8,me)])),default:$((()=>[R(U,{name:"mc-fade"},{default:$((()=>{var e;return[T(t("div",{class:"code-mc-error-tip-button font-code",onClick:ye},M(null==(e=A(fe))?void 0:e.message),513),[[H,A(fe)]])]})),_:1}),t("div",we,[R(P,{visible:A(se),"onUpdate:visible":n[2]||(n[2]=e=>N(se)?se.value=e:null),options:A(_e),title:`${A(W)("actions.add_tool_codes")} (alt+\`)`,class:"font-code",style:{top:"2px",right:"2px"}},null,8,["visible","options","title"]),A(w)?(l(),a("div",he,[R(O,{modelValue:A(Le),"onUpdate:modelValue":n[3]||(n[3]=e=>N(Le)?Le.value=e:null),"tab-list":A($e),horizontal:""},null,8,["modelValue","tab-list"])])):_("",!0),t("div",ge,[A(Le)===A(V).GLOBAL?(l(),z(F,{key:0,ref_key:"vueMonacoRef",ref:ne,modelValue:A(X),"onUpdate:modelValue":n[4]||(n[4]=e=>N(X)?X.value=e:null),language:"scss","debounce-ms":500,"show-line-numbers":""},null,8,["modelValue"])):A(Le)===A(V).VARIABLES?(l(),z(F,{key:1,ref_key:"vueMonacoRef",ref:ne,modelValue:A(le),"onUpdate:modelValue":n[5]||(n[5]=e=>N(le)?le.value=e:null),language:"scss","debounce-ms":500,"show-line-numbers":""},null,8,["modelValue"])):(l(),z(F,{key:2,ref_key:"vueMonacoRef",ref:ne,modelValue:A(ae),"onUpdate:modelValue":n[6]||(n[6]=e=>N(ae)?ae.value=e:null),language:"scss","debounce-ms":500,"show-line-numbers":""},null,8,["modelValue"]))])])])),_:1},8,["visible"])],64)}}});export{fe as default};
