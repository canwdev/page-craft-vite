import{_ as C,i as R}from"./translate-d2c6609e.js";import{_ as V,d as T,u as j,a as H,b as B}from"./use-file-drop-e7ff1ede.js";import{d as F,i as d,j as y,m as _,u as J,r as P,K as w,s as x,a as A,b as E,o as M,L as W,M as L,N as b,g as U,O as Z,k as s,l as a,T as q,F as G,z as K,n as g,q as Q,t as X,v as Y,x as c,y as D,A as h,P as $,Q as ee,R as ne,D as te,S as oe,G as ae}from"./index-68d06547.js";const se={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},ie=_("g",{fill:"none"},[_("path",{d:"M3 5a2 2 0 0 1 2-2h8.379a2 2 0 0 1 1.414.586l1.621 1.621A2 2 0 0 1 17 6.621V15a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5zm2-1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1v-4.5A1.5 1.5 0 0 1 6.5 10h7a1.5 1.5 0 0 1 1.5 1.5V16a1 1 0 0 0 1-1V6.621a1 1 0 0 0-.293-.707l-1.621-1.621A1 1 0 0 0 13.379 4H13v2.5A1.5 1.5 0 0 1 11.5 8h-4A1.5 1.5 0 0 1 6 6.5V4H5zm2 0v2.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5V4H7zm7 12v-4.5a.5.5 0 0 0-.5-.5h-7a.5.5 0 0 0-.5.5V16h8z",fill:"currentColor"})],-1),le=[ie],re=F({name:"Save20Regular",render:function(n,i){return d(),y("svg",se,le)}}),z={types:[{description:"JSON",accept:{"application/JSON":[".json"]}}]},ce=F({name:"VueI18nEditTool",components:{TranslateTreeItem:C,DropZone:V,Save20Regular:re},setup(){const e=J(),n=P(w.parseWithRoot()),i=x(),u=async t=>{try{const o=await L(t),l=JSON.parse(o);n.value=w.parseWithRoot(l)}catch(o){console.error(o),window.$message.error(o.message)}},S=async()=>{const[t]=await window.showOpenFilePicker(z);i.value=t;const o=await t.getFile();u(o)},v=async()=>{if(!i.value)return;const t=await i.value.createWritable(),o=JSON.stringify(b(n.value),null,2);await t.write(o),await t.close(),window.$message.success("Saved!")},m=async()=>{var p;console.log(n.value);const t=JSON.stringify(b(n.value),null,2),l=await(await window.showSaveFilePicker({suggestedName:(p=i.value)==null?void 0:p.name,...z})).createWritable();await l.write(t),await l.close(),window.$message.success("Saved!")},{metaTitle:f}=A();return E(()=>{if(i.value){v();return}m()}),M(async()=>{console.log(import.meta),await T("./lib/pinyinjs/pinyin_dict_notone.min.js"),await T("./lib/pinyinjs/pinyinUtil.js")}),W(()=>!!i.value),{metaTitle:f,translateTreeRoot:n,fileHandle:i,handleImport:u,handleSelectFile:S,handleSaveFile:v,handleExport:m,loadDemo(){n.value=w.parseWithRoot({hello_world:{section_a:{test_str:"This is a test string",test_arr:["line 1","line 2","line 3"],test_number:114514},section_b:{"":"Blur this input and it'll generate the key automatically!"},section_c:{"":"中文 is Supported"}}})},iconTranslate:R,...j({cb:async t=>{for(const o of t.dataTransfer.items)if(o.kind==="file"){const l=await o.getAsFileSystemHandle();if(l.kind!=="directory"){i.value=l;const p=await l.getFile();await u(p)}else window.$message.error("Please drag and drop a json file here!")}}}),mainStore:e}}});const pe=e=>(ee("data-v-dbe3ad86"),e=e(),ne(),e),de={class:"_container"},ue=pe(()=>_("div",{style:{height:"500px"}},null,-1));function me(e,n,i,u,S,v){const m=V,f=H,t=te,o=Z("Save20Regular"),l=oe,p=ae,I=B,N=Q,O=C;return d(),y("div",{class:"vue-i18n-copy-tool",onDragover:n[2]||(n[2]=g((...r)=>e.fileDragover&&e.fileDragover(...r),["prevent","stop"])),onDragleave:n[3]||(n[3]=g(r=>e.showDropzone=!1,["prevent","stop"])),onDrop:n[4]||(n[4]=g((...r)=>e.fileDrop&&e.fileDrop(...r),["prevent","stop"]))},[s(q,{name:"mc-fade"},{default:a(()=>[X(s(m,{text:"Drop json file here"},null,512),[[Y,e.showDropzone]])]),_:1}),s(N,{size:"small",style:{position:"sticky",top:"0","z-index":"100","margin-bottom":"10px"}},{default:a(()=>[s(I,{subtitle:"",onBack:n[1]||(n[1]=r=>e.$router.push({name:"HomePage"}))},{title:a(()=>[c(D(e.metaTitle),1)]),avatar:a(()=>[s(f,{src:e.iconTranslate,style:{background:"none"}},null,8,["src"])]),extra:a(()=>[s(p,null,{default:a(()=>[s(t,{secondary:"",size:"small",onClick:n[0]||(n[0]=r=>e.mainStore.isShowTextTransformer=!0)},{default:a(()=>[c(D(e.$t("common.text_transformer")),1)]),_:1}),s(t,{type:"primary",onClick:e.handleSelectFile,size:"small"},{default:a(()=>[c(" Open JSON ")]),_:1},8,["onClick"]),e.fileHandle?(d(),h(t,{key:0,onClick:e.handleSaveFile,size:"small",type:"info"},{icon:a(()=>[s(o)]),default:a(()=>[c(" Save")]),_:1},8,["onClick"])):$("",!0),s(t,{secondary:"",onClick:e.handleExport,size:"small"},{default:a(()=>[c("Save as...")]),_:1},8,["onClick"]),e.fileHandle?$("",!0):(d(),h(l,{key:1,onPositiveClick:e.loadDemo},{trigger:a(()=>[s(t,{tertiary:"",size:"small"},{default:a(()=>[c("Demo")]),_:1})]),default:a(()=>[c(" Load Demo? This will override editing content. ")]),_:1},8,["onPositiveClick"]))]),_:1})]),_:1})]),_:1}),_("div",de,[(d(!0),y(G,null,K(e.translateTreeRoot,(r,k)=>(d(),h(O,{key:k,item:r,index:k},null,8,["item","index"]))),128))]),ue],32)}const we=U(ce,[["render",me],["__scopeId","data-v-dbe3ad86"]]);export{we as default};
