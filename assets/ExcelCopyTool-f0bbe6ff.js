import{_ as M,a as R,C as h,b as O,f as v,u as j,c as B,d as I}from"./use-file-drop-da1c6357.js";import{d as J,_ as z,r as m,s as U,u as V,w as A,o as K,c as T,h as W,g as H,a as P,b as $,e as l,f as r,T as Z,i as F,j as X,k as q,l as x,m as G,v as Q,n as w,t as Y,F as ee,p as oe,q as ne,x as te,y as se,z as le,A as ae,B as ie,C as re,D as pe}from"./index-26228446.js";let S=[];const ue=(e,t)=>{const _=document.getElementById(e),p=t||function(){};if(!_){const a=document.createElement("script");a.src=e,a.id=e,document.body.appendChild(a),S.push(p),("onload"in a?g:d)(a)}_&&p&&p(null,_);function g(a){a.onload=function(){this.onerror=this.onload=null;for(const u of S)u(null,a);S=[]},a.onerror=function(){this.onerror=this.onload=null,p(new Error("Failed to load "+e),a)}}function d(a){a.onreadystatechange=function(){if(!(this.readyState!=="complete"&&this.readyState!=="loaded")){this.onreadystatechange=null;for(const u of S)u(null,a);S=[]}}}},de=ue,ce=""+new URL("excel-59df11bd.svg",import.meta.url).href,me=e=>e.tagName.toLowerCase()==="td",_e=J({name:"ExcelCopyTool",components:{FileChooser:z,DialogCopyFormat:M,DropZone:R},setup(){const e=m(),t=m(),_=m(!1),p=U(),g=m([]),d=m(0),{metaTitle:a}=V();A(d,()=>{c()});const u=()=>{if(!_.value){const o="XLSX Not Ready!";throw window.$message.error(o),new Error(o)}},D=o=>(g.value=o.SheetNames,o.Sheets[g.value[d.value]]),c=()=>{const o=p.value;if(!o){t.value.innerHTML="";return}const i=window.XLSX.utils.sheet_to_html(D(o));t.value.innerHTML=i},b=async o=>{if(u(),!/\.xlsx$/g.test(o.name)){alert("Only supports reading xlsx format!");return}const i=new FileReader;p.value=null,i.onload=function(s){const n=s.target.result;d.value=0,p.value=window.XLSX.read(n,{type:"binary"}),c()},i.readAsBinaryString(o)},C=m(!0);K(()=>{de("//unpkg.com/xlsx@0.16.9/xlsx.mini.js",o=>{if(o){window.$message.error(o.message),console.error(o);return}window.$message.success("XLSX Ready!"),console.log("XLSX ready",window.XLSX),_.value=!0})});const f=m(h.json),E=o=>{let i=o.target;if(!me(i)||!f.value||f.value===h.none||!i.innerText)return;let s=i.innerText;console.log(f.value);let n="";o.ctrlKey&&o.altKey?s=v(s,n=h.json):o.ctrlKey?s=v(s,n=h.text):o.altKey?s=v(s,n=h.html):s=v(s,n=f.value),T(s),window.$message.success(n+" copied!");const k=document.createRange();k.selectNode(i);const N=window.getSelection();N&&(N.removeAllRanges(),N.addRange(k))},y=()=>{if(!p.value){const s="Please open Excel file first!";throw window.$message.error(s),new Error(s)}const o=p.value,i={};return o.SheetNames.forEach(function(s){const n=window.XLSX.utils.sheet_to_row_object_array(o.Sheets[s]);n.length>0&&(i[s]=n)}),i},L=m(!1);return{metaTitle:a,iconExcel:ce,sheetNames:g,sheetNameIndex:d,handleImport:b,importFileChooserRef:e,loadDemo(){u();const o=[["Name","Value","Num","Time"],["test001",`line1
line2`,123,new Date],["test001",`line1

line3`,-1,new Date]],i=window.XLSX.utils.aoa_to_sheet(o),s=window.XLSX.utils.book_new();window.XLSX.utils.book_append_sheet(s,i,"Sheet1"),d.value=0,p.value=s,c()},tableWrapperRef:t,handleClick:E,copyMode:f,CopyModeOptions:O,dropdownMenuOptions:[{label:"Copy Sheets JSON",props:{onClick:async()=>{const o=y();T(JSON.stringify(o,null,2)),window.$message.success("Sheet JSON Copied!")}}},{label:"Export Sheets JSON",props:{onClick:async()=>{const o=y();W(H(null,"excel_sheet_export"),JSON.stringify(o,null,2),".json")}}}],isShowCopyDialog:L,formatMultipleLine:v,...j({cbFiles:o=>{o.length&&b(o[0])}}),isTrimEmptyLines:C}}});function fe(e,t,_,p,g,d){const a=R,u=B,D=te,c=se,b=le,C=ae,f=ie,E=I,y=q,L=pe,o=re,i=z,s=M;return x(),$("div",{class:"excel-copy-tool",onDragover:t[8]||(t[8]=X((...n)=>e.fileDragover&&e.fileDragover(...n),["prevent","stop"])),onDragleave:t[9]||(t[9]=X(n=>e.showDropzone=!1,["prevent","stop"])),onDrop:t[10]||(t[10]=X((...n)=>e.fileDrop&&e.fileDrop(...n),["prevent","stop"]))},[l(Z,{name:"mc-fade"},{default:r(()=>[G(l(a,{text:"Drop Excel file here"},null,512),[[Q,e.showDropzone]])]),_:1}),F("div",null,[l(y,{size:"small"},{default:r(()=>[l(E,{subtitle:"",onBack:t[4]||(t[4]=n=>e.$router.push({name:"HomeView"}))},{title:r(()=>[w(Y(e.metaTitle),1)]),avatar:r(()=>[l(u,{src:e.iconExcel,style:{background:"none"}},null,8,["src"])]),extra:r(()=>[l(C,null,{default:r(()=>[l(C,{size:"small",align:"center"},{default:r(()=>[l(D,{size:"small",checked:e.isTrimEmptyLines,"onUpdate:checked":t[0]||(t[0]=n=>e.isTrimEmptyLines=n)},{default:r(()=>[w("Trim empty lines")]),_:1},8,["checked"]),l(c,{text:"",onClick:t[1]||(t[1]=n=>e.isShowCopyDialog=!0)},{default:r(()=>[w("CopyMode:")]),_:1}),l(b,{size:"small",value:e.copyMode,"onUpdate:value":t[2]||(t[2]=n=>e.copyMode=n),options:e.CopyModeOptions,style:{width:"100px"}},null,8,["value","options"])]),_:1}),l(c,{type:"primary",onClick:t[3]||(t[3]=n=>e.importFileChooserRef.chooseFile()),size:"small"},{default:r(()=>[w(" Import Excel ")]),_:1}),l(f,{options:e.dropdownMenuOptions,placement:"bottom-start","key-field":"label"},{default:r(()=>[l(c,{size:"small"},{default:r(()=>[w("Export")]),_:1})]),_:1},8,["options"]),l(c,{onClick:e.loadDemo,size:"small"},{default:r(()=>[w("Demo")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),l(y,{class:"sheet-name-card",size:"small"},{default:r(()=>[l(o,{size:"small",type:"card",animated:"",value:e.sheetNameIndex,"onUpdate:value":t[5]||(t[5]=n=>e.sheetNameIndex=n)},{default:r(()=>[(x(!0),$(ee,null,oe(e.sheetNames,(n,k)=>(x(),ne(L,{style:{padding:"0"},name:k,tab:n,key:n},null,8,["name","tab"]))),128))]),_:1},8,["value"])]),_:1})]),F("div",{ref:"tableWrapperRef",class:"excel-table-container",onClick:t[6]||(t[6]=(...n)=>e.handleClick&&e.handleClick(...n))},null,512),l(i,{ref:"importFileChooserRef",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onSelected:e.handleImport},null,8,["onSelected"]),l(s,{visible:e.isShowCopyDialog,"onUpdate:visible":t[7]||(t[7]=n=>e.isShowCopyDialog=n)},null,8,["visible"])],32)}const ye=P(_e,[["render",fe],["__scopeId","data-v-2c6d49b8"]]);export{ye as default};
