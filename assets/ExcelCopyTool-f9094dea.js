import{_ as M,a as R,C as h,b as O,f as v,u as j,c as B,d as I}from"./use-file-drop-35f602b7.js";import{d as J,_ as z,r as m,s as U,u as V,w as A,o as K,c as T,h as W,g as H,a as P,b as $,e as s,f as i,T as Z,i as F,j as X,k as q,l as x,m as G,v as Q,n as w,t as Y,F as ee,p as oe,q as ne,x as te,y as se,z as le,A as ae,B as ie,C as re,D as pe}from"./index-e6b55280.js";let b=[];const de=(e,n)=>{const _=document.getElementById(e),p=n||function(){};if(!_){const l=document.createElement("script");l.src=e,l.id=e,document.body.appendChild(l),b.push(p),("onload"in l?g:u)(l)}_&&p&&p(null,_);function g(l){l.onload=function(){this.onerror=this.onload=null;for(const d of b)d(null,l);b=[]},l.onerror=function(){this.onerror=this.onload=null,p(new Error("Failed to load "+e),l)}}function u(l){l.onreadystatechange=function(){if(!(this.readyState!=="complete"&&this.readyState!=="loaded")){this.onreadystatechange=null;for(const d of b)d(null,l);b=[]}}}},ue=de,ce=""+new URL("excel-59df11bd.svg",import.meta.url).href,me=e=>e.tagName.toLowerCase()==="td",_e=J({name:"ExcelCopyTool",components:{FileChooser:z,DialogCopyFormat:M,DropZone:R},setup(){const e=m(),n=m(),_=m(!1),p=U(),g=m([]),u=m(0),{metaTitle:l}=V();A(u,()=>{c()});const d=()=>{if(!_.value){const o="XLSX Not Ready!";throw window.$message.error(o),new Error(o)}},C=o=>(g.value=o.SheetNames,o.Sheets[g.value[u.value]]),c=()=>{const o=p.value;if(!o){n.value.innerHTML="";return}const r=window.XLSX.utils.sheet_to_html(C(o));n.value.innerHTML=r},S=async o=>{if(d(),!/\.xlsx$/g.test(o.name)){alert("Only supports reading xlsx format!");return}const r=new FileReader;p.value=null,r.onload=function(a){const t=a.target.result;u.value=0,p.value=window.XLSX.read(t,{type:"binary"}),c()},r.readAsBinaryString(o)},k=m(!0);K(()=>{ue("//unpkg.com/xlsx@0.16.9/xlsx.mini.js",o=>{if(o){window.$message.error(o.message),console.error(o);return}window.$message.success("XLSX Ready!"),console.log("XLSX ready",window.XLSX),_.value=!0})});const f=m(h.json),E=o=>{let r=o.target;if(!me(r)||!f.value||f.value===h.none||!r.innerText)return;let a=r.innerText;console.log(f.value);let t="";o.ctrlKey&&o.altKey?a=v(a,t=h.json):o.ctrlKey?a=v(a,t=h.text):o.altKey?a=v(a,t=h.html):a=v(a,t=f.value),T(a),window.$message.success(t+" copied!");const D=document.createRange();D.selectNode(r);const N=window.getSelection();N&&(N.removeAllRanges(),N.addRange(D))},y=()=>{if(!p.value){const o="Please open Excel file first!";throw window.$message.error(o),new Error(o)}return window.XLSX.utils.sheet_to_json(C(p.value))},L=m(!1);return{metaTitle:l,iconExcel:ce,sheetNames:g,sheetNameIndex:u,handleImport:S,importFileChooserRef:e,loadDemo(){d();const o=[["Name","Value","Num","Time"],["test001",`line1
line2`,123,new Date],["test001",`line1

line3`,-1,new Date]],r=window.XLSX.utils.aoa_to_sheet(o),a=window.XLSX.utils.book_new();window.XLSX.utils.book_append_sheet(a,r,"Sheet1"),u.value=0,p.value=a,c()},tableWrapperRef:n,handleClick:E,copyMode:f,CopyModeOptions:O,dropdownMenuOptions:[{label:"Copy Sheet JSON",props:{onClick:async()=>{const o=y();T(JSON.stringify(o,null,2)),window.$message.success("Sheet JSON Copied!")}}},{label:"Export Sheet JSON",props:{onClick:async()=>{const o=y();W(H(null,"excel_sheet_export"),JSON.stringify(o,null,2),".json")}}}],isShowCopyDialog:L,formatMultipleLine:v,...j({cbFiles:o=>{o.length&&S(o[0])}}),isTrimEmptyLines:k}}});function fe(e,n,_,p,g,u){const l=R,d=B,C=te,c=se,S=le,k=ae,f=ie,E=I,y=q,L=pe,o=re,r=z,a=M;return x(),$("div",{class:"excel-copy-tool",onDragover:n[8]||(n[8]=X((...t)=>e.fileDragover&&e.fileDragover(...t),["prevent","stop"])),onDragleave:n[9]||(n[9]=X(t=>e.showDropzone=!1,["prevent","stop"])),onDrop:n[10]||(n[10]=X((...t)=>e.fileDrop&&e.fileDrop(...t),["prevent","stop"]))},[s(Z,{name:"mc-fade"},{default:i(()=>[G(s(l,{text:"Drop Excel file here"},null,512),[[Q,e.showDropzone]])]),_:1}),F("div",null,[s(y,{size:"small"},{default:i(()=>[s(E,{subtitle:"",onBack:n[4]||(n[4]=t=>e.$router.push({name:"HomeView"}))},{title:i(()=>[w(Y(e.metaTitle),1)]),avatar:i(()=>[s(d,{src:e.iconExcel,style:{background:"none"}},null,8,["src"])]),extra:i(()=>[s(k,null,{default:i(()=>[s(k,{size:"small",align:"center"},{default:i(()=>[s(C,{size:"small",checked:e.isTrimEmptyLines,"onUpdate:checked":n[0]||(n[0]=t=>e.isTrimEmptyLines=t)},{default:i(()=>[w("Trim empty lines")]),_:1},8,["checked"]),s(c,{text:"",onClick:n[1]||(n[1]=t=>e.isShowCopyDialog=!0)},{default:i(()=>[w("CopyMode:")]),_:1}),s(S,{size:"small",value:e.copyMode,"onUpdate:value":n[2]||(n[2]=t=>e.copyMode=t),options:e.CopyModeOptions,style:{width:"100px"}},null,8,["value","options"])]),_:1}),s(c,{type:"primary",onClick:n[3]||(n[3]=t=>e.importFileChooserRef.chooseFile()),size:"small"},{default:i(()=>[w(" Import Excel ")]),_:1}),s(f,{options:e.dropdownMenuOptions,placement:"bottom-start","key-field":"label"},{default:i(()=>[s(c,{size:"small"},{default:i(()=>[w("Export")]),_:1})]),_:1},8,["options"]),s(c,{onClick:e.loadDemo,size:"small"},{default:i(()=>[w("Demo")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),s(y,{class:"sheet-name-card",size:"small"},{default:i(()=>[s(o,{size:"small",type:"card",animated:"",value:e.sheetNameIndex,"onUpdate:value":n[5]||(n[5]=t=>e.sheetNameIndex=t)},{default:i(()=>[(x(!0),$(ee,null,oe(e.sheetNames,(t,D)=>(x(),ne(L,{style:{padding:"0"},name:D,tab:t,key:t},null,8,["name","tab"]))),128))]),_:1},8,["value"])]),_:1})]),F("div",{ref:"tableWrapperRef",class:"excel-table-container",onClick:n[6]||(n[6]=(...t)=>e.handleClick&&e.handleClick(...t))},null,512),s(r,{ref:"importFileChooserRef",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onSelected:e.handleImport},null,8,["onSelected"]),s(a,{visible:e.isShowCopyDialog,"onUpdate:visible":n[7]||(n[7]=t=>e.isShowCopyDialog=t)},null,8,["visible"])],32)}const ye=P(_e,[["render",fe],["__scopeId","data-v-1d5b8e1b"]]);export{ye as default};
