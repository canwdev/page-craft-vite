import{d as L,t as z,u as B,r as y,w as M,_ as O,o as $,c as R,a as p,b,e as l,f as J,g as U,h as T,s as V,i as W,j as X,k as A,l as K,m as F,n as H,v as P,T as Z,F as q,p as G,q as N,x as C,y as Q,z as Y,A as ee,B as oe,C as ne,D as te,E as se}from"./index.289b50d9.js";import{_ as j,u as le,a as ae,b as ie}from"./use-file-drop.8b651099.js";const re=L({name:"CopyExampleDialog",props:{visible:{type:Boolean,default:!1},title:{type:String,default:""},formatText:{type:Function,default:null}},setup(e,{emit:o}){const{formatText:a}=z(e),i=B(e,o,"visible"),c=y(""),m=y("");return M(c,()=>{m.value=a?a.value(c.value):c.value}),{mVisible:i,textInput:c,textOutput:m}}});const pe={class:"style-tools"},ue={class:"common-card"},de={class:"main-box font-code"};function ce(e,o,a,i,c,m){const s=J,_=U;return $(),R(_,{show:e.mVisible,"onUpdate:show":o[2]||(o[2]=u=>e.mVisible=u),preset:"dialog",title:e.title,style:{"min-width":"800px"}},{default:p(()=>[b("div",pe,[b("div",ue,[b("div",de,[l(s,{class:"input-text",type:"textarea",value:e.textInput,"onUpdate:value":o[0]||(o[0]=u=>e.textInput=u),placeholder:"Text Input"},null,8,["value"]),l(s,{class:"input-text",type:"textarea",value:e.textOutput,"onUpdate:value":o[1]||(o[1]=u=>e.textOutput=u),placeholder:"Text Output"},null,8,["value"])])])])]),_:1},8,["show","title"])}const I=O(re,[["render",ce],["__scopeId","data-v-0777a83a"]]);let w=[];const me=(e,o)=>{const a=document.getElementById(e),i=o||function(){};if(!a){const s=document.createElement("script");s.src=e,s.id=e,document.body.appendChild(s),w.push(i),("onload"in s?c:m)(s)}a&&i&&i(null,a);function c(s){s.onload=function(){this.onerror=this.onload=null;for(const _ of w)_(null,s);w=[]},s.onerror=function(){this.onerror=this.onload=null,i(new Error("Failed to load "+e),s)}}function m(s){s.onreadystatechange=function(){if(!(this.readyState!=="complete"&&this.readyState!=="loaded")){this.onreadystatechange=null;for(const _ of w)_(null,s);w=[]}}}},_e=me,fe=""+new URL("excel.59df11bd.svg",import.meta.url).href,x=(e,o)=>{if(o===v.text)return e;let a=e.split(`
`);if(a=a.map(i=>i.trim()),o===v.json)return a.length===1?JSON.stringify(a[0]):JSON.stringify(a,null,2);if(o===v.html)return a.join("<br>")},ye=e=>e.tagName.toLowerCase()==="td",v={none:"none",text:"text",html:"html",json:"json"},ve=Object.values(v).map(e=>({label:e,value:e})),ge=L({name:"ExcelCopyTool",components:{FileChooser:T,CopyExampleDialog:I,DropZone:j},setup(){const e=y(),o=y(),a=y(!1),i=V(),c=y([]),m=y(0);M(m,()=>{u()});const s=()=>{if(!a.value){const n="XLSX Not Ready!";throw window.$message.error(n),new Error(n)}},_=n=>(c.value=n.SheetNames,n.Sheets[c.value[m.value]]),u=()=>{const n=i.value;if(!n){o.value.innerHTML="";return}const d=window.XLSX.utils.sheet_to_html(_(n));o.value.innerHTML=d},S=async n=>{if(s(),!/\.xlsx$/g.test(n.name)){alert("Only supports reading xlsx format!");return}const d=new FileReader;i.value=null,d.onload=function(r){const f=r.target.result;m.value=0,i.value=window.XLSX.read(f,{type:"binary"}),u()},d.readAsBinaryString(n)};W(()=>{_e("//unpkg.com/xlsx@0.16.9/xlsx.mini.js",()=>{window.$message.success("XLSX Ready!"),console.log("XLSX ready",window.XLSX),a.value=!0})});const g=y(v.json),D=n=>{let d=n.target;if(!ye(d)||!g.value||g.value===v.none||!d.innerText)return;let r=d.innerText.trim().replace(/Â /gi," ");console.log(g.value);let f="";n.ctrlKey&&n.altKey?r=x(r,f=v.json):n.ctrlKey?r=x(r,f=v.text):n.altKey?r=x(r,f=v.html):r=x(r,f=g.value),X(r),window.$message.success(f+" copied!");const t=document.createRange();t.selectNode(d);const h=window.getSelection();h&&(h.removeAllRanges(),h.addRange(t))},E=()=>{if(!i.value){const n="Please open Excel file first!";throw window.$message.error(n),new Error(n)}return window.XLSX.utils.sheet_to_json(_(i.value))},k=y(!1);return{iconExcel:fe,sheetNames:c,sheetNameIndex:m,handleImport:S,importFileChooserRef:e,loadDemo(){s();const n=[["\u59D3\u540D","\u6027\u522B","\u5E74\u9F84","\u6CE8\u518C\u65F6\u95F4"],["\u5F20\u4E09","\u7537",18,new Date],["\u674E\u56DB","\u5973",22,new Date]],d=window.XLSX.utils.aoa_to_sheet(n),r=window.XLSX.utils.book_new();window.XLSX.utils.book_append_sheet(r,d,"Sheet1"),m.value=0,i.value=r,u()},tableWrapperRef:o,handleClick:D,copyMode:g,CopyModeOptions:ve,dropdownMenuOptions:[{label:"Copy Sheet JSON",props:{onClick:async()=>{const n=E();X(JSON.stringify(n,null,2)),window.$message.success("Sheet JSON Copied!")}}},{label:"Export Sheet JSON",props:{onClick:async()=>{const n=E();A(K(null,"excel_sheet_export"),JSON.stringify(n,null,2),".json")}}}],isShowCopyExample:k,formatMultipleLine:x,...le({cbFiles:n=>{!n.length||S(n[0])}})}}});const he=C(" ExcelCopyTool "),we=C("CopyMode:"),xe=C(" Import Excel "),be=C("Export"),Ce=C("Demo");function Se(e,o,a,i,c,m){const s=j,_=ae,u=Q,S=Y,g=ee,D=oe,E=ie,k=ne,n=te,d=se,r=T,f=I;return $(),F("div",{class:"excel-copy-tool",onDragover:o[7]||(o[7]=N((...t)=>e.fileDragover&&e.fileDragover(...t),["prevent","stop"])),onDragleave:o[8]||(o[8]=N(t=>e.showDropzone=!1,["prevent","stop"])),onDrop:o[9]||(o[9]=N((...t)=>e.fileDrop&&e.fileDrop(...t),["prevent","stop"]))},[l(Z,{name:"fade"},{default:p(()=>[H(l(s,{text:"Drop Excel file here"},null,512),[[P,e.showDropzone]])]),_:1}),b("div",null,[l(k,{size:"small"},{default:p(()=>[l(E,{subtitle:"",onBack:o[3]||(o[3]=t=>e.$router.push({name:"HomeView"}))},{title:p(()=>[he]),avatar:p(()=>[l(_,{src:e.iconExcel,style:{background:"none"}},null,8,["src"])]),extra:p(()=>[l(g,null,{default:p(()=>[l(g,{size:"small",align:"center"},{default:p(()=>[l(u,{text:"",onClick:o[0]||(o[0]=t=>e.isShowCopyExample=!0)},{default:p(()=>[we]),_:1}),l(S,{size:"small",value:e.copyMode,"onUpdate:value":o[1]||(o[1]=t=>e.copyMode=t),options:e.CopyModeOptions,style:{width:"100px"}},null,8,["value","options"])]),_:1}),l(u,{type:"primary",onClick:o[2]||(o[2]=t=>e.importFileChooserRef.chooseFile()),size:"small"},{default:p(()=>[xe]),_:1}),l(D,{options:e.dropdownMenuOptions,placement:"bottom-start","key-field":"label"},{default:p(()=>[l(u,{size:"small"},{default:p(()=>[be]),_:1})]),_:1},8,["options"]),l(u,{onClick:e.loadDemo,size:"small"},{default:p(()=>[Ce]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),l(k,{class:"sheet-name-card",size:"small"},{default:p(()=>[l(d,{size:"small",type:"card",animated:"",value:e.sheetNameIndex,"onUpdate:value":o[4]||(o[4]=t=>e.sheetNameIndex=t)},{default:p(()=>[($(!0),F(q,null,G(e.sheetNames,(t,h)=>($(),R(n,{style:{padding:"0"},name:h,tab:t,key:t},null,8,["name","tab"]))),128))]),_:1},8,["value"])]),_:1})]),b("div",{ref:"tableWrapperRef",class:"excel-table-container",onClick:o[5]||(o[5]=(...t)=>e.handleClick&&e.handleClick(...t))},null,512),l(r,{ref:"importFileChooserRef",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onSelected:e.handleImport},null,8,["onSelected"]),l(f,{visible:e.isShowCopyExample,"onUpdate:visible":o[6]||(o[6]=t=>e.isShowCopyExample=t),title:"Copy Mode Example: "+e.copyMode,"format-text":t=>e.formatMultipleLine(t,e.copyMode)},null,8,["visible","title","format-text"])],32)}const $e=O(ge,[["render",Se],["__scopeId","data-v-5042e08c"]]);export{$e as default};
