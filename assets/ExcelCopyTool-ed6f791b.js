import{_ as M,a as R,d as O,C as f,b as j,f as g,u as B,c as I,e as J}from"./use-file-drop-e7c36efa.js";import{d as U,_ as z,r as p,s as V,u as A,w as K,o as W,a as H,c as T,h as P,g as Z,b as q,e as $,f as s,i as a,T as G,j as F,k as N,l as Q,m as X,n as Y,v as ee,p as m,t as oe,F as ne,q as te,x as se,y as le,z as ae,A as re,B as ie,C as pe,D as ue,E as ce}from"./index-66297b3d.js";const de=""+new URL("excel-59df11bd.svg",import.meta.url).href,me=n=>n.tagName.toLowerCase()==="td",_e=U({name:"ExcelCopyTool",components:{FileChooser:z,DialogCopyFormat:M,DropZone:R},setup(){const n=p(),t=p(),C=p(!1),u=V(),w=p([]),d=p(0),{metaTitle:b}=A();K(d,()=>{i()});const y=()=>{if(!C.value){const o="XLSX Not Ready!";throw window.$message.error(o),new Error(o)}},k=o=>(w.value=o.SheetNames,o.Sheets[w.value[d.value]]),i=()=>{const o=u.value;if(!o){t.value.innerHTML="";return}const l=window.XLSX.utils.sheet_to_html(k(o));t.value.innerHTML=l},v=async o=>{if(y(),!/\.xlsx$/g.test(o.name)){alert("Only supports reading xlsx format!");return}const l=new FileReader;u.value=null,l.onload=function(e){const r=e.target.result;d.value=0,u.value=window.XLSX.read(r,{type:"binary"}),i()},l.readAsBinaryString(o)},h=p(!0);W(async()=>{try{await O("//unpkg.com/xlsx@0.16.9/xlsx.mini.js")}catch(o){window.$message.error(o.message),console.error(o)}window.$message.success("XLSX Ready!"),console.log("XLSX ready",window.XLSX),C.value=!0});const c=p(f.json),D=o=>{let l=o.target;if(!me(l)||!c.value||c.value===f.none||!l.innerText)return;let e=l.innerText;console.log(c.value);let r="";o.ctrlKey&&o.altKey?e=g(e,r=f.json):o.ctrlKey?e=g(e,r=f.text):o.altKey?e=g(e,r=f.html):e=g(e,r=c.value),T(e),window.$message.success(r+" copied!");const x=document.createRange();x.selectNode(l);const L=window.getSelection();L&&(L.removeAllRanges(),L.addRange(x))},_=()=>{if(!u.value){const e="Please open Excel file first!";throw window.$message.error(e),new Error(e)}const o=u.value,l={};return o.SheetNames.forEach(function(e){const r=window.XLSX.utils.sheet_to_row_object_array(o.Sheets[e]);r.length>0&&(l[e]=r)}),l},E=p(!1),S=()=>{const o=_();P(Z(null,"excel_sheet_export"),JSON.stringify(o,null,2),".json")};return H(()=>{S()}),{metaTitle:b,iconExcel:de,sheetNames:w,sheetNameIndex:d,handleImport:v,importFileChooserRef:n,loadDemo(){y();const o=[["Name","Value","Num","Time"],["test001",`line1
line2`,123,new Date],["test001",`line1

line3`,-1,new Date]],l=window.XLSX.utils.aoa_to_sheet(o),e=window.XLSX.utils.book_new();window.XLSX.utils.book_append_sheet(e,l,"Sheet1"),d.value=0,u.value=e,i()},tableWrapperRef:t,handleClick:D,copyMode:c,CopyModeOptions:j,dropdownMenuOptions:[{label:"Copy Sheets JSON",props:{onClick:async()=>{const o=_();T(JSON.stringify(o,null,2)),window.$message.success("Sheet JSON Copied!")}}},{label:"Export Sheets JSON",props:{onClick:async()=>{S()}}}],isShowCopyDialog:E,formatMultipleLine:g,...B({cbFiles:o=>{o.length&&v(o[0])}}),isTrimEmptyLines:h}}});function fe(n,t,C,u,w,d){const b=R,y=I,k=le,i=ae,v=re,h=ie,c=pe,D=J,_=Q,E=ce,S=ue,o=z,l=M;return X(),$("div",{class:"excel-copy-tool",onDragover:t[8]||(t[8]=N((...e)=>n.fileDragover&&n.fileDragover(...e),["prevent","stop"])),onDragleave:t[9]||(t[9]=N(e=>n.showDropzone=!1,["prevent","stop"])),onDrop:t[10]||(t[10]=N((...e)=>n.fileDrop&&n.fileDrop(...e),["prevent","stop"]))},[s(G,{name:"mc-fade"},{default:a(()=>[Y(s(b,{text:"Drop Excel file here"},null,512),[[ee,n.showDropzone]])]),_:1}),F("div",null,[s(_,{size:"small"},{default:a(()=>[s(D,{subtitle:"",onBack:t[4]||(t[4]=e=>n.$router.push({name:"HomeView"}))},{title:a(()=>[m(oe(n.metaTitle),1)]),avatar:a(()=>[s(y,{src:n.iconExcel,style:{background:"none"}},null,8,["src"])]),extra:a(()=>[s(h,null,{default:a(()=>[s(h,{size:"small",align:"center"},{default:a(()=>[s(k,{size:"small",checked:n.isTrimEmptyLines,"onUpdate:checked":t[0]||(t[0]=e=>n.isTrimEmptyLines=e)},{default:a(()=>[m("Trim empty lines")]),_:1},8,["checked"]),s(i,{text:"",onClick:t[1]||(t[1]=e=>n.isShowCopyDialog=!0)},{default:a(()=>[m("CopyMode:")]),_:1}),s(v,{size:"small",value:n.copyMode,"onUpdate:value":t[2]||(t[2]=e=>n.copyMode=e),options:n.CopyModeOptions,style:{width:"100px"}},null,8,["value","options"])]),_:1}),s(i,{type:"primary",onClick:t[3]||(t[3]=e=>n.importFileChooserRef.chooseFile()),size:"small"},{default:a(()=>[m(" Import Excel ")]),_:1}),s(c,{options:n.dropdownMenuOptions,placement:"bottom-start","key-field":"label"},{default:a(()=>[s(i,{size:"small"},{default:a(()=>[m("Export")]),_:1})]),_:1},8,["options"]),s(i,{onClick:n.loadDemo,size:"small"},{default:a(()=>[m("Demo")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),s(_,{class:"sheet-name-card",size:"small"},{default:a(()=>[s(S,{size:"small",type:"card",animated:"",value:n.sheetNameIndex,"onUpdate:value":t[5]||(t[5]=e=>n.sheetNameIndex=e)},{default:a(()=>[(X(!0),$(ne,null,te(n.sheetNames,(e,r)=>(X(),se(E,{style:{padding:"0"},name:r,tab:e,key:e},null,8,["name","tab"]))),128))]),_:1},8,["value"])]),_:1})]),F("div",{ref:"tableWrapperRef",class:"excel-table-container",onClick:t[6]||(t[6]=(...e)=>n.handleClick&&n.handleClick(...e))},null,512),s(o,{ref:"importFileChooserRef",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onSelected:n.handleImport},null,8,["onSelected"]),s(l,{visible:n.isShowCopyDialog,"onUpdate:visible":t[7]||(t[7]=e=>n.isShowCopyDialog=e)},null,8,["visible"])],32)}const ye=q(_e,[["render",fe],["__scopeId","data-v-7226d02b"]]);export{ye as default};
