import{_ as R,a as z,C as h,b as j,f as v,u as B,c as I,d as J}from"./use-file-drop-2a7bfccd.js";import{d as U,_ as O,r as m,s as V,u as A,w as K,o as W,a as H,c as $,h as P,g as Z,b as q,e as F,f as s,i,T as G,j as M,k as N,l as Q,m as X,n as Y,v as ee,p as w,t as oe,F as ne,q as te,x as se,y as le,z as ae,A as ie,B as re,C as pe,D as ue,E as ce}from"./index-a4cd87e8.js";let S=[];const de=(o,t)=>{const _=document.getElementById(o),r=t||function(){};if(!_){const l=document.createElement("script");l.src=o,l.id=o,document.body.appendChild(l),S.push(r),("onload"in l?g:c)(l)}_&&r&&r(null,_);function g(l){l.onload=function(){this.onerror=this.onload=null;for(const u of S)u(null,l);S=[]},l.onerror=function(){this.onerror=this.onload=null,r(new Error("Failed to load "+o),l)}}function c(l){l.onreadystatechange=function(){if(!(this.readyState!=="complete"&&this.readyState!=="loaded")){this.onreadystatechange=null;for(const u of S)u(null,l);S=[]}}}},me=de,_e=""+new URL("excel-59df11bd.svg",import.meta.url).href,fe=o=>o.tagName.toLowerCase()==="td",ge=U({name:"ExcelCopyTool",components:{FileChooser:O,DialogCopyFormat:R,DropZone:z},setup(){const o=m(),t=m(),_=m(!1),r=V(),g=m([]),c=m(0),{metaTitle:l}=A();K(c,()=>{d()});const u=()=>{if(!_.value){const n="XLSX Not Ready!";throw window.$message.error(n),new Error(n)}},E=n=>(g.value=n.SheetNames,n.Sheets[g.value[c.value]]),d=()=>{const n=r.value;if(!n){t.value.innerHTML="";return}const a=window.XLSX.utils.sheet_to_html(E(n));t.value.innerHTML=a},b=async n=>{if(u(),!/\.xlsx$/g.test(n.name)){alert("Only supports reading xlsx format!");return}const a=new FileReader;r.value=null,a.onload=function(e){const p=e.target.result;c.value=0,r.value=window.XLSX.read(p,{type:"binary"}),d()},a.readAsBinaryString(n)},C=m(!0);W(()=>{me("//unpkg.com/xlsx@0.16.9/xlsx.mini.js",n=>{if(n){window.$message.error(n.message),console.error(n);return}window.$message.success("XLSX Ready!"),console.log("XLSX ready",window.XLSX),_.value=!0})});const f=m(h.json),D=n=>{let a=n.target;if(!fe(a)||!f.value||f.value===h.none||!a.innerText)return;let e=a.innerText;console.log(f.value);let p="";n.ctrlKey&&n.altKey?e=v(e,p=h.json):n.ctrlKey?e=v(e,p=h.text):n.altKey?e=v(e,p=h.html):e=v(e,p=f.value),$(e),window.$message.success(p+" copied!");const T=document.createRange();T.selectNode(a);const x=window.getSelection();x&&(x.removeAllRanges(),x.addRange(T))},y=()=>{if(!r.value){const e="Please open Excel file first!";throw window.$message.error(e),new Error(e)}const n=r.value,a={};return n.SheetNames.forEach(function(e){const p=window.XLSX.utils.sheet_to_row_object_array(n.Sheets[e]);p.length>0&&(a[e]=p)}),a},L=m(!1),k=()=>{const n=y();P(Z(null,"excel_sheet_export"),JSON.stringify(n,null,2),".json")};return H(()=>{k()}),{metaTitle:l,iconExcel:_e,sheetNames:g,sheetNameIndex:c,handleImport:b,importFileChooserRef:o,loadDemo(){u();const n=[["Name","Value","Num","Time"],["test001",`line1
line2`,123,new Date],["test001",`line1

line3`,-1,new Date]],a=window.XLSX.utils.aoa_to_sheet(n),e=window.XLSX.utils.book_new();window.XLSX.utils.book_append_sheet(e,a,"Sheet1"),c.value=0,r.value=e,d()},tableWrapperRef:t,handleClick:D,copyMode:f,CopyModeOptions:j,dropdownMenuOptions:[{label:"Copy Sheets JSON",props:{onClick:async()=>{const n=y();$(JSON.stringify(n,null,2)),window.$message.success("Sheet JSON Copied!")}}},{label:"Export Sheets JSON",props:{onClick:async()=>{k()}}}],isShowCopyDialog:L,formatMultipleLine:v,...B({cbFiles:n=>{n.length&&b(n[0])}}),isTrimEmptyLines:C}}});function we(o,t,_,r,g,c){const l=z,u=I,E=le,d=ae,b=ie,C=re,f=pe,D=J,y=Q,L=ce,k=ue,n=O,a=R;return X(),F("div",{class:"excel-copy-tool",onDragover:t[8]||(t[8]=N((...e)=>o.fileDragover&&o.fileDragover(...e),["prevent","stop"])),onDragleave:t[9]||(t[9]=N(e=>o.showDropzone=!1,["prevent","stop"])),onDrop:t[10]||(t[10]=N((...e)=>o.fileDrop&&o.fileDrop(...e),["prevent","stop"]))},[s(G,{name:"mc-fade"},{default:i(()=>[Y(s(l,{text:"Drop Excel file here"},null,512),[[ee,o.showDropzone]])]),_:1}),M("div",null,[s(y,{size:"small"},{default:i(()=>[s(D,{subtitle:"",onBack:t[4]||(t[4]=e=>o.$router.push({name:"HomeView"}))},{title:i(()=>[w(oe(o.metaTitle),1)]),avatar:i(()=>[s(u,{src:o.iconExcel,style:{background:"none"}},null,8,["src"])]),extra:i(()=>[s(C,null,{default:i(()=>[s(C,{size:"small",align:"center"},{default:i(()=>[s(E,{size:"small",checked:o.isTrimEmptyLines,"onUpdate:checked":t[0]||(t[0]=e=>o.isTrimEmptyLines=e)},{default:i(()=>[w("Trim empty lines")]),_:1},8,["checked"]),s(d,{text:"",onClick:t[1]||(t[1]=e=>o.isShowCopyDialog=!0)},{default:i(()=>[w("CopyMode:")]),_:1}),s(b,{size:"small",value:o.copyMode,"onUpdate:value":t[2]||(t[2]=e=>o.copyMode=e),options:o.CopyModeOptions,style:{width:"100px"}},null,8,["value","options"])]),_:1}),s(d,{type:"primary",onClick:t[3]||(t[3]=e=>o.importFileChooserRef.chooseFile()),size:"small"},{default:i(()=>[w(" Import Excel ")]),_:1}),s(f,{options:o.dropdownMenuOptions,placement:"bottom-start","key-field":"label"},{default:i(()=>[s(d,{size:"small"},{default:i(()=>[w("Export")]),_:1})]),_:1},8,["options"]),s(d,{onClick:o.loadDemo,size:"small"},{default:i(()=>[w("Demo")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),s(y,{class:"sheet-name-card",size:"small"},{default:i(()=>[s(k,{size:"small",type:"card",animated:"",value:o.sheetNameIndex,"onUpdate:value":t[5]||(t[5]=e=>o.sheetNameIndex=e)},{default:i(()=>[(X(!0),F(ne,null,te(o.sheetNames,(e,p)=>(X(),se(L,{style:{padding:"0"},name:p,tab:e,key:e},null,8,["name","tab"]))),128))]),_:1},8,["value"])]),_:1})]),M("div",{ref:"tableWrapperRef",class:"excel-table-container",onClick:t[6]||(t[6]=(...e)=>o.handleClick&&o.handleClick(...e))},null,512),s(n,{ref:"importFileChooserRef",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onSelected:o.handleImport},null,8,["onSelected"]),s(a,{visible:o.isShowCopyDialog,"onUpdate:visible":t[7]||(t[7]=e=>o.isShowCopyDialog=e)},null,8,["visible"])],32)}const ve=q(ge,[["render",we],["__scopeId","data-v-b9cf4550"]]);export{ve as default};
