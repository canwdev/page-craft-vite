import{d as e,o as l,m as a,x as t,d2 as n,e as s,d3 as o,w as i,d4 as u,bu as r,r as c,b as d,d5 as v,d6 as p,d7 as m,d8 as h,d9 as w,h as g,bN as f,G as b,da as y,db as C,u as x,cF as k,dc as S,bB as V,c as z,y as A,n as _,q as R,E as M,D as B,bG as L,z as $,co as E,v as I,C as U,B as T,Q as H,bH as N,bM as O,cm as P,d1 as F,dd as G,bm as K,de as j,df as q,bP as J}from"./index-3hzdRt7D.js";const D={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Y=[t("g",{fill:"none"},[t("path",{d:"M15 3a.5.5 0 0 0-1 0v2h-2a.5.5 0 0 0 0 1h2v2a.5.5 0 0 0 1 0V6h2a.5.5 0 0 0 0-1h-2V3zM4.5 17A1.5 1.5 0 0 1 3 15.5v-11A1.5 1.5 0 0 1 4.5 3H9a1.5 1.5 0 0 1 1.5 1.5v5h5A1.5 1.5 0 0 1 17 11v4.5a1.5 1.5 0 0 1-1.5 1.5h-11zm6-6.5V16h5a.5.5 0 0 0 .5-.5V11a.5.5 0 0 0-.5-.5h-5zm-1 5.5v-5.5H4v5a.5.5 0 0 0 .5.5h5zm0-11.5A.5.5 0 0 0 9 4H4.5a.5.5 0 0 0-.5.5v5h5.5v-5z",fill:"currentColor"})],-1)],Q=e({name:"AppsAddIn20Regular",render:function(e,t){return l(),a("svg",D,Y)}}),W={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},X=[t("g",{fill:"none"},[t("path",{d:"M7.5 2a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2a.5.5 0 0 1 .5-.5zM3.61 3.61a.5.5 0 0 1 .708 0l1.414 1.415a.5.5 0 1 1-.707.707L3.611 4.318a.5.5 0 0 1 0-.707zm7.78 0a.5.5 0 0 1 0 .708L9.974 5.732a.5.5 0 1 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zM2 7.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5zm6.64-.2A1 1 0 0 0 7 8.067v9.101c0 .924 1.145 1.354 1.753.659l2.026-2.316A1.5 1.5 0 0 1 11.908 15h3.211c.935 0 1.359-1.17.64-1.768L8.64 7.299zM8 17.17V8.067L15.119 14h-3.211a2.5 2.5 0 0 0-1.882.854L8 17.169z",fill:"currentColor"})],-1)],Z=e({name:"CursorClick20Regular",render:function(e,t){return l(),a("svg",W,X)}}),ee={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},le=[t("g",{fill:"none"},[t("path",{d:"M2 6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v7a2 2 0 0 1-1.164 1.818a1.497 1.497 0 0 0-.275-.379l-.446-.446A1 1 0 0 0 17 13V6a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h5v1H4a2 2 0 0 1-2-2V6zm8.854 4.146A.5.5 0 0 0 10 10.5v7a.5.5 0 0 0 .91.287l1.571-2.245l2.943.452a.5.5 0 0 0 .43-.848l-5-5zM11 15.915v-4.207l3.066 3.067l-1.74-.268a.5.5 0 0 0-.486.207l-.84 1.2z",fill:"currentColor"})],-1)],ae=e({name:"CursorHover20Regular",render:function(e,t){return l(),a("svg",ee,le)}}),te={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},ne=[t("g",{fill:"none"},[t("path",{d:"M5.5 1.999a.5.5 0 0 0-.5.5v8.504a2 2 0 0 0 2 2h1.004v2.998a2 2 0 1 0 4 0v-2.998H13a2 2 0 0 0 2-2V2.5a.5.5 0 0 0-.5-.5h-9zm.5 8.004h8v1a1 1 0 0 1-1 1h-1.496a.5.5 0 0 0-.5.5v3.498a1 1 0 1 1-2 0v-3.498a.5.5 0 0 0-.5-.5H7a1 1 0 0 1-1-1v-1zm8-1H6V3h4v1.5a.5.5 0 0 0 1 0v-1.5h1v2.502a.5.5 0 0 0 1 0V3h1v6.004z",fill:"currentColor"})],-1)],se=e({name:"PaintBrush20Regular",render:function(e,t){return l(),a("svg",te,ne)}}),oe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},ie=[t("g",{fill:"none"},[t("path",{d:"M16.5 2a.5.5 0 0 1 .5.5V3h.5a.5.5 0 0 1 0 1H17v.5a.5.5 0 0 1-1 0V4h-.5a.5.5 0 1 1 0-1h.5v-.5a.5.5 0 0 1 .5-.5zm-10 4a.5.5 0 0 0 0-1H6v-.5a.5.5 0 0 0-1 0V5h-.5a.5.5 0 0 0 0 1H5v.5a.5.5 0 0 0 1 0V6h.5zm9 9a.5.5 0 0 0 0-1H15v-.5a.5.5 0 0 0-1 0v.5h-.5a.5.5 0 1 0 0 1h.5v.5a.5.5 0 1 0 1 0V15h.5zm-2.066-8.434a1.914 1.914 0 0 0-2.707 0l-8.166 8.166a1.914 1.914 0 1 0 2.707 2.707l8.166-8.166a1.914 1.914 0 0 0 0-2.707zm-2 .707a.914.914 0 0 1 1.293 1.293l-.477.477l-1.293-1.293l.477-.477zM10.25 8.457l1.293 1.293l-6.982 6.982a.914.914 0 0 1-1.293-1.292l6.982-6.983z",fill:"currentColor"})],-1)],ue=e({name:"Wand20Regular",render:function(e,t){return l(),a("svg",oe,ie)}}),re=e({__name:"ElementByPoint",props:{parentClass:{default:void 0}},emits:["select"],setup(e,{emit:n}){const s=e,{parentClass:o}=r(s),i=n,u=c(null);d((()=>{o.value&&(u.value=document.querySelector(o.value))}));const{x:y,y:C}=v({type:"client"}),{element:x}=p({x:y,y:C}),k=m(h(x));w("scroll",k.update,!0);const S=g((()=>!(u.value&&!u.value.contains(x.value)||u.value===x.value))),V=g((()=>x.value&&S.value?{display:"block",width:`${k.width}px`,height:`${k.height}px`,left:`${k.left}px`,top:`${k.top}px`,transition:"all 0.05s linear"}:{display:"none"})),z=g((()=>({transform:`translate(calc(${y.value}px - 50%), calc(${C.value}px - 50%))`,color:S.value?"white":"grey"})));return w("click",(e=>{S.value&&(e.stopPropagation(),e.preventDefault(),i("select",x.value))}),{capture:!0}),(e,n)=>(l(),a(b,null,[t("div",{style:f(V.value),class:"mc-element-by-point-box"},null,4),t("div",{style:f(z.value),class:"mc-element-by-point-pointer"},null,4)],64))}}),ce=["title"],de=["title"],ve=["title"],pe=["title"],me={class:"style-editor-inner"},he={key:0,class:"style-editor-action-bar"},we={class:"code-editor-placeholder"},ge=e({__name:"index",props:{visible:{type:Boolean,default:!1},selecting:{type:Boolean,default:!1},selectingParentClass:{default:void 0},showTabs:{type:Boolean,default:!1},styleCode:{default:""}},emits:["update:visible","update:selecting","onFormat","onInsertCode","update:styleCode"],setup(e,{expose:v,emit:p}){const m=e,{showTabs:h}=r(m),f=p,{t:D}=x(),Y=k(m,"visible",f),W=n(),{globalStyleCode:X}=(()=>{const e=n(),l=s(o.GLOBAL_STYLE,"");i(l,(e=>{a()}));const a=async()=>{try{e.globalCSS=l.value?await u(l.value):""}catch(a){window.$message.error(a.message)}};return{globalStyleCode:l}})(),ee=s(o.VARIABLES_STYLE,""),le=k(m,"styleCode",f,{passive:!0});i(le,(()=>{ye()}));const te=c(),ne=c(!1),oe=()=>{const e=te.value.getInstance();null==e||e.layout()},ie=()=>{ne.value||setTimeout((()=>{te.value.getInstance().focus()}),100)};i(Y,(e=>{e&&(oe(),ie())})),i(ne,(e=>{e||ie()}));const ge=c(),fe=()=>{console.warn(ge.value.message,{...ge.value}),setTimeout((()=>{ge.value=null}),500)},be=c(""),ye=async()=>{try{const e=ee.value+"\n"+le.value;if(be.value===e)return;be.value=e;const l=e?await u(e):"";W.currentCSS=l,ge.value=""}catch(e){ge.value=e}};i(ee,(()=>{ye()}),{immediate:!0});const Ce=async()=>{var e;const l=te.value.getInstance(),a=l.getValue();if(a.trim()){const t=G(a);if(a.trim()!==t.trim()){const a=null==(e=l.getModel())?void 0:e.getFullModelRange();a?l.executeEdits(null,[{text:t,range:a}]):le.value=t}}l.focus(),f("onFormat")},xe=()=>{const e=te.value.getInstance().getValue();window.$qlUtils.copy(e)},ke=k(m,"selecting",f,{passive:!0}),Se=e=>{ke.value&&(Ve({el:e}),ke.value=!1)},Ve=({el:e,code:l="",isAppend:a=!1})=>{K((()=>{if(e){let a=j(e);if(!a)return;l=`\n${a} {\n\n}\n`}l&&ze(l,a)}))},ze=(e,l=!1)=>{if(f("onInsertCode"),l)return void(le.value=le.value+"\n"+e);const a=te.value.getInstance(),t=a.getSelection();a.executeEdits("",[{range:new q.Range((null==t?void 0:t.startLineNumber)||0,(null==t?void 0:t.startColumn)||0,(null==t?void 0:t.endLineNumber)||0,(null==t?void 0:t.endColumn)||0),text:e,forceMoveMarkers:!0}]),setTimeout((()=>{a.focus()}),100)},{snippetsOptions:Ae,updateEditorAutoComplete:_e}=(({insertCode:e,vueMonacoRef:l})=>{const a=s(o.CUSTOM_SNIPPETS,[]),t=()=>{C.$monacoScssSnippetsCustom=[],i(a.value)};d((()=>{t()}));const n=(l,a)=>{const t={label:l.label,props:{}};if(l.code||l.snippet){a&&a(l);const n=l.snippet||l.code;t.props.onClick=async()=>{e(n)},t.props.onContextmenu=async()=>{window.$qlUtils.copy(n)}}return t},i=(e=[],l=[])=>(e.forEach((e=>{l.push({children:e.children?u(e.children):void 0,...n(e,(e=>{e.snippet&&C.$monacoScssSnippetsCustom.push({label:e.label,snippet:e.snippet})}))})})),l),u=(e=[],l=[])=>(e.forEach((e=>{l.push({children:e.children?u(e.children):void 0,...n(e)})})),l),{options:r}=y({fetchFn:async()=>{const e=await fetch("./scss-snippets.json");return await e.json()},mapFn:e=>n(e,(e=>{e.snippet&&C.$monacoScssSnippets.push({label:e.label,snippet:e.snippet})}))});return{snippetsOptions:g((()=>{const e=[...r.value,{label:"⚙️ Manage",children:[{label:"➕ Add custom snippet",props:{onClick:async()=>{const e=l.value.getInstance(),n=e.getSelection();let s=e.getModel().getValueInRange(n).trim();if(!s)return void window.$message.error("Please select code first!");let o=/\.(\w|-)+/g.exec(s)||[];console.log(o);let i=await window.$mcUtils.showInputPrompt({title:"Input snippet label",value:o[0]||""});i?(a.value.push({label:i,snippet:s}),t()):window.$message.error("Please input label!")}}},{label:"📥 Import JSON...",props:{onClick:async()=>{const e=await window.$mcUtils.handleImportJson();a.value=e||[],window.$message.success("Import success!")}}},{label:"📤 Export JSON...",props:{onClick:async()=>{window.$mcUtils.handleExportFile(await window.$mcUtils.promptGetFileName("ScssSnippets"),JSON.stringify(a.value,null,2),".json")}}},{label:"❌ Clear All...",children:[{label:"✅ Confirm Clear All Custom Snippets",props:{onClick:()=>{a.value=[],t()}}},{label:"❎ Cancel",props:{isBack:1}}]}]}];return a.value.length&&e.push({label:"🔮 Custom",children:[...u(a.value)]}),e})),updateEditorAutoComplete:e=>{const l=new Set;let a,t=/\.(\w|-)+/g,n=/\$[\w-]+/g;for(;null!==(a=t.exec(e));)l.add(a[0]);for(;null!==(a=n.exec(e));)l.add(a[0]);C.$monacoScssVariables=Array.from(l)}}})({insertCode:ze,vueMonacoRef:te}),Re=c([{label:D("common.global_style"),value:S.GLOBAL},{label:D("common.variables"),value:S.VARIABLES},{label:D("actions.current"),value:S.CURRENT}]),Me=s(o.CURRENT_TAB,S.CURRENT,localStorage,{listenToStorageChanges:!1});i(h,(e=>{e||(Me.value=S.GLOBAL)}),{immediate:!0}),i((()=>Me),(e=>{_e(X.value+ee.value)}),{immediate:!0});const Be=e=>{const l=e.key.toLowerCase();e.ctrlKey&&e.shiftKey&&"f"===l&&Ce()};return w(document,"keydown",(e=>{if(!Y.value)return;const l=e.key.toLowerCase();e.ctrlKey&&e.shiftKey&&"x"===l?ke.value=!ke.value:e.altKey&&"`"===l&&(ne.value=!ne.value)})),v({handleAddStyle:Ve}),(e,n)=>{const s=J;return l(),a(b,null,[V(ke)?(l(),z(re,{key:0,onSelect:Se,"parent-class":V(Me)===V(S).CURRENT?e.selectingParentClass:void 0},null,8,["parent-class"])):A("",!0),_(F,{class:"mc-style-editor-dialog",visible:V(Y),"onUpdate:visible":n[7]||(n[7]=e=>N(Y)?Y.value=e:null),onResize:oe,wid:"style_editor",onKeyup:Be,onOnActive:ie,"allow-maximum":""},{titleBarLeft:R((()=>[_(s,{class:"window-icon",size:"18"},{default:R((()=>[_(V(se))])),_:1}),B(M(V(D)("common.style_editor"))+" (scss) ",1)])),titleBarRightControls:R((()=>[t("button",{title:V(D)("msgs.select_an_element_in")+" (ctrl+shift+x)",class:L({active:V(ke)}),onClick:n[0]||(n[0]=$((e=>ke.value=!V(ke)),["stop","prevent"]))},[_(s,{size:"20"},{default:R((()=>[V(ke)?(l(),z(V(Z),{key:1})):(l(),z(V(ae),{key:0}))])),_:1})],10,ce),t("button",{onClick:n[1]||(n[1]=e=>ne.value=!V(ne)),title:V(D)("actions.add_tool_codes")},[_(s,{size:"20"},{default:R((()=>[_(V(Q))])),_:1})],8,de),t("button",{title:V(D)("actions.beautify_code")+" (ctrl+shift+f)",onClick:Ce},[_(s,{size:"20"},{default:R((()=>[_(V(ue))])),_:1})],8,ve),t("button",{title:V(D)("actions.copy_code")+" (ctrl+a ctrl+c)",onClick:xe},[_(s,{size:"20"},{default:R((()=>[_(V(E))])),_:1})],8,pe)])),default:R((()=>[_(I,{name:"mc-fade"},{default:R((()=>{var e;return[T(t("div",{class:"code-mc-error-tip-button font-code",onClick:fe},M(null==(e=V(ge))?void 0:e.message),513),[[U,V(ge)]])]})),_:1}),t("div",me,[_(H,{visible:V(ne),"onUpdate:visible":n[2]||(n[2]=e=>N(ne)?ne.value=e:null),options:V(Ae),title:`${V(D)("actions.add_tool_codes")} (alt+\`)`,class:"font-code",style:{top:"2px",right:"2px"}},null,8,["visible","options","title"]),V(h)?(l(),a("div",he,[_(O,{modelValue:V(Me),"onUpdate:modelValue":n[3]||(n[3]=e=>N(Me)?Me.value=e:null),"tab-list":V(Re),horizontal:""},null,8,["modelValue","tab-list"])])):A("",!0),t("div",we,[V(Me)===V(S).GLOBAL?(l(),z(P,{key:0,ref_key:"vueMonacoRef",ref:te,modelValue:V(X),"onUpdate:modelValue":n[4]||(n[4]=e=>N(X)?X.value=e:null),language:"scss","debounce-ms":500,"show-line-numbers":""},null,8,["modelValue"])):V(Me)===V(S).VARIABLES?(l(),z(P,{key:1,ref_key:"vueMonacoRef",ref:te,modelValue:V(ee),"onUpdate:modelValue":n[5]||(n[5]=e=>N(ee)?ee.value=e:null),language:"scss","debounce-ms":500,"show-line-numbers":""},null,8,["modelValue"])):(l(),z(P,{key:2,ref_key:"vueMonacoRef",ref:te,modelValue:V(le),"onUpdate:modelValue":n[6]||(n[6]=e=>N(le)?le.value=e:null),language:"scss","debounce-ms":500,"show-line-numbers":""},null,8,["modelValue"]))])])])),_:1},8,["visible"])],64)}}});export{ge as default};
