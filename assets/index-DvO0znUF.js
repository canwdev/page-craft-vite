const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./howler-C6bUR820.js","./index-B_8g2bxo.js","./index-CHk4c8gu.css"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=(t,a,n)=>((t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n)(t,"symbol"!=typeof a?a+"":a,n);import{d as a,o as n,c as l,a as o,r as i,s as r,ae as s,z as c,y as d,b as u,E as p,M as A,a6 as m,P as g,af as v,Y as h,ag as y,N as b,a3 as f,ah as w,ac as S,t as C,ai as k,aj as E,ak as x,al as T,e as _,f as M,g as L,n as R,F as P,_ as D,A as H,x as O,u as U,B as N,am as I,an as $,v as z,G as B,ao as F,ap as j,i as V,p as q,l as W,a1 as Y,k as G,aq as X,aa as J,a8 as Z,ar as K,as as Q,m as ee,T as te,S as ae,h as ne,w as le,D as oe,a9 as ie}from"./index-B_8g2bxo.js";import{F as re}from"./FileChooser-X9fYpU-s.js";import{g as se,b as ce,a as de}from"./index-BWzdhM7Z.js";import{A as ue,a as pe}from"./index-CdL_N0M1.js";import{u as Ae,a as me}from"./use-beforeunload-CnEAWhnx.js";import{n as ge,f as ve}from"./humanfs-api-DpvoJ6Sz.js";import{p as he}from"./index-vcidOvW8.js";import{u as ye}from"./use-model-wrapper-C3eqSSDB.js";import{V as be}from"./index-Byyymg_I.js";import{_ as fe,a as we}from"./AdvancedNumberInput-CDufGYGU.js";import{V as Se}from"./index-B6cBd3b0.js";import{_ as Ce}from"./Dropdown-CsBF2fzf.js";import{N as ke}from"./Icon-CMxllykI.js";import{_ as Ee}from"./Checkbox-BMCJIerk.js";import{_ as xe}from"./Popover-BKGBJvpF.js";import{_ as Te}from"./ButtonGroup-BslXupHZ.js";const _e={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Me=[o("g",{fill:"none"},[o("path",{d:"M13.14 6.5h-2.387a.75.75 0 1 0 0 1.5h4.4c.47 0 .85-.38.85-.85v-4.4a.75.75 0 0 0-1.5 0v2.947l-3.059-2.66a5.25 5.25 0 0 0-6.888 7.925l8.172 7.104a.75.75 0 1 0 .984-1.132L5.54 9.83a3.75 3.75 0 1 1 4.92-5.66l2.68 2.33z",fill:"currentColor"})],-1)],Le=a({name:"ArrowRedo20Filled",render:function(e,t){return n(),l("svg",_e,Me)}}),Re={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Pe=[o("g",{fill:"none"},[o("path",{d:"M6.862 6.5H9.25a.75.75 0 0 1 0 1.5h-4.4A.85.85 0 0 1 4 7.15v-4.4a.75.75 0 0 1 1.5 0v2.947l3.059-2.66a5.25 5.25 0 0 1 6.888 7.925l-8.172 7.104a.75.75 0 1 1-.984-1.132l8.172-7.104a3.75 3.75 0 1 0-4.92-5.66L6.863 6.5z",fill:"currentColor"})],-1)],De=a({name:"ArrowUndo20Filled",render:function(e,t){return n(),l("svg",Re,Pe)}}),He={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Oe=[o("g",{fill:"none"},[o("path",{d:"M12.937 4.052a.75.75 0 0 0-1.373-.604l-5.5 12.5a.75.75 0 1 0 1.372.604l5.5-12.5zm1.356 9.793a.75.75 0 0 1-.137-1.052L16.303 10l-2.148-2.793a.75.75 0 0 1 1.188-.914l2.5 3.25a.75.75 0 0 1 0 .915l-2.5 3.25a.75.75 0 0 1-1.051.137zm-8.586-7.69a.75.75 0 0 1 .137 1.053L3.696 10l2.148 2.793a.75.75 0 1 1-1.188.915l-2.5-3.25a.75.75 0 0 1 0-.915l2.5-3.25a.75.75 0 0 1 1.051-.137z",fill:"currentColor"})],-1)],Ue=a({name:"Code20Filled",render:function(e,t){return n(),l("svg",He,Oe)}}),Ne={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Ie=[o("g",{fill:"none"},[o("path",{d:"M10 2a8 8 0 1 1 0 16a8 8 0 0 1 0-16zm0 1a7 7 0 1 0 0 14a7 7 0 0 0 0-14zm0 10.5a.75.75 0 1 1 0 1.5a.75.75 0 0 1 0-1.5zm0-8a2.5 2.5 0 0 1 1.651 4.377l-.154.125l-.219.163l-.087.072a1.968 1.968 0 0 0-.156.149c-.339.36-.535.856-.535 1.614a.5.5 0 0 1-1 0c0-1.012.293-1.752.805-2.298a3.11 3.11 0 0 1 .356-.323l.247-.185l.118-.1A1.5 1.5 0 1 0 8.5 8a.5.5 0 0 1-1 .001A2.5 2.5 0 0 1 10 5.5z",fill:"currentColor"})],-1)],$e=a({name:"QuestionCircle20Regular",render:function(e,t){return n(),l("svg",Ne,Ie)}}),ze={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Be=[o("g",{fill:"none"},[o("path",{d:"M1.91 7.383a8.491 8.491 0 0 1 1.78-3.08a.5.5 0 0 1 .54-.135l1.918.686a1 1 0 0 0 1.32-.762l.366-2.006a.5.5 0 0 1 .388-.4a8.532 8.532 0 0 1 3.555 0a.5.5 0 0 1 .387.4l.367 2.006a1 1 0 0 0 1.32.762l1.918-.686a.5.5 0 0 1 .54.136a8.491 8.491 0 0 1 1.78 3.079a.5.5 0 0 1-.152.535l-1.555 1.32a1 1 0 0 0 0 1.524l1.555 1.32a.5.5 0 0 1 .152.535a8.491 8.491 0 0 1-1.78 3.08a.5.5 0 0 1-.54.135l-1.918-.686a1 1 0 0 0-1.32.762l-.367 2.007a.5.5 0 0 1-.387.399a8.53 8.53 0 0 1-3.555 0a.5.5 0 0 1-.388-.4l-.365-2.006a1 1 0 0 0-1.32-.762l-1.919.686a.5.5 0 0 1-.54-.136a8.49 8.49 0 0 1-1.78-3.079a.5.5 0 0 1 .153-.535l1.554-1.32a1 1 0 0 0 0-1.524l-1.554-1.32a.5.5 0 0 1-.153-.535zm1.061-.006l1.294 1.098a2 2 0 0 1 0 3.05L2.97 12.623c.292.782.714 1.51 1.245 2.152l1.596-.57a2 2 0 0 1 2.64 1.525l.305 1.668a7.556 7.556 0 0 0 2.485 0l.305-1.67a1.998 1.998 0 0 1 2.64-1.524l1.597.571a7.492 7.492 0 0 0 1.245-2.152l-1.294-1.098a1.998 1.998 0 0 1 0-3.05l1.294-1.098a7.491 7.491 0 0 0-1.245-2.152l-1.596.57a2 2 0 0 1-2.64-1.524l-.306-1.669a7.555 7.555 0 0 0-2.485 0l-.304 1.669a2 2 0 0 1-2.641 1.525l-1.596-.571a7.491 7.491 0 0 0-1.245 2.152zM7.5 10a2.5 2.5 0 1 1 5 0a2.5 2.5 0 0 1-5 0zm1 0a1.5 1.5 0 1 0 3 0a1.5 1.5 0 0 0-3 0z",fill:"currentColor"})],-1)],Fe=a({name:"Settings20Regular",render:function(e,t){return n(),l("svg",ze,Be)}});function je(e,{volume:t=1,playbackRate:a=1,soundEnabled:n=!0,interrupt:l=!1,autoplay:o=!1,onload:u,...p}={}){const A=i(null),m=i(!1),g=i(null),v=i(null);function h(){var e;"function"==typeof u&&u.call(this),g.value=1e3*(g.value||(null==(e=v.value)?void 0:e.duration())||0),!0===o&&(m.value=!0)}r((async()=>{const n=await s((()=>import("./howler-C6bUR820.js").then((e=>e.h))),__vite__mapDeps([0,1,2]),import.meta.url);A.value=n.default.Howl,v.value=new A.value({src:c(e),volume:c(t),rate:c(a),onload:h,...p})})),d((()=>[e]),(()=>{A.value&&A.value&&v&&v.value&&(v.value=new A.value({src:c(e),volume:c(t),rate:c(a),onload:h,...p}))})),d((()=>[c(t),c(a)]),(()=>{v.value&&(v.value.volume(c(t)),v.value.rate(c(a)))}));return{play:e=>{void 0===e&&(e={}),v.value&&(n||e.forceSoundEnabled)&&(l&&v.value.stop(),e.playbackRate&&v.value.rate(e.playbackRate),v.value.play(e.id),v.value.once("end",(()=>{v.value&&v.value&&!v.value.playing()&&(m.value=!1)})),m.value=!0)},sound:v,isPlaying:m,duration:g,pause:e=>{v.value&&(v.value.pause("number"==typeof e?e:void 0),m.value=!1)},stop:e=>{v.value&&(v.value.stop("number"==typeof e?e:void 0),m.value=!1)}}}const Ve=""+new URL("open-UeZQ83h4.ogg",import.meta.url).href,qe=""+new URL("close1-BakA0P2g.ogg",import.meta.url).href,We=""+new URL("select_pattern_mix-DXw_mqqO.ogg",import.meta.url).href,Ye=""+new URL("wood_mix-zCSPzndQ.ogg",import.meta.url).href,Ge=""+new URL("grass_mix-BApjfdS6.ogg",import.meta.url).href,Xe=""+new URL("loading_middle2-D1wQur0C.ogg",import.meta.url).href,Je=""+new URL("shoot2-Bgro1KOW.ogg",import.meta.url).href,Ze=""+new URL("brushing_generic2-B670JkA0.ogg",import.meta.url).href,Ke=""+new URL("bell-XX7Mxd8B.ogg",import.meta.url).href,Qe=""+new URL("fill1-B_y51Az1.ogg",import.meta.url).href,et=""+new URL("guitar-BG0qG-kv.ogg",import.meta.url).href,tt=""+new URL("bass-FEG0pYKb.ogg",import.meta.url).href,at=e=>{const t=u(),{play:a}=je(Ve,{volume:1,soundEnabled:t.enableSoundFx}),{play:n}=je(qe,{volume:1,soundEnabled:t.enableSoundFx});d(e,(e=>{e?a():n()}))},nt=e=>{const t=u(),{play:a}=je(Xe,{volume:1,soundEnabled:t.enableSoundFx}),{play:n}=je(Je,{volume:1,soundEnabled:t.enableSoundFx});d(e,(e=>{e?a():n()}))},lt=()=>{const e=u(),{play:t,stop:a}=je(We,{volume:1,soundEnabled:e.enableSoundFx,sprite:{id_0:[0,500],id_1:[600,539],id_2:[1196,539],id_3:[1878,576],id_4:[2472,696]}});return{play:()=>{t({id:`id_${Math.floor(5*Math.random())}`})},stop:a}},ot=()=>{const e=u();return je(Ze,{volume:1,soundEnabled:e.enableSoundFx})},it=()=>{const e=u();return je(Qe,{volume:1,soundEnabled:e.enableSoundFx})},rt=()=>je("data:audio/mpeg;base64,SUQzAwAAAAAAFgAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/+7BgAAAG0WjNZT8gCAAACXCgAAEaeXdl+P2AAAAAJcMAAACyFElJrUoQua0XwehGG+h6Hqur9jT6jV8dsQxYdMdQeFI2GIUZxgQYFyzquOpwHMMbRXTDgepjGJZunp6fPUocuH78ofx/JZjG3IdyWXZXDcbtzD/w/3k21td7T3gQlphuvclmMrn4g5cP5SiWY08vyjdvVJY3T26j/v/L8pRGIcnJtyH8sbz1SWNxiWczz/DDeGGH509Pbwjcvt//591nnn+sMOfhhh/7z7rPPP9YYfnSWN59qSiWY0lJSYfnnnnhzeeffwwz/WH50+eqenqcUOcH/8McRn+cyBNBHBCRCKGZCKLZTSSiVbZLDvG8ZZJyCtIxyWo0sI+gWAQQvg3j/KQCBRWDVSsVdNTUysfOkYgcmGhGIMHAQCAUUMEGxpVp37bg0xypLRacyta1QTMPzMjuZb3Vy/mtRhg70K4a8XclOOsssf/H/9WBKgtovRl9qWQy7UPWrsts73///3909mV27tP3v45dlNbKZ3397/9dlcvwl+WHcOc7uls1cd6/W8df+u///r9a5nSWM4pE5/lTCpU3q1+sqbuNarGbwl9KJQ/eQ7iYWQ39kqdWtASxAAAGlAAACr6qQCckkkZdcvW6zhQLMuLKJp+xoqGy/Wqq2us6UAzbJpcwVUEvRtBLEsi+jXn3CxU1VhYZ9rTlP1dwiNFqamce2saX+XZBhMztNn2W2ZTKsn2v2sY5FZb96Zd2TVq+Ebzwp61NTXLVXKU45XJVD3KbKxarbyypddl1NLsNW7/eXs7s7hyxdjMetUErprWeN3DX/ruuZf/7sGBLAAZOaNRXYwAEAAAJcOAAARp5oz+n4Y2QAAAlwAAABJ/jc3VrZZ2O93Kb1bLfO481/7x/dnG5V1Q1KtSu4LOYdi0SeZ5d1m4wmeitJuT3bGuarVpIkSSAE3JJIH8nTCV53qEoxQMieO40R9G8r4JiCRUCK+YmpqwF7ZCqxca7jBMEHOkUjFmKXqPZR5QJ82eSZ+ZLB3YdZc/VaBZVnDUWlsCDrhyPsO0Oz3VpWR8Qh0Nko5Hw8kW5ODofwOpVBahPgWPYj4qtLYx6jaBq6ZHNDJf2LzFKeH0ZNmA5gquSzQnWQ3lGnxyDUsD4fTey+iejq6NmFEZcrOn1tJbWurjno3aMtXjd6ON2cs0hbAZLlyvFqU5JpeMkzYkk3KgWB8dSAOzC8bhskN9vrWQbtbbbNO0w5Y0ugMCBWYY7HbqEBa50RUhrE19QEEJLvM3BAy0KmJd1SIVMXSbElckaYBgbINcRLQGl9lqsbNTwhLRkwpfYnoagtdryyqHqbK7DTvU8MzuoanpmGr/NzPw4olst203crapyKP7bNGqBsJblVTm1rmz/SX3tVPM1yMVPYGgkSJU8ybW/zPp6r+nzzXmWqqeiWz/2Oyt9U8zTzMtVU3bSKMtwURoob/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////uwYKMAD/lpSmsYM3JGgAlwAAABAAABLgAAACAAACXAAAAE////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+P//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+7BApwAP/ABLgAAACE6ACXAAAAEAAAEuAAAAIAAAJcAAAAT/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==",{volume:1,soundEnabled:u().enableSoundFx}),st=/\.comp$/i;let ct=1;const dt=(e,t)=>localStorage.getItem(e+"__"+t)||"",ut=async(e,t,a)=>{await ve.createFile({path:ge(e+"/"+t),file:a,isOverride:!0})},pt=async(e,t,a)=>await ve.getFile({path:ge(e+"/"+t),mode:a}),At=e=>{const{files:t,basePath:a,isLoading:n,emit:l}=e;u();const{t:o}=A(),i=async e=>{const t=`${e.name}.comp`,n=ge(a.value+"/"+t);await ve.createDir({path:n});const l={id:e.id||se(),timeCreated:e.timestamp};await ut(n,"index.json",JSON.stringify(l)),await ut(n,"index.html",e.html),await ut(n,"index.scss",e.style),e.cover&&await ut(n,"cover.base64",e.cover)},r=async e=>{if(!e.meta)throw new Error("item must has meta");const t=ge(a.value+"/"+e.name),n=await pt(t,"index.html"),l=await pt(t,"index.scss");return{id:e.meta.id,name:e.name.replace(st,""),timestamp:e.meta.timeCreated,html:n,style:l,cover:e.meta.cover}};return{handleCreateComponent:async()=>{try{let e=await((e="",a="",n="")=>b({title:e,value:a,placeholder:n,validateFn:e=>{if(t.value.find((t=>t.name===e)))return o("msgs.name_already_exists")}}))(o("actions.add_component"),`Component${ct}`,o("msgs.please_enter_the_nam"));const a=`${e}.comp`;if((e=>{if(console.log(e,t.value),t.value.some((t=>t.name===e)))return window.$message.error("Filename already exists, please rename it!"),!0})(a))return;n.value=!0;const r=he(e||"my-component"),s=se();await i({id:s,name:e,timestamp:Date.now(),html:`<div class="${r}"></div>`,style:`.${r} {\n}\n`}),ct++,l("refresh"),setTimeout((()=>{var e;null==(e=document.querySelector(`.mc-comp-item[data-name="${a}"]`))||e.click()}),100)}finally{n.value=!1}},importComponentAllJson:async e=>{for(let t=0;t<e.length;t++)await i(e[t])},exportComponentAllJson:async e=>{const t=await g("","PageCraftAllComponents");if(!t)return;const a=[];for(let n=0;n<e.length;n++)a.push(await r(e[n]));window.$mcUtils.handleExportFile(t,JSON.stringify(a,null,2),".json")},importComponentJson:i,exportComponentJson:r}},mt=()=>{const e=u(),t=async t=>{if(!e.curCompInStore)return dt(m.DEFAULT_CANVAS,t);const{path:a}=e.curCompInStore;return await pt(a,t)},a=async(t,a)=>{if(!e.curCompInStore)return n=m.DEFAULT_CANVAS,l=t,o=a,localStorage.setItem(n+"__"+l,o);var n,l,o;const{path:i}=e.curCompInStore;return await ve.writeFile({path:ge(i+"/"+t),file:a})};return{openComponent:(t,a)=>{e.curCompInStore=((e,t)=>{if(!e.meta)throw new Error("item has no meta");return{id:e.meta.id,title:e.name.replace(st,""),path:t,basePath:e.basePath}})(t,a)},loadCurCompHtml:async()=>await t("index.html"),saveCurCompHtml:async e=>await a("index.html",e),loadCurCompStyle:async()=>await t("index.scss"),saveCurCompStyle:async e=>await a("index.scss",e)}},gt=e=>{const t=p("component_is_migrated_v2",!1),a=i(!1),n=async()=>{if(t.value||a.value)return;a.value=!0;const n=(JSON.parse(localStorage.getItem(m.COMP_INDEX_LIST)||"null")||[]).map((({name:e})=>((e,t={})=>new v({blockType:h.COMPONENT,title:e,data:new y(t)}))(e,JSON.parse(dt(m.COMP_META,e)||"{}"))));for(let e=0;e<n.length;e++){const t=n[e],{title:a,data:{timestamp:l,stared:o,cover:i}}=t,r=ge((o?"/@Migrated/Stared":"/@Migrated")+"/"+`${a}.comp`),s={id:se(),timeCreated:l};await ut(r,"index.json",JSON.stringify(s)),await ut(r,"index.html",dt(m.COMP_HTML,a)),await ut(r,"index.scss",dt(m.COMP_STYLE,a)),i&&await ut(r,"cover.base64",i)}t.value=!0,e("refresh")};r((async()=>{await n()}))},vt={indent_size:"2",indent_char:" ",max_preserve_newlines:"1",preserve_newlines:!0,keep_array_indentation:!1,break_chained_methods:!1,indent_scripts:"normal",brace_style:"collapse",space_before_conditional:!0,unescape_strings:!1,jslint_happy:!1,end_with_newline:!1,wrap_line_length:"110",indent_inner_html:!1,comma_first:!1,e4x:!1,indent_empty_lines:!1},ht=e=>window.html_beautify(e,vt),yt=(e,t={})=>window.css_beautify(e,vt),bt=async(e,t)=>{const{html:a,style:n}=e,{isInline:l=!1,inlineWithStyleTag:o=!1}=t||{};let i="";l&&(i+="-inline",o&&(i+="-with-style-tag"));let r=await g(e.name?e.name+i:"");const s=n?yt(await f(n)):"";let c;l?(c=window.$juice(`<style>${s}</style>\n${a}`),o&&(c=`<style>${s}</style>${c}`),c=ht(c)):c=`<!doctype html>\n<html>\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport"\n        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">\n  <meta http-equiv="X-UA-Compatible" content="ie=edge">\n  <title>${r}</title>\n  <style>\n    ${s}\n  </style>\n</head>\n<body>\n${a}\n</body>\n</html>\n`,w(r,c,".html")},ft=async(e,t=2)=>{const{html:a,style:n}=e,l=await g(e.name),o=`\n<style lang="scss" scoped>\n${n}\n</style>\n`;let i="";i=3===t?`<script lang="ts">\nimport {defineComponent} from 'vue'\n\nexport default defineComponent({\n  name: '${l}',\n})\n<\/script>\n\n<template>\n${a}\n</template>\n\n${o}\n`:`<template>\n${a}\n</template>\n\n<script>\nexport default {\n  name: '${l}',\n}\n<\/script>\n\n${o}\n`,i.trim(),w(l,i,".vue")},wt=e=>new Promise(((t,a)=>{const n=new FileReader;n.onload=()=>{t(n.result)},n.onerror=e=>{a(e)},n.readAsDataURL(e)})),St={key:0,class:"mc-indicator-info font-code"},Ct=D(a({__name:"IndicatorInfo",props:{parentClass:{default:S}},setup(e){const t=e,{parentClass:a}=C(t),s=i(null);r((()=>{a.value&&(s.value=document.querySelector(a.value))}));const{x:c,y:d}=k({type:"client"}),{element:u}=E({x:c,y:d}),p=x(T(u)),A=_((()=>!(s.value&&!s.value.contains(u.value)||s.value===u.value))),m=_((()=>u.value&&A.value?{display:"block",width:`${p.width}px`,height:`${p.height}px`,left:`${p.left}px`,top:`${p.top}px`,transition:"all 0.05s linear"}:{display:"none"})),g=_((()=>{if(u.value&&A.value){let e=`${u.value.localName}`,t=u.value.className||"";return"string"!=typeof t&&(console.warn("className",t),t=""),t=t.trim().split(" ").join("."),t&&(e+=`.${t}`),e}return""}));return(e,t)=>(n(),l(P,null,[g.value?(n(),l("div",St,M(g.value),1)):L("",!0),o("div",{style:R(m.value),class:"mc-indicator-box"},null,4)],64))}}),[["__scopeId","data-v-71bd0335"]]),kt=(e="my_channel",t)=>{const a=H();return r((()=>{const n=new BroadcastChannel(e);t&&(n.onmessage=e=>{t(e)}),a.value=n})),O((()=>{a.value&&a.value.close()})),{channelRef:a}},Et=["img","iframe","video","audio","source","track","embed","object","picture","script","link"],xt=(e,t)=>{const{innerText:a="",className:n=""}=t||{},l=a||"",o=e.data.tag,i=document.createElement(o);return Et.includes(o)?(["audio","video"].includes(o)&&(i.controls=!0),i.src=l):"input"===o?i.setAttribute("placeholder",l):["br","hr"].includes(o)||(i.innerHTML=l),n&&(i.className=n),i},Tt=async e=>{const t=await navigator.clipboard.readText();return"src"in e?e.src=t:e.innerHTML=t,t},_t=(e,t=0)=>({label:e,key:e,type:ue.INPUT,props:{clearable:!0,type:t>0?"textarea":void 0,rows:t}}),Mt=e=>({label:e,key:e,type:ue.SWITCH,props:{checkedValue:"true"}}),Lt={src:{label:"src",key:"src",type:ue.ADVANCED_INPUT,props:{clearable:!0}},alt:_t("alt"),href:{label:"href",key:"href",type:ue.ADVANCED_INPUT,props:{clearable:!0}},target:{label:"target",key:"target",type:ue.SELECT,options:ce(["_blank","_self","_parent","_top"]),props:{clearable:!0}},rel:{label:"rel",key:"rel",type:ue.SELECT,options:ce(["nofollow noopener noreferrer","nofollow"]),props:{clearable:!0}},poster:{label:"poster",key:"poster",type:ue.ADVANCED_INPUT,props:{clearable:!0}},placeholder:_t("placeholder",1),name:_t("name"),inputType:{label:"type",key:"type",type:ue.SELECT,options:ce(["text","email","number","password","tel","button","submit","checkbox","radio","color","date","datetime","time","datetime-local","month","week","file","image","range","reset","search","url","hidden"]),props:{filterable:!0,clearable:!0}},frameborder:{label:"frameborder",key:"frameborder",type:ue.SELECT,options:ce(["0"]),props:{clearable:!0}},srcdoc:_t("srcdoc",2),required:Mt("required"),disabled:Mt("disabled"),readonly:Mt("readonly"),title:_t("title",1),tabindex:{label:"tabindex",key:"tabindex",type:ue.INPUT_NUMBER},id:_t("id"),className:_t("class"),dir:{label:"dir",key:"dir",type:ue.SELECT,options:ce(["ltr","rtl","auto"]),props:{clearable:!0}},style:_t("style",1)},Rt=e=>"cols"in e?(e.children=e.children.map(Rt),e):Array.isArray(e)?e=e.map(Rt):{...e,key:`customProps.${e.key}`},Pt=(e=[])=>{e=[Lt.className,...e,[Lt.title,Lt.id,Lt.dir],Lt.style];const t=[],a=e=>{"cols"in e?e.children.forEach((e=>a(e))):Array.isArray(e)?e.forEach((e=>a(e))):t.push(e.key)};return e.forEach(a),{getCustomProps:e=>{const a={};return t.forEach((t=>{a[t]=e.getAttribute(t)})),a},updateElement(e,a){t.forEach((t=>{((e,t,a)=>{a?e.getAttribute(t)!==a&&e.setAttribute(t,a):e.removeAttribute(t)})(e,t,a.customProps[t])}))},customFormItems:e}},Dt={a:Pt([Lt.href,[Lt.target,Lt.rel]]),input:Pt([Lt.placeholder,[Lt.inputType,Lt.name,Lt.required,Lt.disabled,Lt.readonly]]),textarea:Pt([[Lt.name,Lt.required,Lt.disabled,Lt.readonly]]),button:Pt([[Lt.disabled,Lt.tabindex]]),video:Pt([Lt.src,Lt.poster]),img:Pt([Lt.src,Lt.alt]),iframe:Pt([Lt.src,Lt.frameborder,Lt.srcdoc])},Ht=Pt();Et.forEach((e=>{Dt[e]||(Dt[e]=Pt([Lt.src]))}));const Ot=e=>{if(!e)return{tagName:"",innerHTML:"",outerHTML:"",customProps:null};const t=Dt[e.tagName.toLowerCase()]||Ht;return{tagName:e.tagName||"",innerHTML:e.innerHTML||"",outerHTML:e.outerHTML||"",customProps:t.getCustomProps(e)}};class Ut{constructor(e){t(this,"currentPosition"),t(this,"currentTarget"),t(this,"preSelectTarget"),t(this,"targetElement"),t(this,"crossX"),this.currentPosition=null,this.currentTarget=null,this.preSelectTarget=null,this.targetElement=e;const a=document.querySelector(".line-helper-x");a||console.error("crossX is not exist!"),this.crossX=a}hideLine(){this.crossX.classList.remove("visible")}drawLine(e){const t=e.target;if(!t)return;const a=this.targetElement,n=this.crossX,l=function(e,t,a){const n=e.getBoundingClientRect(),l=Math.round((n.bottom-n.top)/3);return{top:a<n.top+l,middle:a>=n.top+l&&a<=n.top+2*l,bottom:a>n.top+2*l}}(t,e.clientX,e.clientY),o=t.getBoundingClientRect();if(l.top&&a!==t){if("top"===this.currentPosition&&this.currentTarget===t)return;this.currentPosition="top",this.currentTarget=t,n.style.top=o.top+"px",n.style.left=o.left+"px",n.style.width=o.width+"px",n.style.height="3px",n.classList.add("visible")}else if(l.bottom&&a!==t){if("bottom"===this.currentPosition&&this.currentTarget===t)return;this.currentPosition="bottom",this.currentTarget=t,n.style.top=o.bottom+"px",n.style.left=o.left+"px",n.style.width=o.width+"px",n.style.height="3px",n.classList.add("visible")}else this.currentPosition="middle",this.currentTarget=t,this.preSelectTarget=t,n.style.top=o.top+"px",n.style.left=o.left+"px",n.style.width=o.width+"px",n.style.height=o.height+"px",n.classList.add("visible")}}const Nt=e=>{const{t:t}=A(),{mainPlaygroundRef:a,saveData:n,indicatorOptions:l,copyHtml:o,recordUndo:s}=e,c=U(),d=i(0),p=i(null),m=i(0),g=i(0),v=i(!1),y=i(!1);at((()=>v.value));const b=H();r((()=>{a.value.addEventListener("contextmenu",F),a.value.addEventListener("pointerdown",E),a.value.addEventListener("pointerup",x),b.value=new Ut(a.value)})),O((()=>{a.value.removeEventListener("contextmenu",F),a.value.removeEventListener("pointerdown",E),a.value.removeEventListener("pointerup",x)}));const f=i(null),w=i(null),S=i(!1),C=i();$(C,(e=>{S.value&&setTimeout((()=>{S.value=!1}))}));const k=i(!1),E=e=>{2!==e.button&&(k.value=!0,window.getSelection().removeAllRanges())},x=e=>{if(!k.value)return;const t=window.getSelection();if(f.value=t,!t)return;if(!t.toString())return;let a=t.getRangeAt(0).getBoundingClientRect();w.value={top:`calc(${a.top}px + ${a.height}px + 2px)`,left:`calc(${a.left}px + calc(${a.width}px / 2) - 110px)`},S.value=!0,k.value=!1},T=[...["b","i","u","del","code","mark","kbd","a","sup","sub","small","big","span","div","br"].map((e=>({label:e,onClick:()=>{s();const t=document.createElement(e);"br"===e?(e=>{try{if(window.getSelection){const t=window.getSelection();if(t){const a=t.getRangeAt(0);a.collapse(!1),a.insertNode(e)}}}catch(t){window.$message.error(t.message),console.error(t)}})(t):(e=>{try{if(window.getSelection){const t=window.getSelection();t&&t.rangeCount&&(t.getRangeAt(0).cloneRange().surroundContents(e),t.removeAllRanges())}}catch(t){window.$message.error(t.message),console.error(t)}})(t),n(),V()}})))],M=async(e,t="beforeend",a)=>{s(),a||(a=await navigator.clipboard.readText()),e.insertAdjacentHTML(t,a),n(),V()},L=(e,t="append",a)=>{s(),a||(a=xt(c.currentBlock,c)),e[t](a),n(),V()},{editingNode:R,nodeAction:P,handleContextmenu:D,...N}=(e=>{const t=i([]),a=i(!1),n=i(0),l=i(0),o=i(null),r=(e,t)=>{o.value=e,t()};return{editingNode:o,nodeAction:r,rightMenuOptions:t,showRightMenu:a,xRef:n,yRef:l,handleSelectContextmenu:()=>{a.value=!1},handleClickOutside:()=>{a.value=!1,r(null,(()=>{}))},handleContextmenu(o,i){t.value=e(i),a.value=!0,n.value=o.clientX,l.value=o.clientY,o.preventDefault()}}})((e=>{const l=e.target;if(!l)return[];const i=l===a.value,r={label:"✏️ "+t("actions.edit_element"),props:{onClick:async()=>{P(l,(()=>{v.value=!0,y.value=i}))}}},d=i?[r]:[r,{label:`📄 ${t("actions.copy")} HTML`,props:{onClick:async()=>{o(l)}}},{label:"✂️ "+t("actions.cut"),props:{onClick:async()=>{var e;de(l.outerHTML),s(),null==(e=l.parentNode)||e.removeChild(l),n(),q()}}},{label:"❌ "+t("actions.remove_element"),props:{onClick:async()=>{var e;s(),null==(e=l.parentNode)||e.removeChild(l),n(),q()}}}];return[c.currentBlock.blockType===h.HTML_ELEMENT&&{label:`➕ ${t("actions.insert")} ${c.currentBlock.title}`,children:i?void 0:["before","prepend","append","after"].map((e=>({label:`${t("actions.insert")} ${e}`,props:{onClick:async()=>{L(l,e)}}}))),props:{onClick:async()=>{L(l),N.showRightMenu.value=!1}}},...d,{label:`📃 ${t("actions.paste")} outerHTML`,children:i?void 0:["beforebegin","afterbegin","beforeend","afterend"].map((e=>({label:`${t("actions.paste_at")} ${e}`,props:{onClick:async()=>{await M(l,e)}}}))),props:{onClick:async()=>{await M(l),N.showRightMenu.value=!1}}},{label:"🎈 "+t("actions.paste_replace_value"),props:{onClick:async()=>{await(async e=>{s(),await Tt(e),n(),V()})(l),N.showRightMenu.value=!1}}},{type:"divider",label:"d10"},{label:"💻 "+t("actions.print_to_console"),props:{onClick:async()=>{console.log(e.target)}}}].filter(Boolean)})),F=e=>{var t;const a=null==(t=f.value)?void 0:t.toString();!l.enableRightClick||a||e.ctrlKey||(e.preventDefault(),c.currentBlock.actionType===I.DEBUG&&console.log("[handleContextMenu]",e),D(e,e))},j=_((()=>l.enableSelection||c.currentBlock.actionType===I.DEBUG||c.currentBlock.actionType===I.PASTE_REPLACE)),{play:V}=(()=>{const e=u(),{play:t}=je(Ye,{volume:1,soundEnabled:e.enableSoundFx,sprite:{id_0:[0,300],id_1:[420,300],id_2:[900,300],id_3:[1420,300]}});return{play:()=>t({id:`id_${Math.floor(4*Math.random())}`})}})(),{play:q}=(()=>{const e=u(),{play:t}=je(Ge,{volume:1,soundEnabled:e.enableSoundFx,sprite:{id_0:[0,400],id_1:[400,500],id_2:[900,400],id_3:[1400,600]}});return{play:()=>t({id:`id_${Math.floor(4*Math.random())}`})}})(),W=async(e,t,l)=>{t||(t=c.currentBlock),t.actionType!==I.CURSOR&&t.actionType!==I.DEBUG&&t.actionType!==I.DRAG&&s(),l=l||c,await(async(e,t,a,n)=>{let l=t.target||n.value;if(e.blockType===h.ACTIONS){if(e.actionType===I.PASTE_REPLACE)return void(await Tt(l));if(e.actionType===I.DEBUG){console.log("[event]",t);const e=t.target;for(var o=e.previousSibling;o&&1!==o.nodeType;)o=o.previousSibling;for(var i=e.nextSibling;i&&1!==i.nodeType;)i=i.nextSibling;return console.log({sibling1:o,sibling2:i}),void console.log("[targetEl]",l)}if(e.actionType===I.DELETE){if(l===n.value)return;l.parentNode.removeChild(l)}}else if(e.blockType===h.HTML_ELEMENT){const t=xt(e,a);l.appendChild(t)}})(t,e,l,a),t.actionType===I.DELETE?q():t.actionType!==I.DEBUG&&t.actionType!==I.CURSOR&&V(),n()},Y=()=>{clearInterval(p.value),d.value=0,m.value=0,g.value=0},G=_((()=>(d.value/300*100).toFixed(2))),X=H(null),J=i(null);return{isSelectMode:j,handleBlockClick:W,handleMouseDown:e=>{if(!c.selecting&&0===e.button){if(c.currentBlock.actionType===I.DELETE)return Y(),p.value=setInterval((()=>{if(d.value>300)return Y(),void W(e);d.value+=50}),50),m.value=e.x,g.value=e.y,void e.preventDefault();X.value=null,c.currentBlock.actionType!==I.DRAG?W(e):e.target&&(X.value=e.target,X.value.draggable=!0)}},handleMouseUp:e=>{c.currentBlock.actionType===I.DELETE&&Y(),X.value&&(X.value.draggable=!1,X.value.removeAttribute("draggable"))},handleDragOver:e=>{b.value.drawLine(e)},handleDragLeave:e=>{b.value.hideLine()},handleDrop:async e=>{var t;b.value.hideLine();let l=e.target||a.value;const o=b.value.currentPosition,i=async e=>{s(),"top"===o?await M(l,"beforebegin",e):"bottom"===o?await M(l,"afterend",e):await M(l,"beforeend",e),n(),V()};if(X.value)return X.value.draggable=!1,X.value.removeAttribute("draggable"),await i(X.value.outerHTML),e.ctrlKey||null==(t=X.value.parentNode)||t.removeChild(X.value),void(X.value=null);const r=window.$draggingComponentExportData;if(r)return window.$draggingComponentExportData=null,await i(r.html),void z.emit(B.ON_ADD_STYLE,{code:r.style,isAppend:!0});const d=e.dataTransfer.getData("data-block");if(!d)return console.warn("drag item must be a BlockItem",e),void window.$message.warning("drag item not supported");const u=JSON.parse(d);if(u.blockType===h.HTML_ELEMENT){const e=xt(u,c);L(l,"top"===o?"before":"bottom"===o?"after":"appendChild",e)}else console.warn("block is unable to insert",u)},waitingProgress:G,cursorX:m,cursorY:g,contextMenuEtc:N,selectionActionStyle:w,selectionElRef:C,isShowSelectionAction:S,selectionPopupOptions:T,isShowElementEdit:v,editingNode:R,isEditingRoot:y,updateEditingElement:({el:e,data:t})=>{if(!e)return;s(),((e,t)=>{if(!t.customProps)return void console.error("[updateHtmlElement] data.customProps is not exist!");if(e.outerHTML!==t.outerHTML?e.outerHTML=t.outerHTML:e.innerHTML!==t.innerHTML&&(e.innerHTML=t.innerHTML),!e.outerHTML)return void console.warn("[updateHtmlElement] data.outerHTML is empty!");const a=Dt[null==e?void 0:e.tagName.toLowerCase()]||Ht;a&&a.updateElement(e,t)})(e,t);const a=J.value;"function"==typeof a&&a(),n()}}};class It{constructor(e=10){t(this,"undoStack",[]),t(this,"redoStack",[]),t(this,"maxStackSize",100),this.maxStackSize=e}get lastUndo(){return this.undoStack[this.undoStack.length-1]||null}get lastRedo(){return this.redoStack[this.redoStack.length-1]||null}recordUndo(e){this.lastRedo!==e&&(this.undoStack.push(e),this.undoStack.length>this.maxStackSize&&this.undoStack.shift(),this.redoStack=[])}undo(e){return this.undoStack.length>0?(this.redoStack.push(e),this.undoStack.pop()):null}redo(e){return this.redoStack.length>0?(this.undoStack.push(e),this.redoStack.pop()):null}clear(){this.undoStack=[],this.redoStack=[]}getCount(){return this.undoStack.length+this.redoStack.length}}const $t=e=>{const{t:t}=A(),{mainPlaygroundRef:a,emit:n}=e;U();const l=u(),o=i(!1),{loadCurCompHtml:s,saveCurCompHtml:c,saveCurCompStyle:m,loadCurCompStyle:g}=mt(),v=i(new It(10));Ae((()=>v.value.getCount()>0));const{play:h}=(()=>{const e=u();return je(Ke,{volume:1,soundEnabled:e.enableSoundFx})})(),{play:y}=it();r((()=>{E(),z.on(B.SYNC_STORAGE_DATA,w),z.on(B.IMPORT_SUCCESS,E)})),O((()=>{z.off(B.SYNC_STORAGE_DATA,w),z.off(B.IMPORT_SUCCESS,E)}));const b=e=>{const n=e?e.outerHTML:a.value.innerHTML;de(ht(n)),window.$message.success(t("msgs.copy_success")),w(),h()},f=i(""),w=async e=>{var t;const n=a.value.innerHTML;await c(n),null==(t=C.value)||t.postMessage(null),e&&e()},S=i(!1),{channelRef:C}=kt("mainPlaygroundUpdate",(e=>{S.value=!0,console.log("[mainPlaygroundUpdate]"),l.$hydrate({runHooks:!0}),E(),N((()=>{S.value=!1}))}));d((()=>l.curCompInStore),(()=>{var e;S.value?console.warn("isSelfUpdating"):(E(),null==(e=C.value)||e.postMessage(null))}));const k=(e="")=>{a.value&&(a.value.innerHTML=e)},E=async()=>{const e=await s();k(e),v.value.clear(),y()},x=p(F.VARIABLES_STYLE,""),T=async({insertVariableCode:e=!0}={})=>{var t;await j();const a=await s()||"";let n=await g();e&&(n=x.value+n);return{name:(null==(t=l.curCompInStore)?void 0:t.title)||"",html:ht(a),style:yt(n),timestamp:Date.now()}},_=e=>{L(),k(e),w(),y()},M=[{label:`📤 ${t("actions.export")}`,children:[{label:`💚 ${t("actions.export")} Vue 2 SFC`,props:{onClick:async()=>{await ft(await T({insertVariableCode:!1}))}}},{label:`💚 ${t("actions.export")} Vue 3 SFC`,props:{onClick:async()=>{await ft(await T({insertVariableCode:!1}),3)}}},{label:`📑 ${t("actions.export")} HTML`,props:{onClick:async()=>{bt(await T())}}},{label:`📧 ${t("actions.export")} Email HTML`,props:{onClick:async()=>{bt(await T(),{isInline:!0})}}},{label:`📧 ${t("actions.export")} Email HTML (With Style Tag)`,props:{onClick:async()=>{bt(await T(),{isInline:!0,inlineWithStyleTag:!0})}}}]},{type:"divider",label:"d0"},{label:`📄 ${t("actions.paste")} HTML...`,props:{onClick:async()=>{o.value=!0}}},{label:`📄 ${t("actions.copy")} HTML`,props:{onClick:async()=>{b()}}},{type:"divider",label:"d1"},{label:"❌ "+t("actions.clear_all_html"),props:{onClick:async()=>{window.$dialog.warning({title:t("actions.confirm"),content:t("msgs.confirm_clear_curren"),positiveText:t("actions.ok"),negativeText:t("actions.cancel"),onPositiveClick:()=>{_(""),z.emit(B.IMPORT_SUCCESS,""),window.$message.success(t("actions.done")+"!")},onNegativeClick:()=>{}})}}}];me((async()=>{bt(await T())}));const L=()=>{const e=a.value.innerHTML;v.value.recordUndo(e)},{play:R}=(()=>{const e=u();return je(et,{volume:1,soundEnabled:e.enableSoundFx})})(),{play:P}=(()=>{const e=u();return je(tt,{volume:1,soundEnabled:e.enableSoundFx})})();return{htmlMenuOptions:M,isShowImportDialog:o,setPlaygroundHtml:k,pasteHtmlText:f,handleImportHtml:_,saveData:w,copyHtml:b,undoRedo:v,recordUndo:L,handleUndo:()=>{if(!v.value.undoStack.length)return;R();const e=a.value.innerHTML,t=v.value.undo(e);k(t),w()},handleRedo:()=>{if(!v.value.redoStack.length)return;P();const e=a.value.innerHTML,t=v.value.redo(e);k(t),w()}}},zt=a({name:"ElementEditDialog",components:{AutoFormNaive:pe,ViewPortWindow:be},props:{editingNode:{type:Object,default:null},visible:{type:Boolean,default:!1},isRoot:{type:Boolean,default:!1}},emits:["onSave","update:visible"],setup(e,{emit:t}){const{isRoot:a,editingNode:n}=C(e),l=ye(e,t,"visible"),o=i(!0),r=i(),s=i(Ot(null)),c=i({}),u=i([]);d(l,(e=>{e?p():(s.value=Ot(null),u.value=[])})),d(n,(e=>{p()}));const p=()=>{var e;s.value=Ot(n.value),u.value=(e=n.value)?(Dt[null==e?void 0:e.tagName.toLowerCase()]||Ht).customFormItems.map(Rt):[],a.value&&(o.value=!0)},A=_((()=>a.value?[{type:ue.MONACO_EDITOR,key:"innerHTML",label:"innerHTML"}]:o.value?[...u.value,{label:"innerHTML",key:"innerHTML",type:ue.MONACO_EDITOR}]:[{label:"outerHTML",key:"outerHTML",type:ue.MONACO_EDITOR}]));return{mVisible:l,dataForm:s,autoFormRef:r,formRules:c,formItems:A,handleResize:()=>{window.dispatchEvent(new Event("resize"))},handleSubmit:()=>{t("onSave",{el:n.value,data:s.value}),l.value=!1},handleCancel:()=>{l.value=!1},isEditInnerHTML:o}}}),Bt={class:"action-row vp-bg"},Ft={type:"submit",class:"vp-button primary"};const jt=a({name:"MainPlayground",components:{VueMonaco:Se,FileChooser:re,IndicatorInfo:Ct,ElementEditDialog:D(zt,[["render",function(e,t,a,l,i,r){const s=fe,c=X,d=V("AutoFormNaive"),u=V("ViewPortWindow");return n(),q(u,{visible:e.mVisible,"onUpdate:visible":t[3]||(t[3]=t=>e.mVisible=t),"allow-maximum":"",wid:"element_editor",onResize:e.handleResize,"init-win-options":{width:"400px",height:"500px"}},{titleBarLeft:W((()=>[Y(M(`${e.$t("actions.edit_element")} <${e.dataForm.tagName}>`),1)])),titleBarRightControls:W((()=>[o("button",{onClick:t[0]||(t[0]=(...t)=>e.autoFormRef.submitForm&&e.autoFormRef.submitForm(...t))},M(e.$t("actions.ok")),1)])),default:W((()=>[G(d,{ref:"autoFormRef","form-schema":{model:e.dataForm,rules:e.formRules,props:{labelPosition:"top"},formItems:e.formItems},onOnSubmit:e.handleSubmit,class:"element-edit-form font-code","hide-actions":""},{default:W((()=>[o("div",Bt,[G(s,{value:e.isEditInnerHTML,"onUpdate:value":t[1]||(t[1]=t=>e.isEditInnerHTML=t),title:`${e.$t("actions.toggle")} innerHTML/outerHTML`,disabled:e.isRoot},{checked:W((()=>[Y(" innerHTML ")])),unchecked:W((()=>[Y(" outerHTML ")])),_:1},8,["value","title","disabled"]),G(c,{size:"small"},{default:W((()=>[o("button",{type:"button",class:"vp-button",onClick:t[2]||(t[2]=(...t)=>e.handleCancel&&e.handleCancel(...t))},M(e.$t("actions.cancel")),1),o("button",Ft,M(e.$t("actions.ok")),1)])),_:1})])])),_:1},8,["form-schema","onOnSubmit"])])),_:1},8,["visible","onResize"])}],["__scopeId","data-v-98e4979d"]]),ArrowUndo20Filled:De,ArrowRedo20Filled:Le,Settings20Regular:Fe,Code20Filled:Ue,QuestionCircle20Regular:$e},setup(e,{emit:t}){const a=Z(),n=K(),l=i(),o=U(),r=u(),s=_((()=>"PlaygroundPage"===n.name)),{htmlMenuOptions:c,isShowImportDialog:p,setPlaygroundHtml:g,pasteHtmlText:v,handleImportHtml:y,saveData:b,copyHtml:f,undoRedo:w,recordUndo:C,handleUndo:k,handleRedo:E}=$t({mainPlaygroundRef:l,emit:t}),{indicatorOptions:T,mainCanvasClass:M,toggleList:L,backgroundStyle:R}=(()=>{const{t:e}=A(),t=U();rt();const a=i(!1),{channelRef:n}=kt("indicatorUpdate",(e=>{a.value=!0,Object.assign(l,e.data),N((()=>{a.value=!1}))})),l=x(JSON.parse(localStorage.getItem(m.INDICATOR_OPTIONS)||"null")||{enableDevHelpClass:!0,enableExpand:!0,enableSelection:!0,fullWidth:!1,bgDark:!1,bgTransparentPercent:100,centeredElementsY:!1,centeredElementsX:!1,showStyleEditor:!1,contentEditable:!1,enableRightClick:!0});d(l,(()=>{var e;if(a.value)return void console.warn("isSelfUpdating");const t={...l};localStorage.setItem(m.INDICATOR_OPTIONS,JSON.stringify(t)),null==(e=n.value)||e.postMessage(t)}),{deep:!0});const o=e=>{e.preventDefault(),window.$message.warning("Prevent link click")};d((()=>t.currentBlock),(e=>{console.log(e.actionType);const t=`${S} a`;e.actionType!==I.CURSOR?document.querySelectorAll(t).forEach((e=>{e.addEventListener("click",o)})):setTimeout((()=>{document.querySelectorAll(t).forEach((e=>{e.removeEventListener("click",o)}))}),500)}));const r=_((()=>{const e=t.currentBlock;return{"page-craft-mc--dev":l.enableDevHelpClass,"page-craft-mc--cursor-insert":e.blockType!==h.ACTIONS,"page-craft-mc--cursor-pickaxe":e.actionType===I.DELETE,"page-craft-mc--cursor-arrow":!1,"page-craft-mc--cursor-sword":e.actionType===I.DEBUG,"page-craft-mc--cursor-drag":e.actionType===I.DRAG,"page-craft-mc--cursor-oaksign":e.actionType===I.PASTE_REPLACE,"page-craft-mc--expand":l.enableExpand,"page-craft-mc--full-width":l.fullWidth,"page-craft-mc--centered-y":l.centeredElementsY,"page-craft-mc--centered-x":l.centeredElementsX,_dark:l.bgDark}})),s=[{flag:"enableDevHelpClass",title:e("common.outline"),desc:e("msgs.add_1px_outline_per")+" (alt+z)"},{flag:"enableExpand",title:e("common.padding"),desc:e("msgs.pad_each_element_wit")+" (alt+x)"},{flag:"contentEditable",title:e("msgs.content_editable"),desc:e("msgs.enable_html_contente")},{flag:"enableSelection",title:e("msgs.enable_hover"),desc:e("msgs.add_cursor_hover_loc")},{flag:"enableRightClick",title:e("msgs.enable_right_click"),desc:""},{flag:"centeredElementsY",title:e("msgs.centered")+" Y",desc:""},{flag:"centeredElementsX",title:e("msgs.centered")+" X",desc:""},{flag:"fullWidth",title:e("msgs.full_width"),desc:""},{flag:"bgDark",title:e("msgs.dark_bg"),desc:""}],c=_((()=>l.bgDark?{backgroundColor:`rgba(30, 30, 30,${l.bgTransparentPercent/100})`}:{backgroundColor:`rgba(255,255,255,${l.bgTransparentPercent/100})`}));return{indicatorOptions:l,mainCanvasClass:r,toggleList:s,backgroundStyle:c}})(),{isSelectMode:P,handleMouseDown:D,handleMouseUp:H,handleDragOver:O,handleDragLeave:$,handleDrop:z,waitingProgress:B,cursorX:F,cursorY:j,contextMenuEtc:V,selectionActionStyle:q,selectionElRef:W,isShowSelectionAction:Y,selectionPopupOptions:G,isShowElementEdit:X,editingNode:ee,isEditingRoot:te,updateEditingElement:ae}=Nt({mainPlaygroundRef:l,saveData:b,indicatorOptions:T,copyHtml:f,recordUndo:C});J(document,"keydown",(e=>{const t=e.key.toLowerCase();e.altKey&&"x"===t?T.enableExpand=!T.enableExpand:e.altKey&&"z"===t&&(T.enableDevHelpClass=!T.enableDevHelpClass)}));return{mainStore:o,settingsStore:r,mainPlaygroundRef:l,indicatorOptions:T,BlockType:I,toggleList:L,handleMouseDown:D,handleMouseUp:H,handleDragOver:O,handleDragLeave:$,handleDrop:z,waitingProgress:B,cursorX:F,cursorY:j,mainCanvasClass:M,htmlMenuOptions:c,isShowImportDialog:p,setPlaygroundHtml:g,pasteHtmlText:v,handleImportHtml:y,selectionActionStyle:q,selectionElRef:W,isShowSelectionAction:Y,selectionPopupOptions:G,...V,undoRedo:w,handleUndo:k,handleRedo:E,isShowElementEdit:X,editingNode:ee,isEditingRoot:te,updateEditingElement:ae,backgroundStyle:R,listenShortcuts:e=>{const t=e.key.toLowerCase();e.ctrlKey&&e.shiftKey&&"z"===t?E():e.ctrlKey&&"z"===t&&k()},openPlayground:()=>{const e=a.resolve({name:"PlaygroundPage"}).href;console.log(e),window.__TAURI__?new Q("theUniqueLabel",{url:e}):window.open(e)},isSelectMode:P,isLitePage:s}}}),Vt=["onClick"],qt={style:{display:"flex","align-items":"center"}},Wt={style:{"font-size":"14px"}},Yt={key:1,style:{"border-right":"1px solid",opacity:"0.3"}},Gt=["contenteditable"],Xt=o("div",{class:"line-helper-x"},null,-1);const Jt=D(jt,[["render",function(e,t,a,i,r,s){const c=V("IndicatorInfo"),d=Ce,u=V("VueMonaco"),p=oe,A=V("ElementEditDialog"),m=V("Code20Filled"),g=ke,v=ie,h=V("Settings20Regular"),y=Ee,b=V("QuestionCircle20Regular"),f=xe,w=we,S=X,C=V("ArrowUndo20Filled"),k=V("ArrowRedo20Filled"),E=Te,x=V("portal");return n(),l("div",{tabindex:"0",onKeyup:t[13]||(t[13]=(...t)=>e.listenShortcuts&&e.listenShortcuts(...t)),class:"page-craft-mc-wrap"},[e.isSelectMode?(n(),q(c,{key:0})):L("",!0),G(te,{name:"mc-fade"},{default:W((()=>[e.isShowSelectionAction?(n(),l("div",{key:0,ref:"selectionElRef",class:"selection-action",style:R(e.selectionActionStyle),onClick:t[0]||(t[0]=t=>e.isShowSelectionAction=!1)},[(n(!0),l(P,null,ee(e.selectionPopupOptions,(e=>(n(),l("button",{key:e.label,onClick:e.onClick,class:"btn-no-style font-code"},M(e.label),9,Vt)))),128))],4)):L("",!0)])),_:1}),G(d,{size:"small",trigger:"manual",placement:"bottom-start",show:e.showRightMenu,options:e.rightMenuOptions,x:e.xRef,y:e.yRef,onSelect:e.handleSelectContextmenu,"key-field":"label","on-clickoutside":e.handleClickOutside,animated:!1},null,8,["show","options","x","y","onSelect","on-clickoutside"]),G(p,{show:e.isShowImportDialog,"onUpdate:show":t[2]||(t[2]=t=>e.isShowImportDialog=t),"negative-text":e.$t("actions.cancel"),"positive-text":e.$t("actions.import"),preset:"dialog",title:`${e.$t("actions.paste")} HTML`,onPositiveClick:t[3]||(t[3]=t=>e.handleImportHtml(e.pasteHtmlText)),style:{width:"600px"}},{default:W((()=>[e.isShowImportDialog?(n(),q(u,{key:0,modelValue:e.pasteHtmlText,"onUpdate:modelValue":t[1]||(t[1]=t=>e.pasteHtmlText=t),style:{height:"500px"}},null,8,["modelValue"])):L("",!0)])),_:1},8,["show","negative-text","positive-text","title"]),(n(),q(ae,{to:".page-craft-root"},[G(A,{visible:e.isShowElementEdit,"onUpdate:visible":t[4]||(t[4]=t=>e.isShowElementEdit=t),"editing-node":e.editingNode,"is-root":e.isEditingRoot,onOnSave:e.updateEditingElement},null,8,["visible","editing-node","is-root","onOnSave"])])),G(x,{to:"indicatorBarTeleportDest"},{default:W((()=>[e.isLitePage?L("",!0):(n(),l(P,{key:0},[G(d,{options:e.htmlMenuOptions,"key-field":"label",placement:"bottom-start",trigger:"hover"},{default:W((()=>{var t,a;return[G(v,{size:"tiny",title:`${null==(t=e.settingsStore.curCompInStore)?void 0:t.basePath}\n${null==(a=e.settingsStore.curCompInStore)?void 0:a.title}`},{icon:W((()=>[G(g,{size:"18"},{default:W((()=>[G(m)])),_:1})])),default:W((()=>{var t,a;return[Y(" "+M((null==(a=null==(t=e.settingsStore.curCompInStore)?void 0:t.title)?void 0:a.slice(0,10))||"Default"),1)]})),_:1},8,["title"])]})),_:1},8,["options"]),G(f,{duration:100,"show-arrow":!1,trigger:"hover"},{trigger:W((()=>[G(v,{size:"tiny"},{icon:W((()=>[G(g,{size:"18"},{default:W((()=>[G(h)])),_:1})])),default:W((()=>[Y(" "+M(e.$t("common.options")),1)])),_:1})])),header:W((()=>[])),footer:W((()=>[G(S,{align:"center",size:"small"},{default:W((()=>[G(v,{title:"(alt+w)",size:"small",onClick:t[6]||(t[6]=t=>e.mainStore.isShowSettings=!0)},{default:W((()=>[Y(M(e.$t("common.settings")),1)])),_:1}),G(v,{quaternary:"",type:"primary",size:"small",onClick:e.openPlayground},{default:W((()=>[Y(" Playground ")])),_:1},8,["onClick"])])),_:1})])),default:W((()=>[(n(!0),l(P,null,ee(e.toggleList,(t=>(n(),l("div",{key:t.flag,class:"toggle-list"},[o("div",qt,[G(y,{checked:e.indicatorOptions[t.flag],"onUpdate:checked":a=>e.indicatorOptions[t.flag]=a,label:t.title,size:"small"},null,8,["checked","onUpdate:checked","label"]),t.desc?(n(),q(f,{key:0,style:{padding:"0","min-width":"200px"},trigger:"hover"},{trigger:W((()=>[G(g,{size:"16"},{default:W((()=>[G(b)])),_:1})])),default:W((()=>[o("span",Wt,M(t.desc),1)])),_:2},1024)):L("",!0)])])))),128)),G(w,{value:e.indicatorOptions.bgTransparentPercent,"onUpdate:value":t[5]||(t[5]=t=>e.indicatorOptions.bgTransparentPercent=t),step:1},null,8,["value"])])),_:1})],64)),G(E,null,{default:W((()=>[G(v,{size:"tiny",title:"Undo (ctrl+z)",disabled:!e.undoRedo.undoStack.length,onClick:e.handleUndo},{icon:W((()=>[G(g,{size:"18"},{default:W((()=>[G(C)])),_:1})])),_:1},8,["disabled","onClick"]),G(v,{size:"tiny",title:"Redo (ctrl+shift+z)",disabled:!e.undoRedo.redoStack.length,onClick:e.handleRedo},{icon:W((()=>[G(g,{size:"18"},{default:W((()=>[G(k)])),_:1})])),_:1},8,["disabled","onClick"])])),_:1}),e.isLitePage?L("",!0):(n(),l("span",Yt))])),_:1}),o("div",{ref:"mainPlaygroundRef",class:ne([e.mainCanvasClass,"page-craft-mc"]),contenteditable:e.indicatorOptions.contentEditable,onMousedown:t[7]||(t[7]=(...t)=>e.handleMouseDown&&e.handleMouseDown(...t)),onMouseleave:t[8]||(t[8]=(...t)=>e.handleMouseUp&&e.handleMouseUp(...t)),onMouseup:t[9]||(t[9]=(...t)=>e.handleMouseUp&&e.handleMouseUp(...t)),onDragover:t[10]||(t[10]=le(((...t)=>e.handleDragOver&&e.handleDragOver(...t)),["prevent","stop"])),onDragleave:t[11]||(t[11]=le(((...t)=>e.handleDragLeave&&e.handleDragLeave(...t)),["prevent","stop"])),onDrop:t[12]||(t[12]=le(((...t)=>e.handleDrop&&e.handleDrop(...t)),["prevent","stop"])),style:R(e.backgroundStyle)},null,46,Gt),Xt,e.cursorX?(n(),l("div",{key:1,class:"mc-digging-wrap",style:R({top:e.cursorY+"px",left:e.cursorX+"px"})},[o("div",{class:"mc-digging-inner",style:R({width:`${e.waitingProgress}%`,height:`${e.waitingProgress}%`})},null,4)],4)):L("",!0)],32)}]]);export{Jt as M,gt as a,mt as b,ut as c,rt as d,lt as e,wt as f,at as g,ot as h,it as i,nt as j,yt as k,kt as l,st as r,At as u};
