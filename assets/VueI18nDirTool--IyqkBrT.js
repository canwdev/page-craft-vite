import{b as e,c as t,D as n,d as o,e as a,a as r,_ as l,u as i,i as s}from"./file-history-lFNYzMI9.js";import{d,X as c,Y as u,Z as h,$ as f,a0 as v,a1 as p,a2 as g,a3 as y,a4 as b,r as m,a5 as k,a6 as w,a7 as x,m as S,a8 as C,a9 as _,aa as R,ab as T,ac as P,ad as F,ae as A,af as N,ag as $,ah as L,ai as O,aj as D,ak as E,M as B,al as z,am as j,an as I,o as K,ao as M,ap as V,aq as U,ar as H,as as q,at as G,au as W,av as Y,aw as J,w as X,ax as Q,ay as Z,az as ee,aA as te,aB as ne,aC as oe,aD as ae,aE as re,aF as le,aG as ie,aH as se,c as de,x as ce,B as ue,aI as he,g as fe,F as ve,aJ as pe,aK as ge,aL as ye,y as be,z as me,R as ke,A as we,aM as xe,aN as Se,aO as Ce,aP as _e,b as Re,aQ as Te,aR as Pe,l as Fe,aS as Ae,aT as Ne,i as $e,V as Le,aU as Oe,aV as De,C as Ee,e as Be,I as ze,J as je,H as Ie,N as Ke,aW as Me,aX as Ve,P as Ue,aY as He,K as qe,aZ as Ge,a_ as We,G as Ye,a$ as Je,h as Xe,L as Qe,j as Ze,b0 as et,k as tt,U as nt,W as ot,S as at,b1 as rt,D as lt,b2 as it,b3 as st,Q as dt,b4 as ct}from"./index-jDD-Lpv5.js";import{d as ut,_ as ht,u as ft,a as vt,c as pt,b as gt}from"./use-meta-468ENP1I.js";import{_ as yt,a as bt}from"./Tabs-JGL29cox.js";function mt(e){return"string"==typeof e?`s-${e}`:`n-${e}`}const kt=d({name:"Switcher",render:()=>c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},c("path",{d:"M12 8l10 8l-10 8z"}))}),wt=u({name:"Layout",common:h,peers:{Scrollbar:f},self:e=>{const{baseColor:t,textColor2:n,bodyColor:o,cardColor:a,dividerColor:r,actionColor:l,scrollbarColor:i,scrollbarColorHover:s,invertedColor:d}=e;return{textColor:n,textColorInverted:"#FFF",color:o,colorEmbedded:l,headerColor:a,headerColorInverted:d,footerColor:l,footerColorInverted:d,headerBorderColor:r,headerBorderColorInverted:d,footerBorderColor:r,footerBorderColorInverted:d,siderBorderColor:r,siderBorderColorInverted:d,siderColor:a,siderColorInverted:d,siderToggleButtonBorder:`1px solid ${r}`,siderToggleButtonColor:t,siderToggleButtonIconColor:n,siderToggleButtonIconColorInverted:n,siderToggleBarColor:v(o,i),siderToggleBarColorHover:v(o,s),__invertScrollbar:"true"}}}),xt=p("n-layout-sider"),St={type:String,default:"static"},Ct=g("layout","\n color: var(--n-text-color);\n background-color: var(--n-color);\n box-sizing: border-box;\n position: relative;\n z-index: auto;\n flex: auto;\n overflow: hidden;\n transition:\n box-shadow .3s var(--n-bezier),\n background-color .3s var(--n-bezier),\n color .3s var(--n-bezier);\n",[g("layout-scroll-container","\n overflow-x: hidden;\n box-sizing: border-box;\n height: 100%;\n "),y("absolute-positioned","\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n ")]),_t={embedded:Boolean,position:St,nativeScrollbar:{type:Boolean,default:!0},scrollbarProps:Object,onScroll:Function,contentClass:String,contentStyle:{type:[String,Object],default:""},hasSider:Boolean,siderPlacement:{type:String,default:"left"}},Rt=p("n-layout");function Tt(e){return d({name:e?"LayoutContent":"Layout",props:Object.assign(Object.assign({},b.props),_t),setup(e){const t=m(null),n=m(null),{mergedClsPrefixRef:o,inlineThemeDisabled:a}=k(e),r=b("Layout","-layout",Ct,wt,e,o);w(Rt,e);let l=0,i=0;x((()=>{if(e.nativeScrollbar){const e=t.value;e&&(e.scrollTop=i,e.scrollLeft=l)}}));const s={scrollTo:function(o,a){if(e.nativeScrollbar){const{value:e}=t;e&&(void 0===a?e.scrollTo(o):e.scrollTo(o,a))}else{const{value:e}=n;e&&e.scrollTo(o,a)}}},d=S((()=>{const{common:{cubicBezierEaseInOut:t},self:n}=r.value;return{"--n-bezier":t,"--n-color":e.embedded?n.colorEmbedded:n.color,"--n-text-color":n.textColor}})),c=a?C("layout",S((()=>e.embedded?"e":"")),d,e):void 0;return Object.assign({mergedClsPrefix:o,scrollableElRef:t,scrollbarInstRef:n,hasSiderStyle:{display:"flex",flexWrap:"nowrap",width:"100%",flexDirection:"row"},mergedTheme:r,handleNativeElScroll:t=>{var n;const o=t.target;l=o.scrollLeft,i=o.scrollTop,null===(n=e.onScroll)||void 0===n||n.call(e,t)},cssVars:a?void 0:d,themeClass:null==c?void 0:c.themeClass,onRender:null==c?void 0:c.onRender},s)},render(){var t;const{mergedClsPrefix:n,hasSider:o}=this;null===(t=this.onRender)||void 0===t||t.call(this);const a=o?this.hasSiderStyle:void 0,r=[this.themeClass,e&&`${n}-layout-content`,`${n}-layout`,`${n}-layout--${this.position}-positioned`];return c("div",{class:r,style:this.cssVars},this.nativeScrollbar?c("div",{ref:"scrollableElRef",class:[`${n}-layout-scroll-container`,this.contentClass],style:[this.contentStyle,a],onScroll:this.handleNativeElScroll},this.$slots):c(_,Object.assign({},this.scrollbarProps,{onScroll:this.onScroll,ref:"scrollbarInstRef",theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar,contentClass:this.contentClass,contentStyle:[this.contentStyle,a]}),this.$slots))}})}const Pt=Tt(!1),Ft=Tt(!0),At=g("layout-sider","\n flex-shrink: 0;\n box-sizing: border-box;\n position: relative;\n z-index: 1;\n color: var(--n-text-color);\n transition:\n color .3s var(--n-bezier),\n border-color .3s var(--n-bezier),\n min-width .3s var(--n-bezier),\n max-width .3s var(--n-bezier),\n transform .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n background-color: var(--n-color);\n display: flex;\n justify-content: flex-end;\n",[y("bordered",[R("border",'\n content: "";\n position: absolute;\n top: 0;\n bottom: 0;\n width: 1px;\n background-color: var(--n-border-color);\n transition: background-color .3s var(--n-bezier);\n ')]),R("left-placement",[y("bordered",[R("border","\n right: 0;\n ")])]),y("right-placement","\n justify-content: flex-start;\n ",[y("bordered",[R("border","\n left: 0;\n ")]),y("collapsed",[g("layout-toggle-button",[g("base-icon","\n transform: rotate(180deg);\n ")]),g("layout-toggle-bar",[T("&:hover",[R("top",{transform:"rotate(-12deg) scale(1.15) translateY(-2px)"}),R("bottom",{transform:"rotate(12deg) scale(1.15) translateY(2px)"})])])]),g("layout-toggle-button","\n left: 0;\n transform: translateX(-50%) translateY(-50%);\n ",[g("base-icon","\n transform: rotate(0);\n ")]),g("layout-toggle-bar","\n left: -28px;\n transform: rotate(180deg);\n ",[T("&:hover",[R("top",{transform:"rotate(12deg) scale(1.15) translateY(-2px)"}),R("bottom",{transform:"rotate(-12deg) scale(1.15) translateY(2px)"})])])]),y("collapsed",[g("layout-toggle-bar",[T("&:hover",[R("top",{transform:"rotate(-12deg) scale(1.15) translateY(-2px)"}),R("bottom",{transform:"rotate(12deg) scale(1.15) translateY(2px)"})])]),g("layout-toggle-button",[g("base-icon","\n transform: rotate(0);\n ")])]),g("layout-toggle-button","\n transition:\n color .3s var(--n-bezier),\n right .3s var(--n-bezier),\n left .3s var(--n-bezier),\n border-color .3s var(--n-bezier),\n background-color .3s var(--n-bezier);\n cursor: pointer;\n width: 24px;\n height: 24px;\n position: absolute;\n top: 50%;\n right: 0;\n border-radius: 50%;\n display: flex;\n align-items: center;\n justify-content: center;\n font-size: 18px;\n color: var(--n-toggle-button-icon-color);\n border: var(--n-toggle-button-border);\n background-color: var(--n-toggle-button-color);\n box-shadow: 0 2px 4px 0px rgba(0, 0, 0, .06);\n transform: translateX(50%) translateY(-50%);\n z-index: 1;\n ",[g("base-icon","\n transition: transform .3s var(--n-bezier);\n transform: rotate(180deg);\n ")]),g("layout-toggle-bar","\n cursor: pointer;\n height: 72px;\n width: 32px;\n position: absolute;\n top: calc(50% - 36px);\n right: -28px;\n ",[R("top, bottom","\n position: absolute;\n width: 4px;\n border-radius: 2px;\n height: 38px;\n left: 14px;\n transition: \n background-color .3s var(--n-bezier),\n transform .3s var(--n-bezier);\n "),R("bottom","\n position: absolute;\n top: 34px;\n "),T("&:hover",[R("top",{transform:"rotate(12deg) scale(1.15) translateY(-2px)"}),R("bottom",{transform:"rotate(-12deg) scale(1.15) translateY(2px)"})]),R("top, bottom",{backgroundColor:"var(--n-toggle-bar-color)"}),T("&:hover",[R("top, bottom",{backgroundColor:"var(--n-toggle-bar-color-hover)"})])]),R("border","\n position: absolute;\n top: 0;\n right: 0;\n bottom: 0;\n width: 1px;\n transition: background-color .3s var(--n-bezier);\n "),g("layout-sider-scroll-container","\n flex-grow: 1;\n flex-shrink: 0;\n box-sizing: border-box;\n height: 100%;\n opacity: 0;\n transition: opacity .3s var(--n-bezier);\n max-width: 100%;\n "),y("show-content",[g("layout-sider-scroll-container",{opacity:1})]),y("absolute-positioned","\n position: absolute;\n left: 0;\n top: 0;\n bottom: 0;\n ")]),Nt=d({name:"LayoutToggleButton",props:{clsPrefix:{type:String,required:!0},onClick:Function},render(){const{clsPrefix:e}=this;return c("div",{class:`${e}-layout-toggle-button`,onClick:this.onClick},c(P,{clsPrefix:e},{default:()=>c(F,null)}))}}),$t=d({props:{clsPrefix:{type:String,required:!0},onClick:Function},render(){const{clsPrefix:e}=this;return c("div",{onClick:this.onClick,class:`${e}-layout-toggle-bar`},c("div",{class:`${e}-layout-toggle-bar__top`}),c("div",{class:`${e}-layout-toggle-bar__bottom`}))}}),Lt={position:St,bordered:Boolean,collapsedWidth:{type:Number,default:48},width:{type:[Number,String],default:272},contentClass:String,contentStyle:{type:[String,Object],default:""},collapseMode:{type:String,default:"transform"},collapsed:{type:Boolean,default:void 0},defaultCollapsed:Boolean,showCollapsedContent:{type:Boolean,default:!0},showTrigger:{type:[Boolean,String],default:!1},nativeScrollbar:{type:Boolean,default:!0},inverted:Boolean,scrollbarProps:Object,triggerClass:String,triggerStyle:[String,Object],collapsedTriggerClass:String,collapsedTriggerStyle:[String,Object],"onUpdate:collapsed":[Function,Array],onUpdateCollapsed:[Function,Array],onAfterEnter:Function,onAfterLeave:Function,onExpand:[Function,Array],onCollapse:[Function,Array],onScroll:Function},Ot=d({name:"LayoutSider",props:Object.assign(Object.assign({},b.props),Lt),setup(e){const t=A(Rt),n=m(null),o=m(null),a=S((()=>L(s.value?e.collapsedWidth:e.width))),r=S((()=>"transform"!==e.collapseMode?{}:{minWidth:L(e.width)})),l=S((()=>t?t.siderPlacement:"left")),i=m(e.defaultCollapsed),s=N($(e,"collapsed"),i);let d=0,c=0;x((()=>{if(e.nativeScrollbar){const e=n.value;e&&(e.scrollTop=c,e.scrollLeft=d)}})),w(xt,{collapsedRef:s,collapseModeRef:$(e,"collapseMode")});const{mergedClsPrefixRef:u,inlineThemeDisabled:h}=k(e),f=b("Layout","-layout-sider",At,wt,e,u);const v={scrollTo:function(t,a){if(e.nativeScrollbar){const{value:e}=n;e&&(void 0===a?e.scrollTo(t):e.scrollTo(t,a))}else{const{value:e}=o;e&&e.scrollTo(t,a)}}},p=S((()=>{const{common:{cubicBezierEaseInOut:t},self:n}=f.value,{siderToggleButtonColor:o,siderToggleButtonBorder:a,siderToggleBarColor:r,siderToggleBarColorHover:l}=n,i={"--n-bezier":t,"--n-toggle-button-color":o,"--n-toggle-button-border":a,"--n-toggle-bar-color":r,"--n-toggle-bar-color-hover":l};return e.inverted?(i["--n-color"]=n.siderColorInverted,i["--n-text-color"]=n.textColorInverted,i["--n-border-color"]=n.siderBorderColorInverted,i["--n-toggle-button-icon-color"]=n.siderToggleButtonIconColorInverted,i.__invertScrollbar=n.__invertScrollbar):(i["--n-color"]=n.siderColor,i["--n-text-color"]=n.textColor,i["--n-border-color"]=n.siderBorderColor,i["--n-toggle-button-icon-color"]=n.siderToggleButtonIconColor),i})),g=h?C("layout-sider",S((()=>e.inverted?"a":"b")),p,e):void 0;return Object.assign({scrollableElRef:n,scrollbarInstRef:o,mergedClsPrefix:u,mergedTheme:f,styleMaxWidth:a,mergedCollapsed:s,scrollContainerStyle:r,siderPlacement:l,handleNativeElScroll:t=>{var n;const o=t.target;d=o.scrollLeft,c=o.scrollTop,null===(n=e.onScroll)||void 0===n||n.call(e,t)},handleTransitionend:function(t){var n,o;"max-width"===t.propertyName&&(s.value?null===(n=e.onAfterLeave)||void 0===n||n.call(e):null===(o=e.onAfterEnter)||void 0===o||o.call(e))},handleTriggerClick:function(){const{"onUpdate:collapsed":t,onUpdateCollapsed:n,onExpand:o,onCollapse:a}=e,{value:r}=s;n&&O(n,!r),t&&O(t,!r),i.value=!r,r?o&&O(o):a&&O(a)},inlineThemeDisabled:h,cssVars:p,themeClass:null==g?void 0:g.themeClass,onRender:null==g?void 0:g.onRender},v)},render(){var e;const{mergedClsPrefix:t,mergedCollapsed:n,showTrigger:o}=this;return null===(e=this.onRender)||void 0===e||e.call(this),c("aside",{class:[`${t}-layout-sider`,this.themeClass,`${t}-layout-sider--${this.position}-positioned`,`${t}-layout-sider--${this.siderPlacement}-placement`,this.bordered&&`${t}-layout-sider--bordered`,n&&`${t}-layout-sider--collapsed`,(!n||this.showCollapsedContent)&&`${t}-layout-sider--show-content`],onTransitionend:this.handleTransitionend,style:[this.inlineThemeDisabled?void 0:this.cssVars,{maxWidth:this.styleMaxWidth,width:L(this.width)}]},this.nativeScrollbar?c("div",{class:[`${t}-layout-sider-scroll-container`,this.contentClass],onScroll:this.handleNativeElScroll,style:[this.scrollContainerStyle,{overflow:"auto"},this.contentStyle],ref:"scrollableElRef"},this.$slots):c(_,Object.assign({},this.scrollbarProps,{onScroll:this.onScroll,ref:"scrollbarInstRef",style:this.scrollContainerStyle,contentStyle:this.contentStyle,contentClass:this.contentClass,theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar,builtinThemeOverrides:this.inverted&&"true"===this.cssVars.__invertScrollbar?{colorHover:"rgba(255, 255, 255, .4)",color:"rgba(255, 255, 255, .3)"}:void 0}),this.$slots),o?c("bar"===o?$t:Nt,{clsPrefix:t,class:n?this.collapsedTriggerClass:this.triggerClass,style:n?this.collapsedTriggerStyle:this.triggerStyle,onClick:this.handleTriggerClick}):null,this.bordered?c("div",{class:`${t}-layout-sider__border`}):null)}}),Dt=Object.assign(Object.assign({},b.props),{trigger:String,xScrollable:Boolean,onScroll:Function,size:Number}),Et=d({name:"Scrollbar",props:Dt,setup(){const e=m(null),t={scrollTo:(...t)=>{var n;null===(n=e.value)||void 0===n||n.scrollTo(t[0],t[1])},scrollBy:(...t)=>{var n;null===(n=e.value)||void 0===n||n.scrollBy(t[0],t[1])}};return Object.assign(Object.assign({},t),{scrollbarInstRef:e})},render(){return c(_,Object.assign({ref:"scrollbarInstRef"},this.$props),this.$slots)}}),Bt=p("n-tree-select"),zt=p("n-tree"),jt=d({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function,tmNode:{type:Object,required:!0}},setup(e){const{renderSwitcherIconRef:t}=A(zt,null);return()=>{const{clsPrefix:n,expanded:o,hide:a,indent:r,onClick:l}=e;return c("span",{"data-switcher":!0,class:[`${n}-tree-node-switcher`,o&&`${n}-tree-node-switcher--expanded`,a&&`${n}-tree-node-switcher--hide`],style:{width:`${r}px`},onClick:l},c("div",{class:`${n}-tree-node-switcher__icon`},c(D,null,{default:()=>{if(e.loading)return c(E,{clsPrefix:n,key:"loading",radius:85,strokeWidth:20});const{value:o}=t;return o?o({expanded:e.expanded,selected:e.selected,option:e.tmNode.rawNode}):c(P,{clsPrefix:n,key:"switcher"},{default:()=>c(kt,null)})}})))}}}),It=d({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup:e=>({handleUpdateValue:function(t){!function(t){const{onCheck:n}=e;n&&n(t)}(t)},mergedTheme:A(zt).mergedThemeRef}),render(){const{clsPrefix:e,mergedTheme:t,checked:n,indeterminate:o,disabled:a,focusable:r,indent:l,handleUpdateValue:i}=this;return c("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],style:{width:`${l}px`},"data-checkbox":!0},c(B,{focusable:r,disabled:a,theme:t.peers.Checkbox,themeOverrides:t.peerOverrides.Checkbox,checked:n,indeterminate:o,onUpdateChecked:i}))}}),Kt=d({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:t,renderPrefixRef:n,renderSuffixRef:o,labelFieldRef:a}=A(zt);return{selfRef:m(null),renderLabel:t,renderPrefix:n,renderSuffix:o,labelField:a,handleClick:function(t){!function(t){const{onClick:n}=e;n&&n(t)}(t)}}},render(){const{clsPrefix:e,labelField:t,nodeProps:n,checked:o=!1,selected:a=!1,renderLabel:r,renderPrefix:l,renderSuffix:i,handleClick:s,onDragstart:d,tmNode:{rawNode:u,rawNode:{prefix:h,suffix:f,[t]:v}}}=this;return c("span",Object.assign({},n,{ref:"selfRef",class:[`${e}-tree-node-content`,null==n?void 0:n.class],onClick:s,draggable:void 0!==d||void 0,onDragstart:d}),l||h?c("div",{class:`${e}-tree-node-content__prefix`},l?l({option:u,selected:a,checked:o}):z(h)):null,c("div",{class:`${e}-tree-node-content__text`},r?r({option:u,selected:a,checked:o}):z(v)),i||f?c("div",{class:`${e}-tree-node-content__suffix`},i?i({option:u,selected:a,checked:o}):z(f)):null)}});function Mt({position:e,offsetLevel:t,indent:n,el:o}){const a={position:"absolute",boxSizing:"border-box",right:0};if("inside"===e)a.left=0,a.top=0,a.bottom=0,a.borderRadius="inherit",a.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const r="before"===e?"top":"bottom";a[r]=0,a.left=o.offsetLeft+6-t*n+"px",a.height="2px",a.backgroundColor="var(--n-drop-mark-color)",a.transformOrigin=r,a.borderRadius="1px",a.transform="before"===e?"translateY(-4px)":"translateY(4px)"}return c("div",{style:a})}function Vt(e,t){return!!e.rawNode[t]}function Ut(e,t,n,o){null==e||e.forEach((e=>{n(e),Ut(e[t],t,n,o),o(e)}))}function Ht(e,t,n,o,a){const r=new Set,l=new Set,i=[];return Ut(e,o,(e=>{if(i.push(e),a(t,e)){l.add(e[n]);for(let e=i.length-2;e>=0;--e){if(r.has(i[e][n]))return;r.add(i[e][n])}}}),(()=>{i.pop()})),{expandedKeys:Array.from(r),highlightKeySet:l}}if(j&&Image){(new Image).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}const qt=d({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const t=A(zt),{droppingNodeParentRef:n,droppingMouseNodeRef:o,draggingNodeRef:a,droppingPositionRef:r,droppingOffsetLevelRef:l,nodePropsRef:i,indentRef:s,blockLineRef:d,checkboxPlacementRef:u,checkOnClickRef:h,disabledFieldRef:f,showLineRef:v,renderSwitcherIconRef:p,overrideDefaultNodeClickBehaviorRef:g}=t,y=I((()=>!!e.tmNode.rawNode.checkboxDisabled)),b=I((()=>Vt(e.tmNode,f.value))),k=I((()=>t.disabledRef.value||b.value)),w=S((()=>{const{value:t}=i;if(t)return t({option:e.tmNode.rawNode})})),x=m(null),C={value:null};function _(){const n=()=>{const{tmNode:n}=e;if(n.isLeaf||n.shallowLoaded)t.handleSwitcherClick(n);else{if(t.loadingKeysRef.value.has(n.key))return;t.loadingKeysRef.value.add(n.key);const{onLoadRef:{value:e}}=t;e&&e(n.rawNode).then((e=>{!1!==e&&t.handleSwitcherClick(n)})).finally((()=>{t.loadingKeysRef.value.delete(n.key)}))}};p.value?setTimeout(n,0):n()}K((()=>{C.value=x.value.$el}));const R=I((()=>!b.value&&t.selectableRef.value&&(!t.internalTreeSelect||("child"!==t.mergedCheckStrategyRef.value||t.multipleRef.value&&t.cascadeRef.value||e.tmNode.isLeaf)))),T=I((()=>t.checkableRef.value&&(t.cascadeRef.value||"child"!==t.mergedCheckStrategyRef.value||e.tmNode.isLeaf))),P=I((()=>t.displayedCheckedKeysRef.value.includes(e.tmNode.key))),F=I((()=>{const{value:t}=T;if(!t)return!1;const{value:n}=h,{tmNode:o}=e;return"boolean"==typeof n?!o.disabled&&n:n(e.tmNode.rawNode)}));function N(n){var o,a;if(!k.value){const o=g.value;let a=!1;if(o)switch(o({option:e.tmNode.rawNode})){case"toggleCheck":a=!0,$(!P.value);break;case"toggleSelect":a=!0,t.handleSelect(e.tmNode);break;case"toggleExpand":a=!0,_(),a=!0;break;case"none":return a=!0,void(a=!0)}a||function(n){const{value:o}=t.expandOnClickRef,{value:a}=R,{value:r}=F;if(!a&&!o&&!r)return;if(V(n,"checkbox")||V(n,"switcher"))return;const{tmNode:l}=e;a&&t.handleSelect(l),o&&!l.isLeaf&&_(),r&&$(!P.value)}(n)}null===(a=null===(o=w.value)||void 0===o?void 0:o.onClick)||void 0===a||a.call(o,n)}function $(n){t.handleCheck(e.tmNode,n)}const L=S((()=>{const{clsPrefix:t}=e,{value:n}=s;if(v.value){const o=[];let a=e.tmNode.parent;for(;a;)a.isLastChild?o.push(c("div",{class:`${t}-tree-node-indent`},c("div",{style:{width:`${n}px`}}))):o.push(c("div",{class:[`${t}-tree-node-indent`,`${t}-tree-node-indent--show-line`]},c("div",{style:{width:`${n}px`}}))),a=a.parent;return o.reverse()}return M(e.tmNode.level,c("div",{class:`${e.clsPrefix}-tree-node-indent`},c("div",{style:{width:`${n}px`}})))}));return{showDropMark:I((()=>{const{value:t}=a;if(!t)return;const{value:n}=r;if(!n)return;const{value:l}=o;if(!l)return;const{tmNode:i}=e;return i.key===l.key})),showDropMarkAsParent:I((()=>{const{value:t}=n;if(!t)return!1;const{tmNode:o}=e,{value:a}=r;return("before"===a||"after"===a)&&t.key===o.key})),pending:I((()=>t.pendingNodeKeyRef.value===e.tmNode.key)),loading:I((()=>t.loadingKeysRef.value.has(e.tmNode.key))),highlight:I((()=>{var n;return null===(n=t.highlightKeySetRef.value)||void 0===n?void 0:n.has(e.tmNode.key)})),checked:P,indeterminate:I((()=>t.displayedIndeterminateKeysRef.value.includes(e.tmNode.key))),selected:I((()=>t.mergedSelectedKeysRef.value.includes(e.tmNode.key))),expanded:I((()=>t.mergedExpandedKeysRef.value.includes(e.tmNode.key))),disabled:k,checkable:T,mergedCheckOnClick:F,checkboxDisabled:y,selectable:R,expandOnClick:t.expandOnClickRef,internalScrollable:t.internalScrollableRef,draggable:t.draggableRef,blockLine:d,nodeProps:w,checkboxFocusable:t.internalCheckboxFocusableRef,droppingPosition:r,droppingOffsetLevel:l,indent:s,checkboxPlacement:u,showLine:v,contentInstRef:x,contentElRef:C,indentNodes:L,handleCheck:$,handleDrop:function(n){n.preventDefault(),null!==r.value&&t.handleDrop({event:n,node:e.tmNode,dropPosition:r.value})},handleDragStart:function(n){t.handleDragStart({event:n,node:e.tmNode})},handleDragEnter:function(n){n.currentTarget===n.target&&t.handleDragEnter({event:n,node:e.tmNode})},handleDragOver:function(n){n.preventDefault(),t.handleDragOver({event:n,node:e.tmNode})},handleDragEnd:function(n){t.handleDragEnd({event:n,node:e.tmNode})},handleDragLeave:function(n){n.currentTarget===n.target&&t.handleDragLeave({event:n,node:e.tmNode})},handleLineClick:function(e){d.value&&N(e)},handleContentClick:function(e){d.value||N(e)},handleSwitcherClick:_}},render(){const{tmNode:e,clsPrefix:t,checkable:n,expandOnClick:o,selectable:a,selected:r,checked:l,highlight:i,draggable:s,blockLine:d,indent:u,indentNodes:h,disabled:f,pending:v,internalScrollable:p,nodeProps:g,checkboxPlacement:y}=this,b=s&&!f?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,m=p?mt(e.key):void 0,k="right"===y,w=n?c(It,{indent:u,right:k,focusable:this.checkboxFocusable,disabled:f||this.checkboxDisabled,clsPrefix:t,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return c("div",Object.assign({class:`${t}-tree-node-wrapper`},b),c("div",Object.assign({},d?g:void 0,{class:[`${t}-tree-node`,{[`${t}-tree-node--selected`]:r,[`${t}-tree-node--checkable`]:n,[`${t}-tree-node--highlight`]:i,[`${t}-tree-node--pending`]:v,[`${t}-tree-node--disabled`]:f,[`${t}-tree-node--selectable`]:a,[`${t}-tree-node--clickable`]:a||o||this.mergedCheckOnClick},null==g?void 0:g.class],"data-key":m,draggable:s&&d,onClick:this.handleLineClick,onDragstart:s&&d&&!f?this.handleDragStart:void 0}),h,e.isLeaf&&this.showLine?c("div",{class:[`${t}-tree-node-indent`,`${t}-tree-node-indent--show-line`,e.isLeaf&&`${t}-tree-node-indent--is-leaf`,e.isLastChild&&`${t}-tree-node-indent--last-child`]},c("div",{style:{width:`${u}px`}})):c(jt,{clsPrefix:t,expanded:this.expanded,selected:r,loading:this.loading,hide:e.isLeaf,tmNode:this.tmNode,indent:u,onClick:this.handleSwitcherClick}),k?null:w,c(Kt,{ref:"contentInstRef",clsPrefix:t,checked:l,selected:r,onClick:this.handleContentClick,nodeProps:d?void 0:g,onDragstart:!s||d||f?void 0:this.handleDragStart,tmNode:e}),s?this.showDropMark?Mt({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:u}):this.showDropMarkAsParent?Mt({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:u}):null:null,k?w:null))}});const Gt=d({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return c(H,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:"collapse"===this.mode},{default:()=>c("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:U(this.height)}},this.nodes.map((t=>c(qt,{clsPrefix:e,tmNode:t}))))})}}),Wt=W(),Yt=g("tree","\n font-size: var(--n-font-size);\n outline: none;\n",[T("ul, li","\n margin: 0;\n padding: 0;\n list-style: none;\n "),T(">",[g("tree-node",[T("&:first-child","margin-top: 0;")])]),g("tree-motion-wrapper",[y("expand",[q({duration:"0.2s"})]),y("collapse",[q({duration:"0.2s",reverse:!0})])]),g("tree-node-wrapper","\n box-sizing: border-box;\n padding: var(--n-node-wrapper-padding);\n "),g("tree-node","\n transform: translate3d(0,0,0);\n position: relative;\n display: flex;\n border-radius: var(--n-node-border-radius);\n transition: background-color .3s var(--n-bezier);\n ",[y("highlight",[g("tree-node-content",[R("text","border-bottom-color: var(--n-node-text-color-disabled);")])]),y("disabled",[g("tree-node-content","\n color: var(--n-node-text-color-disabled);\n cursor: not-allowed;\n ")]),G("disabled",[y("clickable",[g("tree-node-content","\n cursor: pointer;\n ")])])]),y("block-node",[g("tree-node-content","\n flex: 1;\n min-width: 0;\n ")]),G("block-line",[g("tree-node",[G("disabled",[g("tree-node-content",[T("&:hover","background: var(--n-node-color-hover);")]),y("selectable",[g("tree-node-content",[T("&:active","background: var(--n-node-color-pressed);")])]),y("pending",[g("tree-node-content","\n background: var(--n-node-color-hover);\n ")]),y("selected",[g("tree-node-content","background: var(--n-node-color-active);")])]),y("selected",[g("tree-node-content","background: var(--n-node-color-active);")])])]),y("block-line",[g("tree-node",[G("disabled",[T("&:hover","background: var(--n-node-color-hover);"),y("pending","\n background: var(--n-node-color-hover);\n "),y("selectable",[G("selected",[T("&:active","background: var(--n-node-color-pressed);")])]),y("selected","background: var(--n-node-color-active);")]),y("selected","background: var(--n-node-color-active);"),y("disabled","\n cursor: not-allowed;\n ")])]),g("tree-node-indent","\n flex-grow: 0;\n flex-shrink: 0;\n ",[y("show-line","position: relative",[T("&::before",'\n position: absolute;\n left: 50%;\n border-left: 1px solid var(--n-line-color);\n transition: border-color .3s var(--n-bezier);\n transform: translate(-50%);\n content: "";\n top: var(--n-line-offset-top);\n bottom: var(--n-line-offset-bottom);\n '),y("last-child",[T("&::before","\n bottom: 50%;\n ")]),y("is-leaf",[T("&::after",'\n position: absolute;\n content: "";\n left: calc(50% + 0.5px);\n right: 0;\n bottom: 50%;\n transition: border-color .3s var(--n-bezier);\n border-bottom: 1px solid var(--n-line-color);\n ')])]),G("show-line","height: 0;")]),g("tree-node-switcher","\n cursor: pointer;\n display: inline-flex;\n flex-shrink: 0;\n height: var(--n-node-content-height);\n align-items: center;\n justify-content: center;\n transition: transform .15s var(--n-bezier);\n vertical-align: bottom;\n ",[R("icon","\n position: relative;\n height: 14px;\n width: 14px;\n display: flex;\n color: var(--n-arrow-color);\n transition: color .3s var(--n-bezier);\n font-size: 14px;\n ",[g("icon",[Wt]),g("base-loading","\n color: var(--n-loading-color);\n position: absolute;\n left: 0;\n top: 0;\n right: 0;\n bottom: 0;\n ",[Wt]),g("base-icon",[Wt])]),y("hide","visibility: hidden;"),y("expanded","transform: rotate(90deg);")]),g("tree-node-checkbox","\n display: inline-flex;\n height: var(--n-node-content-height);\n vertical-align: bottom;\n align-items: center;\n justify-content: center;\n "),g("tree-node-content","\n user-select: none;\n position: relative;\n display: inline-flex;\n align-items: center;\n min-height: var(--n-node-content-height);\n box-sizing: border-box;\n line-height: var(--n-line-height);\n vertical-align: bottom;\n padding: 0 6px 0 4px;\n cursor: default;\n border-radius: var(--n-node-border-radius);\n color: var(--n-node-text-color);\n transition:\n color .3s var(--n-bezier),\n background-color .3s var(--n-bezier),\n border-color .3s var(--n-bezier);\n ",[T("&:last-child","margin-bottom: 0;"),R("prefix","\n display: inline-flex;\n margin-right: 8px;\n "),R("text","\n border-bottom: 1px solid #0000;\n transition: border-color .3s var(--n-bezier);\n flex-grow: 1;\n max-width: 100%;\n "),R("suffix","\n display: inline-flex;\n ")]),R("empty","margin: auto;")]);var Jt=function(e,t,n,o){return new(n||(n=Promise))((function(a,r){function l(e){try{s(o.next(e))}catch(t){r(t)}}function i(e){try{s(o.throw(e))}catch(t){r(t)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,i)}s((o=o.apply(e,t||[])).next())}))};const Xt={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array],overrideDefaultNodeClickBehavior:Function},Qt=Object.assign(Object.assign(Object.assign(Object.assign({},b.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,showLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},scrollbarProps:Object,indent:{type:Number,default:24},allowDrop:{type:Function,default:function({dropPosition:e,node:t}){return!1===t.isLeaf||(!!t.children||"inside"!==e)}},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),Xt),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),Zt=d({name:"Tree",props:Qt,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:n,mergedRtlRef:o}=k(e),a=Y("Tree",o,t),r=b("Tree","-tree",Yt,oe,e,t),l=m(null),i=m(null),s=m(null);const d=S((()=>{const{filter:t}=e;if(t)return t;const{labelField:n}=e;return(e,t)=>{if(!e.length)return!0;const o=t[n];return"string"==typeof o&&o.toLowerCase().includes(e.toLowerCase())}})),c=S((()=>{const{pattern:t}=e;return t&&t.length&&d.value?function(e,t,n,o,a){const r=new Set,l=new Set,i=new Set,s=[],d=[],c=[];return function e(s){s.forEach((s=>{if(c.push(s),t(n,s)){r.add(s[o]),i.add(s[o]);for(let e=c.length-2;e>=0;--e){const t=c[e][o];if(l.has(t))break;l.add(t),r.has(t)&&r.delete(t)}}const d=s[a];d&&e(d),c.pop()}))}(e),function e(t,n){t.forEach((t=>{const i=t[o],d=r.has(i),c=l.has(i);if(!d&&!c)return;const u=t[a];if(u)if(d)n.push(t);else{s.push(i);const o=Object.assign(Object.assign({},t),{[a]:[]});n.push(o),e(u,o[a])}else n.push(t)}))}(e,d),{filteredTree:d,highlightKeySet:i,expandedKeys:s}}(e.data,d.value,t,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}})),u=S((()=>{return ae(e.showIrrelevantNodes?e.data:c.value.filteredTree,(t=e.keyField,n=e.childrenField,o=e.disabledField,{getIsGroup:()=>!1,getKey:e=>e[t],getChildren:e.getChildren||(e=>e[n]),getDisabled:e=>!(!e[o]&&!e.checkboxDisabled)}));var t,n,o})),h=A(Bt,null),f=e.internalTreeSelect?h.dataTreeMate:u,{watchProps:v}=e,p=m([]);(null==v?void 0:v.includes("defaultCheckedKeys"))?J((()=>{p.value=e.defaultCheckedKeys})):p.value=e.defaultCheckedKeys;const g=$(e,"checkedKeys"),y=N(g,p),x=S((()=>f.value.getCheckedKeys(y.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded}))),_=function(e){return S((()=>e.leafOnly?"child":e.checkStrategy))}(e),R=S((()=>x.value.checkedKeys)),T=S((()=>{const{indeterminateKeys:t}=e;return void 0!==t?t:x.value.indeterminateKeys})),P=m([]);(null==v?void 0:v.includes("defaultSelectedKeys"))?J((()=>{P.value=e.defaultSelectedKeys})):P.value=e.defaultSelectedKeys;const F=$(e,"selectedKeys"),L=N(F,P),D=m([]),E=t=>{D.value=e.defaultExpandAll?f.value.getNonLeafKeys():void 0===t?e.defaultExpandedKeys:t};(null==v?void 0:v.includes("defaultExpandedKeys"))?J((()=>{E(void 0)})):J((()=>{E(e.defaultExpandedKeys)}));const B=$(e,"expandedKeys"),z=N(B,D),j=S((()=>u.value.getFlattenedNodes(z.value))),{pendingNodeKeyRef:I,handleKeydown:K}=function({props:e,fNodesRef:t,mergedExpandedKeysRef:n,mergedSelectedKeysRef:o,mergedCheckedKeysRef:a,handleCheck:r,handleSelect:l,handleSwitcherClick:i}){const{value:s}=o,d=A(Bt,null),c=d?d.pendingNodeKeyRef:m(s.length?s[s.length-1]:null);return{pendingNodeKeyRef:c,handleKeydown:function(o){var s;if(!e.keyboard)return{enterBehavior:null};const{value:d}=c;let u=null;if(null===d){if("ArrowDown"!==o.key&&"ArrowUp"!==o.key||o.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(o.key)&&null===d){const{value:e}=t;let n=0;for(;n<e.length;){if(!e[n].disabled){c.value=e[n].key;break}n+=1}}}else{const{value:h}=t;let f=h.findIndex((e=>e.key===d));if(!~f)return{enterBehavior:null};if("Enter"===o.key){const t=h[f];switch(u=(null===(s=e.overrideDefaultNodeClickBehavior)||void 0===s?void 0:s.call(e,{option:t.rawNode}))||null,u){case"toggleCheck":r(t,!a.value.includes(t.key));break;case"toggleSelect":l(t);break;case"toggleExpand":i(t);break;case"none":break;default:u="default",l(t)}}else if("ArrowDown"===o.key)for(o.preventDefault(),f+=1;f<h.length;){if(!h[f].disabled){c.value=h[f].key;break}f+=1}else if("ArrowUp"===o.key)for(o.preventDefault(),f-=1;f>=0;){if(!h[f].disabled){c.value=h[f].key;break}f-=1}else if("ArrowLeft"===o.key){const e=h[f];if(e.isLeaf||!n.value.includes(d)){const t=e.getParent();t&&(c.value=t.key)}else i(e)}else if("ArrowRight"===o.key){const e=h[f];if(e.isLeaf)return{enterBehavior:null};if(n.value.includes(d))for(f+=1;f<h.length;){if(!h[f].disabled){c.value=h[f].key;break}f+=1}else i(e)}}return{enterBehavior:u}}}}({props:e,mergedCheckedKeysRef:y,mergedSelectedKeysRef:L,fNodesRef:j,mergedExpandedKeysRef:z,handleCheck:Ae,handleSelect:$e,handleSwitcherClick:Ne});let M=null,V=null;const H=m(new Set),q=S((()=>e.internalHighlightKeySet||c.value.highlightKeySet)),G=N(q,H),W=m(new Set),Z=S((()=>z.value.filter((e=>!W.value.has(e)))));let ee=0;const ne=m(null),se=m(null),de=m(null),ce=m(null),ue=m(0),he=S((()=>{const{value:e}=se;return e?e.parent:null}));let fe=!1;X($(e,"data"),(()=>{fe=!0,re((()=>{fe=!1})),W.value.clear(),I.value=null,Te()}),{deep:!1});let ve=!1;const pe=()=>{ve=!0,re((()=>{ve=!1}))};let ge;function ye(t){return Jt(this,void 0,void 0,(function*(){const{onLoad:n}=e;if(!n)return void(yield Promise.resolve());const{value:o}=W;if(!o.has(t.key)){o.add(t.key);try{!1===(yield n(t.rawNode))&&Fe()}catch(a){console.error(a),Fe()}o.delete(t.key)}}))}X($(e,"pattern"),((t,n)=>{if(e.showIrrelevantNodes)if(ge=void 0,t){const{expandedKeys:t,highlightKeySet:n}=Ht(e.data,e.pattern,e.keyField,e.childrenField,d.value);H.value=n,pe(),Ce(t,Se(t),{node:null,action:"filter"})}else H.value=new Set;else if(t.length){n.length||(ge=z.value);const{expandedKeys:e}=c.value;void 0!==e&&(pe(),Ce(e,Se(e),{node:null,action:"filter"}))}else void 0!==ge&&(pe(),Ce(ge,Se(ge),{node:null,action:"filter"}))})),J((()=>{var e;const{value:t}=u;if(!t)return;const{getNode:n}=t;null===(e=z.value)||void 0===e||e.forEach((e=>{const t=n(e);t&&!t.shallowLoaded&&ye(t)}))}));const be=m(!1),me=m([]);X(Z,((t,n)=>{if(!e.animated||ve)return void re(xe);if(fe)return;const o=te(r.value.self.nodeHeight),a=new Set(n);let i=null,d=null;for(const e of t)if(!a.has(e)){if(null!==i)return;i=e}const c=new Set(t);for(const e of n)if(!c.has(e)){if(null!==d)return;d=e}if(null===i&&null===d)return;const{virtualScroll:h}=e,f=(h?s.value.listElRef:l.value).offsetHeight,v=Math.ceil(f/o)+1;let p;if(null!==i&&(p=n),null!==d&&(p=void 0===p?t:p.filter((e=>e!==d))),be.value=!0,me.value=u.value.getFlattenedNodes(p),null!==i){const e=me.value.findIndex((e=>e.key===i));if(~e){const n=me.value[e].children;if(n){const a=le(n,t);me.value.splice(e+1,0,{__motion:!0,mode:"expand",height:h?a.length*o:void 0,nodes:h?a.slice(0,v):a})}}}if(null!==d){const e=me.value.findIndex((e=>e.key===d));if(~e){const n=me.value[e].children;if(!n)return;be.value=!0;const a=le(n,t);me.value.splice(e+1,0,{__motion:!0,mode:"collapse",height:h?a.length*o:void 0,nodes:h?a.slice(0,v):a})}}}));const ke=S((()=>ie(j.value))),we=S((()=>be.value?me.value:j.value));function xe(){const{value:e}=i;e&&e.sync()}function Se(e){const{getNode:t}=f.value;return e.map((e=>{var n;return(null===(n=t(e))||void 0===n?void 0:n.rawNode)||null}))}function Ce(t,n,o){const{"onUpdate:expandedKeys":a,onUpdateExpandedKeys:r}=e;D.value=t,a&&O(a,t,n,o),r&&O(r,t,n,o)}function _e(t,n,o){const{"onUpdate:checkedKeys":a,onUpdateCheckedKeys:r}=e;p.value=t,r&&O(r,t,n,o),a&&O(a,t,n,o)}function Re(t,n,o){const{"onUpdate:selectedKeys":a,onUpdateSelectedKeys:r}=e;P.value=t,r&&O(r,t,n,o),a&&O(a,t,n,o)}function Te(){ne.value=null,Pe()}function Pe(){ue.value=0,se.value=null,de.value=null,ce.value=null,Fe()}function Fe(){M&&(window.clearTimeout(M),M=null),V=null}function Ae(t,n){if(e.disabled||Vt(t,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple)return void $e(t);const o=n?"check":"uncheck",{checkedKeys:a,indeterminateKeys:r}=f.value[o](t.key,R.value,{cascade:e.cascade,checkStrategy:_.value,allowNotLoaded:e.allowCheckingNotLoaded});_e(a,Se(a),{node:t.rawNode,action:o}),function(t,n){const{"onUpdate:indeterminateKeys":o,onUpdateIndeterminateKeys:a}=e;o&&O(o,t,n),a&&O(a,t,n)}(r,Se(r))}function Ne(t){e.disabled||be.value||function(t){if(e.disabled)return;const{key:n}=t,{value:o}=z,a=o.findIndex((e=>e===n));if(~a){const e=Array.from(o);e.splice(a,1),Ce(e,Se(e),{node:t.rawNode,action:"collapse"})}else{const a=u.value.getNode(n);if(!a||a.isLeaf)return;let r;if(e.accordion){const e=new Set(t.siblings.map((({key:e})=>e)));r=o.filter((t=>!e.has(t))),r.push(n)}else r=o.concat(n);Ce(r,Se(r),{node:t.rawNode,action:"expand"})}}(t)}function $e(t){if(!e.disabled&&e.selectable){if(I.value=t.key,e.internalUnifySelectCheck){const{value:{checkedKeys:n,indeterminateKeys:o}}=x;e.multiple?Ae(t,!(n.includes(t.key)||o.includes(t.key))):_e([t.key],Se([t.key]),{node:t.rawNode,action:"check"})}if(e.multiple){const n=Array.from(L.value),o=n.findIndex((e=>e===t.key));~o?e.cancelable&&n.splice(o,1):~o||n.push(t.key),Re(n,Se(n),{node:t.rawNode,action:~o?"unselect":"select"})}else{L.value.includes(t.key)?e.cancelable&&Re([],[],{node:t.rawNode,action:"unselect"}):Re([t.key],Se([t.key]),{node:t.rawNode,action:"select"})}}}function Le({event:t,node:n},o=!0){var a;if(!e.draggable||e.disabled||Vt(n,e.disabledField))return;const{value:r}=ne;if(!r)return;const{allowDrop:l,indent:i}=e;o&&function(t){const{onDragover:n}=e;n&&O(n,t)}({event:t,node:n.rawNode});const s=t.currentTarget,{height:d,top:c}=s.getBoundingClientRect(),u=t.clientY-c;let h;h=l({node:n.rawNode,dropPosition:"inside",phase:"drag"})?u<=8?"before":u>=d-8?"after":"inside":u<=d/2?"before":"after";const{value:f}=ke;let v,p;const g=f(n.key);if(null===g)return void Pe();let y=!1;"inside"===h?(v=n,p="inside"):"before"===h?n.isFirstChild?(v=n,p="before"):(v=j.value[g-1],p="after"):(v=n,p="after"),!v.isLeaf&&z.value.includes(v.key)&&(y=!0,"after"===p&&(v=j.value[g+1],v?p="before":(v=n,p="inside")));const b=v;if(de.value=b,!y&&r.isLastChild&&r.key===v.key&&(p="after"),"after"===p){let e=ee-t.clientX,n=0;for(;e>=i/2&&null!==v.parent&&v.isLastChild&&n<1;)e-=i,n+=1,v=v.parent;ue.value=n}else ue.value=0;if(!(r.contains(v)||"inside"===p&&(null===(a=r.parent)||void 0===a?void 0:a.key)===v.key)||r.key===b.key&&r.key===v.key)if(l({node:v.rawNode,dropPosition:p,phase:"drag"})){if(r.key===v.key)Fe();else if(V!==v.key)if("inside"===p){if(e.expandOnDragenter){if(function(e){if(M&&(window.clearTimeout(M),M=null),e.isLeaf)return;V=e.key;const t=()=>{if(V!==e.key)return;const{value:t}=de;if(t&&t.key===e.key&&!z.value.includes(e.key)){const t=z.value.concat(e.key);Ce(t,Se(t),{node:e.rawNode,action:"expand"})}M=null,V=null};M=e.shallowLoaded?window.setTimeout((()=>{t()}),1e3):window.setTimeout((()=>{ye(e).then((()=>{t()}))}),1e3)}(v),!v.shallowLoaded&&V!==v.key)return void Te()}else if(!v.shallowLoaded)return void Te()}else Fe();else"inside"!==p&&Fe();ce.value=p,se.value=v}else Pe();else Pe()}X(I,(t=>{var n,o;if(null!==t)if(e.virtualScroll)null===(n=s.value)||void 0===n||n.scrollTo({key:t});else if(e.internalScrollable){const{value:e}=i;if(null===e)return;const n=null===(o=e.contentRef)||void 0===o?void 0:o.querySelector(`[data-key="${mt(t)}"]`);if(!n)return;e.scrollTo({el:n})}})),w(zt,{loadingKeysRef:W,highlightKeySetRef:G,displayedCheckedKeysRef:R,displayedIndeterminateKeysRef:T,mergedSelectedKeysRef:L,mergedExpandedKeysRef:z,mergedThemeRef:r,mergedCheckStrategyRef:_,nodePropsRef:$(e,"nodeProps"),disabledRef:$(e,"disabled"),checkableRef:$(e,"checkable"),selectableRef:$(e,"selectable"),expandOnClickRef:$(e,"expandOnClick"),onLoadRef:$(e,"onLoad"),draggableRef:$(e,"draggable"),blockLineRef:$(e,"blockLine"),indentRef:$(e,"indent"),cascadeRef:$(e,"cascade"),checkOnClickRef:$(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:de,droppingNodeParentRef:he,draggingNodeRef:ne,droppingPositionRef:ce,droppingOffsetLevelRef:ue,fNodesRef:j,pendingNodeKeyRef:I,showLineRef:$(e,"showLine"),disabledFieldRef:$(e,"disabledField"),internalScrollableRef:$(e,"internalScrollable"),internalCheckboxFocusableRef:$(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:$(e,"renderLabel"),renderPrefixRef:$(e,"renderPrefix"),renderSuffixRef:$(e,"renderSuffix"),renderSwitcherIconRef:$(e,"renderSwitcherIcon"),labelFieldRef:$(e,"labelField"),multipleRef:$(e,"multiple"),overrideDefaultNodeClickBehaviorRef:$(e,"overrideDefaultNodeClickBehavior"),handleSwitcherClick:Ne,handleDragEnd:function({event:t,node:n}){Te(),!e.draggable||e.disabled||Vt(n,e.disabledField)||function(t){const{onDragend:n}=e;n&&O(n,t)}({event:t,node:n.rawNode})},handleDragEnter:function({event:t,node:n}){!e.draggable||e.disabled||Vt(n,e.disabledField)||(Le({event:t,node:n},!1),function(t){const{onDragenter:n}=e;n&&O(n,t)}({event:t,node:n.rawNode}))},handleDragLeave:function({event:t,node:n}){!e.draggable||e.disabled||Vt(n,e.disabledField)||function(t){const{onDragleave:n}=e;n&&O(n,t)}({event:t,node:n.rawNode})},handleDragStart:function({event:t,node:n}){!e.draggable||e.disabled||Vt(n,e.disabledField)||(ee=t.clientX,ne.value=n,function(t){const{onDragstart:n}=e;n&&O(n,t)}({event:t,node:n.rawNode}))},handleDrop:function({event:t,node:n,dropPosition:o}){if(!e.draggable||e.disabled||Vt(n,e.disabledField))return;const{value:a}=ne,{value:r}=se,{value:l}=ce;if(a&&r&&l&&e.allowDrop({node:r.rawNode,dropPosition:l,phase:"drag"})&&a.key!==r.key){if("before"===l){const e=a.getNext({includeDisabled:!0});if(e&&e.key===r.key)return void Pe()}if("after"===l){const e=a.getPrev({includeDisabled:!0});if(e&&e.key===r.key)return void Pe()}!function(t){const{onDrop:n}=e;n&&O(n,t)}({event:t,node:r.rawNode,dragNode:a.rawNode,dropPosition:o}),Te()}},handleDragOver:Le,handleSelect:$e,handleCheck:Ae});const Oe={handleKeydown:K,scrollTo:function(e,t){var n,o;"number"==typeof e?null===(n=s.value)||void 0===n||n.scrollTo(e,t||0):null===(o=s.value)||void 0===o||o.scrollTo(e)},getCheckedData:()=>{if(!e.checkable)return{keys:[],options:[]};const{checkedKeys:t}=x.value;return{keys:t,options:Se(t)}},getIndeterminateData:()=>{if(!e.checkable)return{keys:[],options:[]};const{indeterminateKeys:t}=x.value;return{keys:t,options:Se(t)}}},De=S((()=>{const{common:{cubicBezierEaseInOut:e},self:{fontSize:t,nodeBorderRadius:n,nodeColorHover:o,nodeColorPressed:a,nodeColorActive:l,arrowColor:i,loadingColor:s,nodeTextColor:d,nodeTextColorDisabled:c,dropMarkColor:u,nodeWrapperPadding:h,nodeHeight:f,lineHeight:v,lineColor:p}}=r.value,g=Q(h,"top"),y=Q(h,"bottom");return{"--n-arrow-color":i,"--n-loading-color":s,"--n-bezier":e,"--n-font-size":t,"--n-node-border-radius":n,"--n-node-color-active":l,"--n-node-color-hover":o,"--n-node-color-pressed":a,"--n-node-text-color":d,"--n-node-text-color-disabled":c,"--n-drop-mark-color":u,"--n-node-wrapper-padding":h,"--n-line-offset-top":`-${g}`,"--n-line-offset-bottom":`-${y}`,"--n-node-content-height":U(te(f)-te(g)-te(y)),"--n-line-height":v,"--n-line-color":p}})),Ee=n?C("tree",void 0,De,e):void 0;return Object.assign(Object.assign({},Oe),{mergedClsPrefix:t,mergedTheme:r,rtlEnabled:a,fNodes:we,aip:be,selfElRef:l,virtualListInstRef:s,scrollbarInstRef:i,handleFocusout:function(t){var n;if(e.virtualScroll||e.internalScrollable){const{value:e}=i;if(null===(n=null==e?void 0:e.containerRef)||void 0===n?void 0:n.contains(t.relatedTarget))return;I.value=null}else{const{value:e}=l;if(null==e?void 0:e.contains(t.relatedTarget))return;I.value=null}},handleDragLeaveTree:function(e){e.target===e.currentTarget&&Pe()},handleScroll:function(){xe()},getScrollContainer:function(){var e;return null===(e=s.value)||void 0===e?void 0:e.listElRef},getScrollContent:function(){var e;return null===(e=s.value)||void 0===e?void 0:e.itemsElRef},handleAfterEnter:function(){be.value=!1,e.virtualScroll&&re(xe)},handleResize:function(){xe()},cssVars:n?void 0:De,themeClass:null==Ee?void 0:Ee.themeClass,onRender:null==Ee?void 0:Ee.onRender})},render(){var e;const{fNodes:t,internalRenderEmpty:n}=this;if(!t.length&&n)return n();const{mergedClsPrefix:o,blockNode:a,blockLine:r,draggable:l,disabled:i,internalFocusable:s,checkable:d,handleKeydown:u,rtlEnabled:h,handleFocusout:f,scrollbarProps:v}=this,p=s&&!i,g=p?"0":void 0,y=[`${o}-tree`,h&&`${o}-tree--rtl`,d&&`${o}-tree--checkable`,(r||a)&&`${o}-tree--block-node`,r&&`${o}-tree--block-line`],b=e=>"__motion"in e?c(Gt,{height:e.height,nodes:e.nodes,clsPrefix:o,mode:e.mode,onAfterEnter:this.handleAfterEnter}):c(qt,{key:e.key,tmNode:e,clsPrefix:o});if(this.virtualScroll){const{mergedTheme:e,internalScrollablePadding:n}=this,a=Q(n||"0");return c(ne,Object.assign({},v,{ref:"scrollbarInstRef",onDragleave:l?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:y,theme:e.peers.Scrollbar,themeOverrides:e.peerOverrides.Scrollbar,tabindex:g,onKeydown:p?u:void 0,onFocusout:p?f:void 0}),{default:()=>{var n;return null===(n=this.onRender)||void 0===n||n.call(this),t.length?c(ee,{ref:"virtualListInstRef",items:this.fNodes,itemSize:te(e.self.nodeHeight),ignoreItemResize:this.aip,paddingTop:a.top,paddingBottom:a.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:a.left,paddingRight:a.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:e})=>b(e)}):Z(this.$slots.empty,(()=>[c(se,{class:`${o}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}})}const{internalScrollable:m}=this;return y.push(this.themeClass),null===(e=this.onRender)||void 0===e||e.call(this),m?c(ne,Object.assign({},v,{class:y,tabindex:g,onKeydown:p?u:void 0,onFocusout:p?f:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}}),{default:()=>c("div",{onDragleave:l?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(b))}):c("div",{class:y,tabindex:g,ref:"selfElRef",style:this.cssVars,onKeydown:p?u:void 0,onFocusout:p?f:void 0,onDragleave:l?this.handleDragLeaveTree:void 0},t.length?t.map(b):Z(this.$slots.empty,(()=>[c(se,{class:`${o}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})])))}}),en={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},tn=[ue("g",{fill:"none"},[ue("path",{d:"M6 2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7.414a1.5 1.5 0 0 0-.44-1.06l-3.914-3.915A1.5 1.5 0 0 0 10.586 2H6zM5 4a1 1 0 0 1 1-1h4v3.5A1.5 1.5 0 0 0 11.5 8H15v8a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V4zm9.793 3H11.5a.5.5 0 0 1-.5-.5V3.207L14.793 7z",fill:"currentColor"})],-1)],nn=d({name:"Document20Regular",render:function(e,t){return de(),ce("svg",en,tn)}}),on={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},an=[ue("g",{fill:"none"},[ue("path",{d:"M7.167 3c.27 0 .535.073.765.21l.135.09l1.6 1.2H15.5a2.5 2.5 0 0 1 2.479 2.174l.016.162L18 7v7.5a2.5 2.5 0 0 1-2.336 2.495L15.5 17h-11a2.5 2.5 0 0 1-2.495-2.336L2 14.5v-9a2.5 2.5 0 0 1 2.336-2.495L4.5 3h2.667zm.99 4.034a1.5 1.5 0 0 1-.933.458l-.153.008L3 7.499V14.5a1.5 1.5 0 0 0 1.356 1.493L4.5 16h11a1.5 1.5 0 0 0 1.493-1.355L17 14.5V7a1.5 1.5 0 0 0-1.355-1.493L15.5 5.5H9.617l-1.46 1.534zM7.168 4H4.5a1.5 1.5 0 0 0-1.493 1.356L3 5.5v.999l4.071.001a.5.5 0 0 0 .302-.101l.06-.054L8.694 5.02L7.467 4.1a.5.5 0 0 0-.22-.093L7.167 4z",fill:"currentColor"})],-1)],rn=d({name:"Folder20Regular",render:function(e,t){return de(),ce("svg",on,an)}}),ln={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},sn=[ue("g",{fill:"none"},[ue("path",{d:"M5 3a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V6.621a2 2 0 0 0-.586-1.414l-1.621-1.621A2 2 0 0 0 11.379 3H5zM4 5a1 1 0 0 1 1-1h1v1.5A1.5 1.5 0 0 0 7.5 7h2A1.5 1.5 0 0 0 11 5.5V4h.379a1 1 0 0 1 .707.293l1.621 1.621a1 1 0 0 1 .293.707V13a1 1 0 0 1-1 1v-3.5A1.5 1.5 0 0 0 11.5 9h-5A1.5 1.5 0 0 0 5 10.5V14a1 1 0 0 1-1-1V5zm3 .5V4h3v1.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5zm5 5V14H6v-3.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5zM8.5 17a3.489 3.489 0 0 1-2.45-1h7.45a2.5 2.5 0 0 0 2.5-2.5V6.05c.618.632 1 1.497 1 2.45v5a3.5 3.5 0 0 1-3.5 3.5h-5z",fill:"currentColor"})],-1)],dn=d({name:"SaveMultiple20Regular",render:function(e,t){return de(),ce("svg",ln,sn)}}),cn=he("i18nToolMain",{state:()=>({dirTree:[],filePathArr:[],translatePath:"",changedLabelMap:{}})}),un={class:"vp-bg action-row"},hn=".translate-item",fn=Re(d({__name:"GuiToolbox",setup(e){const{t:t}=fe(),n=cn();K((()=>{o()}));const o=()=>{const e=n.translatePath;if(!e)return;const t=document.querySelector(`${hn}[data-translate-path="${e}"]`);t&&(t.classList.add("t_selected"),t.scrollIntoView({behavior:"smooth",block:"center"}))},a=()=>new Promise((e=>{Ce.emit(_e.I18N_BATCH_GUI_GET_SUBS,e)})),r=async()=>{const e=await a();console.log("[items]",e);const t=[];for(const n in e){const o=e[n];t.push({label:o.dirItem.label,value:o.currentItem?o.fieldValue:void 0})}window.$qlUtils.copy(t)},l=async()=>{try{const e=await Se(),n=JSON.parse(e);console.log("[pastedResult]",n);const o=await a(),r={};o.forEach((e=>{r[e.dirItem.label]=e})),console.log("[itemsLabelMap]",r);for(const t in n){const e=n[t],{label:o,value:a}=e;if(null!=a){const e=r[o];e&&(e.fieldValue=a)}}window.$message.success(t("msgs.action_completed_pl"))}catch(e){window.$message.error(e.message)}},i=async()=>{console.log("[translatePath]",n.translatePath),console.log("[dirTree]",n.dirTree),console.log("[filePathArr]",n.filePathArr);const e=await a();console.log("[getSubItems]",e),console.log("TODO")},s=m(!1),d=S((()=>{const e=n.translatePath;return[{label:t("msgs.fen_xi_fan_yi_shu")+" (TBD)",props:{onClick:i}},{label:"Locate",disabled:!e,props:{onClick:()=>{o()}}},{label:t("msgs.copy_json_from_right"),disabled:!e,props:{onClick:r}},{label:t("msgs.paste_json_override_right"),disabled:!e,props:{onClick:l}}]})),c=m(""),u=xe((()=>{const e=document.querySelectorAll(`${hn}[data-translate-path*="${c.value}"]`);Array.from(e).forEach(((e,t)=>{const o=e.getAttribute("data-translate-path");e.classList.add("t_selected"),0===t&&e.scrollIntoView({behavior:"smooth",block:"center"}),o!==n.translatePath&&(e.classList.add("_transition"),setTimeout((()=>{e.classList.remove("t_selected"),setTimeout((()=>{e.classList.remove("_transition")}),1e3)}),1e3))}))}),500);return(e,t)=>(de(),ce("div",un,[ue("button",{class:"vp-button",onClick:t[0]||(t[0]=e=>s.value=!s.value),onMouseover:t[1]||(t[1]=e=>s.value=!0)}," Gui Toolbox ",32),ve(ue("input",{class:"vp-input",style:{flex:"1"},"onUpdate:modelValue":t[2]||(t[2]=e=>c.value=e),placeholder:"Locate Translate Path",onInput:t[3]||(t[3]=(...e)=>ge(u)&&ge(u)(...e)),onKeyup:[t[4]||(t[4]=ye(((...e)=>ge(u)&&ge(u)(...e)),["enter"])),t[5]||(t[5]=ye((e=>c.value=""),["esc"]))]},null,544),[[pe,c.value]]),be(we,{name:"fade-scale"},{default:me((()=>[be(ke,{style:{top:"100%"},visible:s.value,"onUpdate:visible":t[6]||(t[6]=e=>s.value=e),options:ge(d),onMouseleave:t[7]||(t[7]=e=>s.value=!1)},null,8,["visible","options"])])),_:1})]))}}),[["__scopeId","data-v-4e764390"]]);var vn=Array.isArray,pn="object"==typeof Te&&Te&&Te.Object===Object&&Te,gn="object"==typeof self&&self&&self.Object===Object&&self,yn=pn||gn||Function("return this")(),bn=yn.Symbol,mn=bn,kn=Object.prototype,wn=kn.hasOwnProperty,xn=kn.toString,Sn=mn?mn.toStringTag:void 0;var Cn=function(e){var t=wn.call(e,Sn),n=e[Sn];try{e[Sn]=void 0;var o=!0}catch(r){}var a=xn.call(e);return o&&(t?e[Sn]=n:delete e[Sn]),a},_n=Object.prototype.toString;var Rn=Cn,Tn=function(e){return _n.call(e)},Pn=bn?bn.toStringTag:void 0;var Fn=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Pn&&Pn in Object(e)?Rn(e):Tn(e)};var An=Fn,Nn=function(e){return null!=e&&"object"==typeof e};var $n=function(e){return"symbol"==typeof e||Nn(e)&&"[object Symbol]"==An(e)},Ln=vn,On=$n,Dn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,En=/^\w*$/;var Bn=function(e,t){if(Ln(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!On(e))||(En.test(e)||!Dn.test(e)||null!=t&&e in Object(t))};var zn=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},jn=Fn,In=zn;var Kn,Mn=function(e){if(!In(e))return!1;var t=jn(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Vn=yn["__core-js_shared__"],Un=(Kn=/[^.]+$/.exec(Vn&&Vn.keys&&Vn.keys.IE_PROTO||""))?"Symbol(src)_1."+Kn:"";var Hn=function(e){return!!Un&&Un in e},qn=Function.prototype.toString;var Gn=Mn,Wn=Hn,Yn=zn,Jn=function(e){if(null!=e){try{return qn.call(e)}catch(t){}try{return e+""}catch(t){}}return""},Xn=/^\[object .+?Constructor\]$/,Qn=Function.prototype,Zn=Object.prototype,eo=Qn.toString,to=Zn.hasOwnProperty,no=RegExp("^"+eo.call(to).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var oo=function(e){return!(!Yn(e)||Wn(e))&&(Gn(e)?no:Xn).test(Jn(e))},ao=function(e,t){return null==e?void 0:e[t]};var ro=function(e,t){var n=ao(e,t);return oo(n)?n:void 0},lo=ro(Object,"create"),io=lo;var so=function(){this.__data__=io?io(null):{},this.size=0};var co=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},uo=lo,ho=Object.prototype.hasOwnProperty;var fo=function(e){var t=this.__data__;if(uo){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return ho.call(t,e)?t[e]:void 0},vo=lo,po=Object.prototype.hasOwnProperty;var go=lo;var yo=so,bo=co,mo=fo,ko=function(e){var t=this.__data__;return vo?void 0!==t[e]:po.call(t,e)},wo=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=go&&void 0===t?"__lodash_hash_undefined__":t,this};function xo(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}xo.prototype.clear=yo,xo.prototype.delete=bo,xo.prototype.get=mo,xo.prototype.has=ko,xo.prototype.set=wo;var So=xo;var Co=function(){this.__data__=[],this.size=0};var _o=function(e,t){return e===t||e!=e&&t!=t},Ro=_o;var To=function(e,t){for(var n=e.length;n--;)if(Ro(e[n][0],t))return n;return-1},Po=To,Fo=Array.prototype.splice;var Ao=To;var No=To;var $o=To;var Lo=Co,Oo=function(e){var t=this.__data__,n=Po(t,e);return!(n<0)&&(n==t.length-1?t.pop():Fo.call(t,n,1),--this.size,!0)},Do=function(e){var t=this.__data__,n=Ao(t,e);return n<0?void 0:t[n][1]},Eo=function(e){return No(this.__data__,e)>-1},Bo=function(e,t){var n=this.__data__,o=$o(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this};function zo(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}zo.prototype.clear=Lo,zo.prototype.delete=Oo,zo.prototype.get=Do,zo.prototype.has=Eo,zo.prototype.set=Bo;var jo=zo,Io=ro(yn,"Map"),Ko=So,Mo=jo,Vo=Io;var Uo=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Ho=function(e,t){var n=e.__data__;return Uo(t)?n["string"==typeof t?"string":"hash"]:n.map},qo=Ho;var Go=Ho;var Wo=Ho;var Yo=Ho;var Jo=function(){this.size=0,this.__data__={hash:new Ko,map:new(Vo||Mo),string:new Ko}},Xo=function(e){var t=qo(this,e).delete(e);return this.size-=t?1:0,t},Qo=function(e){return Go(this,e).get(e)},Zo=function(e){return Wo(this,e).has(e)},ea=function(e,t){var n=Yo(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this};function ta(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}ta.prototype.clear=Jo,ta.prototype.delete=Xo,ta.prototype.get=Qo,ta.prototype.has=Zo,ta.prototype.set=ea;var na=ta;function oa(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var o=arguments,a=t?t.apply(this,o):o[0],r=n.cache;if(r.has(a))return r.get(a);var l=e.apply(this,o);return n.cache=r.set(a,l)||r,l};return n.cache=new(oa.Cache||na),n}oa.Cache=na;var aa=oa;var ra=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,la=/\\(\\)?/g,ia=function(e){var t=aa(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ra,(function(e,n,o,a){t.push(o?a.replace(la,"$1"):n||e)})),t}));var sa=function(e,t){for(var n=-1,o=null==e?0:e.length,a=Array(o);++n<o;)a[n]=t(e[n],n,e);return a},da=vn,ca=$n,ua=bn?bn.prototype:void 0,ha=ua?ua.toString:void 0;var fa=function e(t){if("string"==typeof t)return t;if(da(t))return sa(t,e)+"";if(ca(t))return ha?ha.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n},va=fa;var pa=vn,ga=Bn,ya=ia,ba=function(e){return null==e?"":va(e)};var ma=function(e,t){return pa(e)?e:ga(e,t)?[e]:ya(ba(e))},ka=$n;var wa=function(e){if("string"==typeof e||ka(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},xa=ma,Sa=wa;var Ca=function(e,t){for(var n=0,o=(t=xa(t,e)).length;null!=e&&n<o;)e=e[Sa(t[n++])];return n&&n==o?e:void 0},_a=Ca;const Ra=Pe((function(e,t,n){var o=null==e?void 0:_a(e,t);return void 0===o?n:o}));var Ta=ro,Pa=function(){try{var e=Ta(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();var Fa=function(e,t,n){"__proto__"==t&&Pa?Pa(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Aa=_o,Na=Object.prototype.hasOwnProperty;var $a=/^(?:0|[1-9]\d*)$/;var La=function(e,t,n){var o=e[t];Na.call(e,t)&&Aa(o,n)&&(void 0!==n||t in e)||Fa(e,t,n)},Oa=ma,Da=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&$a.test(e))&&e>-1&&e%1==0&&e<t},Ea=zn,Ba=wa;var za=function(e,t,n,o){if(!Ea(e))return e;for(var a=-1,r=(t=Oa(t,e)).length,l=r-1,i=e;null!=i&&++a<r;){var s=Ba(t[a]),d=n;if("__proto__"===s||"constructor"===s||"prototype"===s)return e;if(a!=l){var c=i[s];void 0===(d=o?o(c,s,i):void 0)&&(d=Ea(c)?c:Da(t[a+1])?[]:{})}La(i,s,d),i=i[s]}return e};const ja=Pe((function(e,t,n){return null==e?e:za(e,t,n)}));var Ia=Ca,Ka=function(e,t,n){var o=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(n=n>a?a:n)<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var r=Array(a);++o<a;)r[o]=e[o+t];return r};var Ma=ma,Va=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},Ua=function(e,t){return t.length<2?e:Ia(e,Ka(t,0,-1))},Ha=wa;var qa=function(e,t){return t=Ma(t,e),null==(e=Ua(e,t))||delete e[Ha(Va(t))]};const Ga=Pe((function(e,t){return null==e||qa(e,t)})),Wa=t=>{const n=cn(),o=e(),a=m(),r=async()=>{for(let e=0;e<a.value.length;e++){const t=a.value[e];await t.saveChange({isSetValue:!0})}};K((()=>{Ce.on(_e.I18N_SAVE_ALL_CHANGES,r)})),Fe((()=>{Ce.off(_e.I18N_SAVE_ALL_CHANGES,r)}));const l=S((()=>o.isFoldersMode?n.dirTree.filter((e=>"directory"===e.kind)):n.dirTree));return{handleSaveChanged:r,itemsRef:a,filePathArrFiltered:l}};const Ya=t=>{const n=cn(),o=e(),{t:a}=fe(),r=m(!1),{dirItem:l}=Ae(t),i=S((()=>o.isFoldersMode?n.filePathArr.slice(1):n.filePathArr)),s=S((()=>o.isFoldersMode?(()=>{let e=null;const t=(n,o,a=0)=>{const r=o[a];if(n)for(let l=0;l<n.length;l++){const i=n[l];if(i.label===r&&a===o.length-1)throw e=i,new Error("item found");i.children&&t(i.children,o,a+1)}};try{t(l.value.children,i.value)}catch(n){}return e})():l.value)),d=()=>{const e=document.querySelector(".js_reload_btn");e&&e.click()},c=m(!1);return{isLoading:r,currentItem:s,handleSaveFile:async e=>{try{if(r.value=!0,!s.value)return;const t=s.value.entry;if(!t)return;const n=await t.createWritable();await n.write(e),await n.close();const o=l.value.label+": "+t.name;console.log("[handleSaveFile]",o),window.$message.success(`${o} `+a("msgs.saved"))}catch(t){throw console.error(t),window.$message.error(a("msgs.error")+t.message),t}finally{r.value=!1}},isLocalCreated:c,handleCreateFile:async e=>{try{if(r.value=!0,!l.value)return;const t=l.value.entry;if(!t)return;const n=i.value.join("/"),o=n.substring(0,n.lastIndexOf("/")),a=await async function(e,t){if(!t)return e;const n=t.split("/");let o=e;for(const a of n)o=await o.getDirectoryHandle(a,{create:!0});return console.log(`Folder "${t}" created successfully.`),o}(t,o),s=JSON.stringify({},null,2);await async function(e,t,n){console.log("[createFile] ");const o=await e.getFileHandle(t,{create:!0}),a=await o.createWritable();return console.log("[createFile] "),await a.write(n),console.log("[createFile] "),await a.close(),console.log(`[createFile] ${t} created and written successfully.`),o}(a,n.substring(n.lastIndexOf("/")+1),s);window.$message.success("Created "+n),c.value=!0,"function"==typeof e&&await e(),setTimeout((()=>{d()}))}catch(t){console.error(t),window.$message.error(t.message)}finally{r.value=!1}},handleReload:d,subFilePathArr:i}},Ja=d({name:"SubGuiItem",components:{CcFlag:t,Delete20Regular:n,FieldEdit:o,DialogTextEdit:a,SaveMultiple20Regular:dn,ClipboardPaste20Regular:Ne},props:{dirItem:{type:Object,required:!0}},emits:["saveChanged"],setup(t,{emit:n}){Ae(t),fe();const o=cn(),a=e(),{isLoading:r,currentItem:l,handleSaveFile:i,isLocalCreated:s,handleCreateFile:d,handleReload:c,subFilePathArr:u}=Ya(t);let h=$e(null);const f=m(null),v=m(!1),p=()=>Ra(h.value,o.translatePath,null),g=e=>{try{ja(h.value,o.translatePath,e)}catch(t){throw console.error(t),window.$message.error(t.message),t}},y=()=>{Ga(h.value,o.translatePath),f.value=null,v.value=!0},b=()=>{h.value=null,f.value=null,re((()=>{v.value=!1}))};Fe((()=>{b()})),X(l,(async e=>{if(!e)return void b();const t=await e.entry.getFile(),n=await Le(t);h.value=JSON.parse(n),f.value=p(),re((()=>{v.value=!1}))}),{immediate:!0}),X(f,(()=>{v.value=!0})),X((()=>o.translatePath),(e=>{f.value=p(),re((()=>{v.value=!1}))}));const k=m(),w=m(!1),x=e=>{g(e),f.value=e,w.value=!0,re((()=>{k.value.focus()}))},S=async({isEmit:e=!1,isSetValue:t=!1}={})=>{v.value&&(t&&g(f.value),await i(JSON.stringify(h.value,null,2)),v.value=!1,e&&n("saveChanged"))},C=m(!1),_=m("");X(C,(e=>{e||(_.value="")}));return{i18nMainStore:o,i18nSetStore:a,currentItem:l,translateObj:h,fieldValue:f,isChanged:v,createField:x,pasteCreateField:async()=>{const e=await Se();x((e=>Oe(e,a.autoPasteTextConvertMode,{isTrimQuotes:a.autoPasteTrimQuotes}))(e))},saveChange:S,cancelChange:()=>{if(w.value)return y(),void(w.value=!1);f.value=p(),re((()=>{v.value=!1}))},inputRef:k,isLocalCreated:s,handleCreateFile:d,handleReload:c,isShowArrayEdit:C,currentArrayString:_,handlePreviewArrayText:()=>{_.value=JSON.stringify(f.value,null,2),C.value=!0},handleSaveArray:e=>{try{f.value=JSON.parse(e),C.value=!1}catch(t){console.error(t),window.$message.error(t.message)}},handleDeleteField:()=>{y(),S()},isLoading:r,subFilePathArr:u}}}),Xa=["data-translate-path"],Qa={key:0,class:"mc-loading-container"},Za={class:"card-header"},er={class:"card-title-wrap"},tr={class:"card-title font-code"},nr={class:"region-label"},or={key:1,class:"tip-not-exist"},ar={key:3,style:{color:"gray"}};const rr=Re(Ja,[["render",function(e,n,r,l,i,s){const d=ut,c=t,u=De("Delete20Regular"),h=Ke,f=Me,v=o,p=De("SaveMultiple20Regular"),g=Ve,y=Ue,b=De("ClipboardPaste20Regular"),m=a;return de(),ce("div",{class:"batch-translate-item vp-panel","data-translate-path":e.i18nMainStore.translatePath},[e.isLoading?(de(),ce("div",Qa,[be(d,{size:"small"})])):Ee("",!0),ue("div",Za,[ue("div",er,[ue("span",tr,[e.i18nSetStore.enableFlag?(de(),Be(c,{key:0,cc:e.dirItem.label},null,8,["cc"])):Ee("",!0),ue("span",nr,ze(e.dirItem.label),1),e.i18nSetStore.isFoldersMode?(de(),ce(je,{key:1},[Ie(ze("/"+e.subFilePathArr.join("/")),1)],64)):Ee("",!0)])]),e.currentItem&&null!==e.fieldValue?(de(),Be(f,{key:0,onPositiveClick:e.handleDeleteField},{trigger:me((()=>[be(h,{size:"small",tertiary:"",type:"error",title:"Delete Field"},{icon:me((()=>[be(u)])),_:1})])),default:me((()=>[Ie(" "+ze(e.$t("msgs.remove_item")),1)])),_:1},8,["onPositiveClick"])):Ee("",!0)]),e.currentItem?e.i18nMainStore.translatePath?(de(),ce(je,{key:2},[null!==e.fieldValue?(de(),Be(y,{key:0,align:"center",size:"small"},{default:me((()=>[be(v,{ref:"inputRef",modelValue:e.fieldValue,"onUpdate:modelValue":n[1]||(n[1]=t=>e.fieldValue=t),onPreviewArray:e.handlePreviewArrayText},null,8,["modelValue","onPreviewArray"]),e.isChanged?(de(),Be(g,{key:0},{default:me((()=>[be(h,{size:"small",type:"primary",onClick:n[2]||(n[2]=t=>e.saveChange({isEmit:!0,isSetValue:!0})),title:"Batch Save"},{icon:me((()=>[be(p)])),_:1}),be(h,{secondary:"",size:"small",onClick:e.cancelChange},{default:me((()=>[Ie(ze(e.$t("actions.cancel")),1)])),_:1},8,["onClick"])])),_:1})):Ee("",!0)])),_:1})):(de(),Be(g,{key:1},{default:me((()=>[be(h,{size:"small",onClick:n[3]||(n[3]=t=>e.pasteCreateField()),type:"primary",title:`Auto Paste Create (${e.i18nSetStore.autoPasteTextConvertMode})`},{icon:me((()=>[be(b)])),_:1},8,["title"]),be(h,{size:"small",onClick:n[4]||(n[4]=t=>e.createField("")),type:"primary"},{default:me((()=>[Ie(ze(e.$t("actions.create_text")),1)])),_:1}),be(h,{size:"small",onClick:n[5]||(n[5]=t=>e.createField([]))},{default:me((()=>[Ie(ze(e.$t("actions.create_array")),1)])),_:1})])),_:1}))],64)):(de(),ce("div",ar,ze(e.$t("msgs.please_select_a_tran")),1)):(de(),ce("div",or,[e.isLocalCreated?(de(),Be(h,{key:0,secondary:"",size:"small",onClick:e.handleReload},{default:me((()=>[Ie(ze(e.$t("actions.reload")),1)])),_:1},8,["onClick"])):(de(),ce(je,{key:1},[Ie(" File does not exist, please "),ue("b",{style:{"text-decoration":"underline",cursor:"pointer"},onClick:n[0]||(n[0]=(...t)=>e.handleCreateFile&&e.handleCreateFile(...t))}," create it "),Ie(" on your local file system ")],64))])),e.isShowArrayEdit?(de(),Be(m,{key:4,"is-textarea":"",title:e.$t("common.array_detail"),placeholder:e.$t("common.array_json_string"),visible:e.isShowArrayEdit,"onUpdate:visible":n[6]||(n[6]=t=>e.isShowArrayEdit=t),text:e.currentArrayString,onOnSave:e.handleSaveArray},null,8,["title","placeholder","visible","text","onOnSave"])):Ee("",!0)],8,Xa)}]]),lr=d({name:"BatchTranslate",components:{SubGuiItem:rr},props:{},setup(e,{emit:t}){const n=cn(),{handleSaveChanged:o,itemsRef:a,filePathArrFiltered:r}=Wa();return He(_e.I18N_BATCH_GUI_GET_SUBS,(e=>{e(a.value)})),{i18nMainStore:n,handleSaveChanged:o,itemsRef:a,filePathArrFiltered:r}}}),ir={class:"batch-translate"},sr={class:"vp-bg t-action-row"},dr={class:"font-code"},cr={class:"batch-translate-list-wrap"};const ur=Re(lr,[["render",function(e,t,n,o,a,r){const l=rr;return de(),ce("div",ir,[ue("div",sr,[ue("span",dr,ze(e.i18nMainStore.translatePath),1)]),ue("div",cr,[(de(!0),ce(je,null,qe(e.filePathArrFiltered,(t=>(de(),Be(l,{ref_for:!0,ref:"itemsRef",key:t.key,"dir-item":t,onSaveChanged:e.handleSaveChanged},null,8,["dir-item","onSaveChanged"])))),128))])])}],["__scopeId","data-v-12d5035d"]]),hr=d({name:"SubTextItem",components:{TranslateTreeItem:r,VueMonaco:Ge},props:{visible:{type:Boolean,default:!0},dirItem:{type:Object,required:!0},translatePath:{type:String,default:""}},emits:["saveChanged"],setup(e,{emit:t}){const{visible:n,dirItem:o}=Ae(e),a=cn(),{isLoading:r,currentItem:l,handleSaveFile:i,isLocalCreated:s,handleCreateFile:d,handleReload:c,subFilePathArr:u}=Ya(e),h=m(""),f=m(),v=S((()=>a.changedLabelMap[o.value.label])),p=e=>{a.changedLabelMap[o.value.label]=e};X(h,(()=>{p(!0)})),X(n,(e=>{e&&(re((()=>{var e;null==(e=f.value)||e.resize()})),setTimeout((()=>{f.value.getInstance().focus()}),100))}));const g=We((()=>{re((()=>{var e;null==(e=f.value)||e.resize()}))}),500,!0),y=()=>{h.value="",re((()=>{p(!1)}))};K((()=>{window.addEventListener("resize",g),re((()=>{g()}))})),Fe((()=>{y(),window.removeEventListener("resize",g)}));X(l,(async e=>{e?await(async()=>{const e=await l.value.entry.getFile(),t=await Le(e);h.value=t,await re((()=>{var e;p(!1),null==(e=f.value)||e.resize()}))})():y()}),{immediate:!0});return{isLoading:r,valueText:h,currentItem:l,vueMonacoRef:f,saveChange:async({isEmit:e=!1}={})=>{v.value&&(await i(h.value),p(!1),e&&t("saveChanged"))},isChanged:v,handleCreateFile:async()=>{await d()},subFilePathArr:u}}}),fr={class:"sub-text-editor"},vr={key:0,class:"mc-loading-container"},pr={class:"editor-action-row"},gr={class:"editor-content-wrap"},yr={key:0,class:"tip-not-exist"};const br=Re(hr,[["render",function(e,t,n,o,a,r){const l=ut,i=Ke,s=Ge;return ve((de(),ce("div",fr,[e.isLoading?(de(),ce("div",vr,[be(l,{size:"small"})])):Ee("",!0),ue("div",pr,[be(i,{size:"small",type:"primary",disabled:!e.isChanged,onClick:t[0]||(t[0]=t=>e.saveChange({isEmit:!0}))},{default:me((()=>[Ie(" Save All ")])),_:1},8,["disabled"]),Ie(" "+ze(e.subFilePathArr.join("/"))+" "+ze(e.dirItem.label),1)]),ue("div",gr,[e.currentItem?(de(),Be(s,{key:1,ref:"vueMonacoRef",modelValue:e.valueText,"onUpdate:modelValue":t[2]||(t[2]=t=>e.valueText=t),language:"json","show-line-numbers":""},null,8,["modelValue"])):(de(),ce("div",yr,[Ie(" File does not exist, please "),ue("b",{style:{"text-decoration":"underline",cursor:"pointer"},onClick:t[1]||(t[1]=(...t)=>e.handleCreateFile&&e.handleCreateFile(...t))}," create it "),Ie(" on your local file system ")]))])],512)),[[Ye,e.visible]])}],["__scopeId","data-v-dc62cded"]]),mr=d({name:"BatchText",components:{SubTextItem:br},props:{},setup(e,{emit:t}){const n=cn(),{handleSaveChanged:o,itemsRef:a,filePathArrFiltered:r}=Wa(),l=m("");return X(r,(e=>{if(!l.value)return void(l.value=e[0].key);e.find((e=>e.key===l.value))||(l.value=e[0].key)}),{immediate:!0}),{i18nMainStore:n,handleSaveChanged:o,itemsRef:a,filePathArrFiltered:r,currentTab:l}}}),kr={class:"batch-text-editor"},wr={class:"editor-tabs-wrap"},xr={class:"editor-wrap"};const Sr=Re(mr,[["render",function(e,t,n,o,a,r){const l=yt,i=bt,s=br;return de(),ce("div",kr,[ue("div",wr,[be(i,{size:"small",type:"card",animated:"",value:e.currentTab,"onUpdate:value":t[0]||(t[0]=t=>e.currentTab=t)},{default:me((()=>[(de(!0),ce(je,null,qe(e.filePathArrFiltered,(t=>(de(),Be(l,{style:{padding:"0"},name:t.key,tab:(e.i18nMainStore.changedLabelMap[t.label]?"* ":"")+t.label,key:t.key},null,8,["name","tab"])))),128))])),_:1},8,["value"])]),ue("div",xr,[(de(!0),ce(je,null,qe(e.filePathArrFiltered,(t=>(de(),Be(s,{ref_for:!0,ref:"itemsRef",key:t.key,"dir-item":t,visible:t.key===e.currentTab,onSaveChanged:e.handleSaveChanged},null,8,["dir-item","visible","onSaveChanged"])))),128))])])}],["__scopeId","data-v-ab2c01f3"]]),Cr=".translate-item",_r=()=>{const e=cn();return{handleKeyClick:(t,n)=>{e.translatePath=t;Array.from(document.querySelectorAll(Cr)).forEach((e=>{e.classList.remove("t_selected")})),n.target.closest(Cr).classList.add("t_selected")}}},Rr=(e={})=>({key:e.key,kind:e.kind,label:e.label,entry:e.entry,parentDirs:e.parentDirs,children:e.children||null,prefix:()=>c(rt,{size:18},{default:()=>c("directory"===e.kind?rn:nn)})});var Tr=(e=>(e.TEXT="text",e.GUI="gui",e.BATCH="batch",e))(Tr||{});const Pr=[{label:"TEXT",value:"text"},{label:"SINGLE",value:"gui"},{label:"BATCH",value:"batch"}],Fr=d({name:"VueI18nBatchTool",components:{GuiToolbox:fn,QuickOptions:ke,TabLayout:Je,BatchTextEditor:Sr,I18nToolSettings:l,TranslateTreeItem:r,BatchTranslate:ur,DropZone:ht},setup(){const{t:t}=fe(),n=Xe(),o=cn(),a=e(),r=m(!1),{appendHistory:l,historyMenuOptions:d}=i(Qe.I18N_FOLDER_HANDLE_HISTORY,(async e=>{h.value=e,await f()})),c=Ze("vue_i18n_dir_tool_expanded_keys",[]),u=async(e,t=0,n=[],o=[],r="")=>{for await(const i of e.values())if("directory"!==i.kind||(l=i.name,a.ignoreFoldersMap[l])){if(/\.json$/gi.test(i.name)){const e=`${r}${t}-${i.name}`;n.push(Rr({key:e,kind:i.kind,label:i.name,entry:i,parentDirs:o,children:null}))}}else{let e=[];const a=`${r}${t}-${i.name}`;n.push(Rr({key:a,kind:i.kind,label:i.name,entry:i,parentDirs:o,children:e})),await u(i,t+1,e,[...o,i.name],a+"_")}var l;return n.sort(((e,t)=>"directory"===e.kind&&"file"===t.kind?-1:"file"===e.kind&&"directory"===t.kind?1:0)),n},h=$e(),f=async()=>{try{r.value=!0;const e=h.value;let t=[];t=a.isFoldersMode?await u(e):await(async(e,t=[])=>{let n=0;for await(const o of e.values())if(n++,"directory"!==o.kind&&/\.json$/gi.test(o.name)){const e=`${n}-${o.kind}-${o.name}`;t.push(Rr({key:e,kind:o.kind,label:o.name,entry:o,parentDirs:[],children:null}))}return console.log("[readJsonFiles]",t),t})(e),t.length||window.$message.error("The content is empty, please check the folder directory structure!"),o.dirTree=t}catch(e){console.error(e),window.$message.error(e.message)}finally{r.value=!1}},v=m(null),p=m(null),g=async()=>{try{r.value=!0;const e=v.value;if(!e)return;const n=await e.createWritable();if("text"!==y.value&&(p.value=JSON.stringify(ot(b.value),null,2)),!p.value)throw new Error("editingTextValue is empty!");await n.write(p.value),await n.close(),await f(),window.$message.success(t("msgs.saved"))}catch(e){console.error(e),window.$message.error("Save Failed!"+e.message)}finally{r.value=!1}},y=Ze("vue_i18n_dir_tool_edit_mode","batch"),b=m([et()]),k=()=>{if("text"!==y.value){if(!p.value)return void(b.value=[]);const e=JSON.parse(p.value);b.value=at.parseWithRoot(e)}};X(y,(e=>{k()}));const{metaTitle:w}=ft();tt((()=>{v.value&&"gui"===y.value?g():Ce.emit(_e.I18N_SAVE_ALL_CHANGES)}));const x=m();nt((()=>!!h.value));const S=m(!1);return{metaTitle:w,i18nMainStore:o,iconTranslate:s,handlePickDir:async()=>{const e=await window.showDirectoryPicker();await l(e),h.value=e,await f()},handleCloseDir:()=>{h.value=void 0,v.value=null,p.value=null,o.dirTree=[],o.filePathArr=[]},dirHandle:h,reloadPickedDir:f,vueMonacoRef:x,nodeProps:({option:e})=>({async onClick(){try{if(r.value=!0,"file"===e.kind){const t=e.entry;v.value=t;const n=await Le(await t.getFile());p.value=n,o.filePathArr=[...e.parentDirs,e.label],o.translatePath="",k()}}catch(t){console.error(t),window.$message.error(t.message)}finally{r.value=!1}}}),editingTextValue:p,currentEditEntry:v,handleSaveFile:g,editMode:y,EditMode:Tr,editModeOptions:Pr,translateTreeRoot:b,...vt({cb:async e=>{try{r.value=!0;for(const t of e.dataTransfer.items)if("file"===t.kind){const e=await t.getAsFileSystemHandle();if("directory"===e.kind){await l(e),h.value=e,await f();break}window.$message.error("Please drag and drop a folder here!")}}catch(t){console.error(t),window.$message.error(t.message)}finally{r.value=!1}}}),i18nSetStore:a,mainStore:n,isShowToolSettings:S,isLoading:r,expandedKeys:c,historyMenuOptions:d,..._r()}}}),Ar={key:0,class:"mc-loading-container position-fixed"},Nr={class:"vp-bg navbar-wrap"},$r={class:"_container"},Lr={class:"main-edit-wrap"},Or={key:1,class:"edit-content-wrap batch-mode"},Dr={key:1,class:"null-intro"},Er={key:0,class:"intro-title"},Br={key:1,class:"font-code"},zr=["value"];const jr=Re(Fr,[["render",function(e,t,n,o,a,i){const s=ut,d=ht,c=gt,u=Ke,h=Je,f=Me,v=dt,p=Ue,g=pt,y=Zt,b=Et,m=Ot,k=De("BatchTextEditor"),w=fn,x=r,S=De("BatchTranslate"),C=ct,_=Ft,R=Pt,T=l;return de(),ce("div",{class:"vue-i18n-dir-tool i18n-style",onDragover:t[9]||(t[9]=lt(((...t)=>e.fileDragover&&e.fileDragover(...t)),["prevent","stop"])),onDragleave:t[10]||(t[10]=lt((t=>e.showDropzone=!1),["prevent","stop"])),onDrop:t[11]||(t[11]=lt(((...t)=>e.fileDrop&&e.fileDrop(...t)),["prevent","stop"]))},[be(we,{name:"mc-fade"},{default:me((()=>[e.isLoading?(de(),ce("div",Ar,[be(s)])):Ee("",!0)])),_:1}),be(we,{name:"mc-fade"},{default:me((()=>[ve(be(d,{"position-fixed":"",text:e.$t("msgs.drag_folder_here")},null,8,["text"]),[[Ye,e.showDropzone]])])),_:1}),ue("div",Nr,[be(g,{subtitle:"",onBack:t[5]||(t[5]=t=>e.$router.push({name:"HomePage"}))},{title:me((()=>[Ie(ze(e.metaTitle),1)])),avatar:me((()=>[be(c,{src:e.iconTranslate,style:{background:"none"}},null,8,["src"])])),extra:me((()=>[be(p,{align:"center"},{default:me((()=>[be(u,{secondary:"",size:"small",onClick:t[0]||(t[0]=t=>e.isShowToolSettings=!0)},{default:me((()=>[Ie(ze(e.$t("common.settings")),1)])),_:1}),be(u,{secondary:"",size:"small",onClick:t[1]||(t[1]=t=>e.mainStore.isShowQuickLaunch=!0)},{default:me((()=>[Ie(ze(e.$t("common.tools")),1)])),_:1}),e.currentEditEntry&&e.editMode===e.EditMode.GUI?(de(),Be(u,{key:0,size:"small",secondary:"",type:"primary",onClick:e.handleSaveFile},{default:me((()=>[Ie(ze(e.$t("actions.save_changes")),1)])),_:1},8,["onClick"])):Ee("",!0),Ie(" "+ze(e.$t("common.edit_mode"))+": ",1),be(h,{modelValue:e.editMode,"onUpdate:modelValue":t[2]||(t[2]=t=>e.editMode=t),horizontal:"","tab-list":e.editModeOptions},null,8,["modelValue","tab-list"]),e.dirHandle?(de(),Be(f,{key:1,onPositiveClick:t[3]||(t[3]=t=>e.handleCloseDir())},{trigger:me((()=>[be(u,{secondary:"",type:"primary",size:"small"},{default:me((()=>[Ie(ze(e.$t("actions.close"))+" Folder ",1)])),_:1})])),default:me((()=>[Ie(" "+ze(e.$t("msgs.confirm_close")),1)])),_:1})):(de(),Be(v,{key:2,size:"small",options:e.historyMenuOptions},{default:me((()=>[be(u,{type:"primary",size:"small",onClick:e.handlePickDir},{default:me((()=>[Ie(ze(e.$t("actions.pick_i18n_directory")),1)])),_:1},8,["onClick"])])),_:1},8,["options"])),e.dirHandle?(de(),Be(f,{key:3,onPositiveClick:t[4]||(t[4]=t=>e.reloadPickedDir())},{trigger:me((()=>[be(u,{secondary:"",size:"small",class:"js_reload_btn"},{default:me((()=>[Ie(ze(e.$t("actions.reload")),1)])),_:1})])),default:me((()=>[Ie(" "+ze(e.$t("msgs.confirm_reload_files")),1)])),_:1})):Ee("",!0)])),_:1})])),_:1})]),ue("div",$r,[be(R,{style:{height:"100%"},"has-sider":""},{default:me((()=>[be(m,{"collapse-mode":"width","collapsed-width":0,width:300,"show-trigger":"arrow-circle","content-style":"padding: 10px;",bordered:""},{default:me((()=>[be(b,{style:{height:"100%"}},{default:me((()=>[be(y,{"block-line":"",data:e.i18nMainStore.dirTree,"node-props":e.nodeProps,"default-expand-all":!1,"expand-on-click":"",selectable:"",class:"font-code","virtual-scroll":"","expanded-keys":e.expandedKeys,"onUpdate:expandedKeys":t[6]||(t[6]=t=>e.expandedKeys=t)},null,8,["data","node-props","expanded-keys"])])),_:1})])),_:1}),be(_,null,{default:me((()=>[ue("div",Lr,[e.currentEditEntry?(de(),ce(je,{key:0},[e.editMode===e.EditMode.TEXT?(de(),Be(k,{key:0})):(de(),ce("div",Or,[be(b,{class:"gui-edit-gui",style:it({width:e.editMode===e.EditMode.BATCH?"500px":"100%"})},{default:me((()=>[e.editMode===e.EditMode.BATCH?(de(),Be(w,{key:0})):Ee("",!0),(de(!0),ce(je,null,qe(e.translateTreeRoot,((t,n)=>(de(),Be(x,{key:n,index:n,item:t,"is-lite":e.editMode===e.EditMode.BATCH,title:e.i18nMainStore.filePathArr.join("/"),onOnKeyClick:e.handleKeyClick},null,8,["index","item","is-lite","title","onOnKeyClick"])))),128))])),_:1},8,["style"]),e.editMode===e.EditMode.BATCH?(de(),Be(b,{key:0,class:"gui-edit-batch"},{default:me((()=>[be(S)])),_:1})):Ee("",!0)]))],64)):(de(),ce("div",Dr,[e.i18nMainStore.dirTree.length?(de(),ce("div",Er," "+ze(e.$t("msgs.please_select_a_json")),1)):(de(),ce("div",Br,[be(p,{align:"center",class:"intro-title"},{default:me((()=>[be(C,{size:"large",value:e.i18nSetStore.isFoldersMode,"onUpdate:value":t[7]||(t[7]=t=>e.i18nSetStore.isFoldersMode=t)},{checked:me((()=>[Ie(ze(e.$t("common.folders_mode")),1)])),unchecked:me((()=>[Ie(ze(e.$t("common.files_mode")),1)])),_:1},8,["value"]),Ie("  "+ze(e.$t("msgs.recommended_i18n_fol"))+": ",1)])),_:1}),ue("textarea",{class:st(["font-code",{_alt:!e.i18nSetStore.isFoldersMode}]),readonly:"",cols:"50",rows:"20",value:e.i18nSetStore.isFoldersMode?`[locales]    --\x3e ${e.$t("msgs.drag_folder_here")}!\n   de-DE\n     index.json\n   en-US\n     index.json\n   es-ES\n     index.json\n   fr-FR\n     index.json\n   ja-JP\n     index.json\n   kr-KR\n     index.json\n   zh-CN\n     index.json\n   zh-TW\n      index.json`:`[locales]    --\x3e ${e.$t("msgs.drag_folder_here")}!\n    ar.json\n    cn.json\n    de.json\n    en.json\n    es.json\n    fr.json\n    it.json\n    jp.json\n    kr.json\n`},null,10,zr)]))]))])])),_:1})])),_:1})]),be(T,{visible:e.isShowToolSettings,"onUpdate:visible":t[8]||(t[8]=t=>e.isShowToolSettings=t)},null,8,["visible"])],32)}]]);export{jr as default};
