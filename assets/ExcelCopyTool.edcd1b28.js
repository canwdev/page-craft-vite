import{d as O,t as I,u as D,r as f,w as M,_ as F,o as E,c as R,a as p,b as x,e as i,f as B,g as z,h as T,s as J,i as U,j as X,k as V,l as W,m as L,F as A,n as K,p as b,q as H,v as P,x as q,y as G,z as Q,A as Y,B as Z}from"./index.541cda6f.js";import{_ as ee,a as oe}from"./PageHeader.33a2375e.js";const ne=O({name:"CopyExampleDialog",props:{visible:{type:Boolean,default:!1},title:{type:String,default:""},formatText:{type:Function,default:null}},setup(e,{emit:o}){const{formatText:l}=I(e),a=D(e,o,"visible"),c=f(""),m=f("");return M(c,()=>{m.value=l?l.value(c.value):c.value}),{mVisible:a,textInput:c,textOutput:m}}});const te={class:"style-tools"},se={class:"common-card"},le={class:"main-box font-code"};function ae(e,o,l,a,c,m){const s=B,u=z;return E(),R(u,{show:e.mVisible,"onUpdate:show":o[2]||(o[2]=_=>e.mVisible=_),preset:"dialog",title:e.title,style:{"min-width":"800px"}},{default:p(()=>[x("div",te,[x("div",se,[x("div",le,[i(s,{class:"input-text",type:"textarea",value:e.textInput,"onUpdate:value":o[0]||(o[0]=_=>e.textInput=_),placeholder:"Text Input"},null,8,["value"]),i(s,{class:"input-text",type:"textarea",value:e.textOutput,"onUpdate:value":o[1]||(o[1]=_=>e.textOutput=_),placeholder:"Text Output"},null,8,["value"])])])])]),_:1},8,["show","title"])}const j=F(ne,[["render",ae],["__scopeId","data-v-a84ab551"]]);let v=[];const ie=(e,o)=>{const l=document.getElementById(e),a=o||function(){};if(!l){const s=document.createElement("script");s.src=e,s.id=e,document.body.appendChild(s),v.push(a),("onload"in s?c:m)(s)}l&&a&&a(null,l);function c(s){s.onload=function(){this.onerror=this.onload=null;for(const u of v)u(null,s);v=[]},s.onerror=function(){this.onerror=this.onload=null,a(new Error("Failed to load "+e),s)}}function m(s){s.onreadystatechange=function(){if(!(this.readyState!=="complete"&&this.readyState!=="loaded")){this.onreadystatechange=null;for(const u of v)u(null,s);v=[]}}}},re=ie,ue=""+new URL("excel.59df11bd.svg",import.meta.url).href,w=(e,o)=>{if(o===y.text)return e;let l=e.split(`
`);if(l=l.map(a=>a.trim()),o===y.json)return l.length===1?JSON.stringify(l[0]):JSON.stringify(l,null,2);if(o===y.html)return l.join("<br>")},pe=e=>e.tagName.toLowerCase()==="td",y={none:"none",text:"text",html:"html",json:"json"},de=Object.values(y).map(e=>({label:e,value:e})),ce=O({name:"ExcelCopyTool",components:{FileChooser:T,CopyExampleDialog:j},setup(){const e=f(),o=f(),l=f(!1),a=J(),c=f([]),m=f(0);M(m,()=>{_()});const s=()=>{if(!l.value){const n="XLSX Not Ready!";throw window.$message.error(n),new Error(n)}},u=n=>(c.value=n.SheetNames,n.Sheets[c.value[m.value]]),_=()=>{const n=a.value;if(!n){o.value.innerHTML="";return}const d=window.XLSX.utils.sheet_to_html(u(n));o.value.innerHTML=d},C=async n=>{if(s(),!/\.xlsx$/g.test(n.name)){console.error("Only supports reading xlsx format!");return}const d=new FileReader;a.value=null,d.onload=function(r){const t=r.target.result;m.value=0,a.value=window.XLSX.read(t,{type:"binary"}),_()},d.readAsBinaryString(n)};U(()=>{re("//unpkg.com/xlsx@0.16.9/xlsx.mini.js",()=>{window.$message.success("XLSX Ready!"),console.log("XLSX ready",window.XLSX),l.value=!0})});const h=f(y.json),k=n=>{let d=n.target;if(!pe(d)||!h.value||h.value===y.none||!d.innerText)return;let r=d.innerText.trim().replace(/Â /gi," ");console.log(h.value);let t="";n.ctrlKey&&n.altKey?r=w(r,t=y.json):n.ctrlKey?r=w(r,t=y.text):n.altKey?r=w(r,t=y.html):r=w(r,t=h.value),X(r),window.$message.success(t+" copied!");const S=document.createRange();S.selectNode(d);const N=window.getSelection();N&&(N.removeAllRanges(),N.addRange(S))},g=()=>{if(!a.value){const n="Please open Excel file first!";throw window.$message.error(n),new Error(n)}return window.XLSX.utils.sheet_to_json(u(a.value))},$=f(!1);return{iconExcel:ue,sheetNames:c,sheetNameIndex:m,handleImport:C,importFileChooserRef:e,loadDemo(){s();const n=[["\u59D3\u540D","\u6027\u522B","\u5E74\u9F84","\u6CE8\u518C\u65F6\u95F4"],["\u5F20\u4E09","\u7537",18,new Date],["\u674E\u56DB","\u5973",22,new Date]],d=window.XLSX.utils.aoa_to_sheet(n),r=window.XLSX.utils.book_new();window.XLSX.utils.book_append_sheet(r,d,"Sheet1"),m.value=0,a.value=r,_()},tableWrapperRef:o,handleClick:k,copyMode:h,CopyModeOptions:de,dropdownMenuOptions:[{label:"Copy Sheet JSON",props:{onClick:async()=>{const n=g();X(JSON.stringify(n,null,2)),window.$message.success("Sheet JSON Copied!")}}},{label:"Export Sheet JSON",props:{onClick:async()=>{const n=g();V(W(null,"excel_sheet_export"),JSON.stringify(n,null,2),".json")}}}],isShowCopyExample:$,formatMultipleLine:w}}});const me={class:"excel-copy-tool"},_e=b(" ExcelCopyTool "),fe=b("CopyMode:"),ye=b(" Import Excel "),he=b("Export"),ge=b("Demo");function ve(e,o,l,a,c,m){const s=ee,u=H,_=P,C=q,h=G,k=oe,g=Q,$=Y,n=Z,d=T,r=j;return E(),L("div",me,[x("div",null,[i(g,{size:"small"},{default:p(()=>[i(k,{subtitle:"",onBack:o[3]||(o[3]=t=>e.$router.push({name:"HomeView"}))},{title:p(()=>[_e]),avatar:p(()=>[i(s,{src:e.iconExcel,style:{background:"none"}},null,8,["src"])]),extra:p(()=>[i(C,null,{default:p(()=>[i(C,{size:"small",align:"center"},{default:p(()=>[i(u,{text:"",onClick:o[0]||(o[0]=t=>e.isShowCopyExample=!0)},{default:p(()=>[fe]),_:1}),i(_,{size:"small",value:e.copyMode,"onUpdate:value":o[1]||(o[1]=t=>e.copyMode=t),options:e.CopyModeOptions,style:{width:"100px"}},null,8,["value","options"])]),_:1}),i(u,{type:"primary",onClick:o[2]||(o[2]=t=>e.importFileChooserRef.chooseFile()),size:"small"},{default:p(()=>[ye]),_:1}),i(h,{options:e.dropdownMenuOptions,placement:"bottom-start","key-field":"label"},{default:p(()=>[i(u,{size:"small"},{default:p(()=>[he]),_:1})]),_:1},8,["options"]),i(u,{onClick:e.loadDemo,size:"small"},{default:p(()=>[ge]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),i(g,{class:"sheet-name-card",size:"small"},{default:p(()=>[i(n,{size:"small",type:"card",animated:"",value:e.sheetNameIndex,"onUpdate:value":o[4]||(o[4]=t=>e.sheetNameIndex=t)},{default:p(()=>[(E(!0),L(A,null,K(e.sheetNames,(t,S)=>(E(),R($,{style:{padding:"0"},name:S,tab:t,key:t},null,8,["name","tab"]))),128))]),_:1},8,["value"])]),_:1})]),x("div",{ref:"tableWrapperRef",class:"excel-table-container",onClick:o[5]||(o[5]=(...t)=>e.handleClick&&e.handleClick(...t))},null,512),i(d,{ref:"importFileChooserRef",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",onSelected:e.handleImport},null,8,["onSelected"]),i(r,{visible:e.isShowCopyExample,"onUpdate:visible":o[6]||(o[6]=t=>e.isShowCopyExample=t),title:"Copy Mode Example: "+e.copyMode,"format-text":t=>e.formatMultipleLine(t,e.copyMode)},null,8,["visible","title","format-text"])])}const be=F(ce,[["render",ve],["__scopeId","data-v-d48e0052"]]);export{be as default};
