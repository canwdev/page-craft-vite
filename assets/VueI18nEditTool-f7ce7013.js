import{_ as V,i as N}from"./translate-b1aaed96.js";import{_ as F,d as b,u as H,a as O,b as B}from"./use-file-drop-a9c14ca7.js";import{d as I,j as _,k,n as w,u as P,a as A,r as E,L as h,s as J,b as M,c as W,o as U,M as L,N as x,O as D,i as Z,P as q,l as s,m as t,T as Q,F as G,A as K,q as y,t as X,v as Y,x as ee,y as d,z as u,B as S,Q as z,R as ne,S as te,E as oe,U as ae,H as se}from"./index-de16cf89.js";const ie={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},le=w("g",{fill:"none"},[w("path",{d:"M3 5a2 2 0 0 1 2-2h8.379a2 2 0 0 1 1.414.586l1.621 1.621A2 2 0 0 1 17 6.621V15a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5zm2-1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1v-4.5A1.5 1.5 0 0 1 6.5 10h7a1.5 1.5 0 0 1 1.5 1.5V16a1 1 0 0 0 1-1V6.621a1 1 0 0 0-.293-.707l-1.621-1.621A1 1 0 0 0 13.379 4H13v2.5A1.5 1.5 0 0 1 11.5 8h-4A1.5 1.5 0 0 1 6 6.5V4H5zm2 0v2.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5V4H7zm7 12v-4.5a.5.5 0 0 0-.5-.5h-7a.5.5 0 0 0-.5.5V16h8z",fill:"currentColor"})],-1),re=[le],ce=I({name:"Save20Regular",render:function(o,r){return _(),k("svg",ie,re)}}),C={types:[{description:"JSON",accept:{"application/JSON":[".json"]}}]},pe=I({name:"VueI18nEditTool",components:{TranslateTreeItem:V,DropZone:F,Save20Regular:ce},setup(){const{t:e}=P(),o=A(),r=E(h.parseWithRoot()),l=J(),f=async a=>{try{const n=await x(a),i=JSON.parse(n);r.value=h.parseWithRoot(i)}catch(n){console.error(n),window.$message.error(n.message)}},T=async()=>{const[a]=await window.showOpenFilePicker(C);l.value=a;const n=await a.getFile();f(n)},v=async()=>{if(!l.value)return;const a=await l.value.createWritable(),n=JSON.stringify(D(r.value),null,2);await a.write(n),await a.close(),window.$message.success(e("msgs.saved"))},g=async()=>{var m;console.log(r.value);const a=JSON.stringify(D(r.value),null,2),i=await(await window.showSaveFilePicker({suggestedName:(m=l.value)==null?void 0:m.name,...C})).createWritable();await i.write(a),await i.close(),window.$message.success(e("msgs.saved"))},{metaTitle:p}=M();return W(()=>{if(l.value){v();return}g()}),U(async()=>{console.log(import.meta),await b("./lib/pinyinjs/pinyin_dict_notone.min.js"),await b("./lib/pinyinjs/pinyinUtil.js")}),L(()=>!!l.value),{metaTitle:p,translateTreeRoot:r,fileHandle:l,handleImport:f,handleSelectFile:T,handleSaveFile:v,handleExport:g,loadDemo(){r.value=h.parseWithRoot({hello_world:{section_a:{test_str:"This is a test string",test_arr:["line 1","line 2","line 3"],test_number:114514},section_b:{"":"Blur this input and it'll generate the key automatically!"},section_c:{"":"中文 is Supported"}}})},iconTranslate:N,...H({cb:async a=>{for(const n of a.dataTransfer.items)if(n.kind==="file"){const i=await n.getAsFileSystemHandle();if(i.kind!=="directory"){l.value=i;const m=await i.getFile();await f(m)}else window.$message.error("Please drag and drop a json file here!")}}}),mainStore:o}}});const de=e=>(ne("data-v-36fcbe5f"),e=e(),te(),e),ue={class:"_container"},me=de(()=>w("div",{style:{height:"500px"}},null,-1));function _e(e,o,r,l,f,T){const v=F,g=O,p=oe,a=q("Save20Regular"),n=ae,i=se,m=B,R=X,j=V;return _(),k("div",{class:"vue-i18n-copy-tool",onDragover:o[2]||(o[2]=y((...c)=>e.fileDragover&&e.fileDragover(...c),["prevent","stop"])),onDragleave:o[3]||(o[3]=y(c=>e.showDropzone=!1,["prevent","stop"])),onDrop:o[4]||(o[4]=y((...c)=>e.fileDrop&&e.fileDrop(...c),["prevent","stop"]))},[s(Q,{name:"mc-fade"},{default:t(()=>[Y(s(v,{text:e.$t("msgs.drag_folder_here")},null,8,["text"]),[[ee,e.showDropzone]])]),_:1}),s(R,{size:"small",style:{position:"sticky",top:"0","z-index":"100","margin-bottom":"10px"}},{default:t(()=>[s(m,{subtitle:"",onBack:o[1]||(o[1]=c=>e.$router.push({name:"HomePage"}))},{title:t(()=>[d(u(e.metaTitle),1)]),avatar:t(()=>[s(g,{src:e.iconTranslate,style:{background:"none"}},null,8,["src"])]),extra:t(()=>[s(i,null,{default:t(()=>[s(p,{secondary:"",size:"small",onClick:o[0]||(o[0]=c=>e.mainStore.isShowTextTransformer=!0)},{default:t(()=>[d(u(e.$t("common.text_transformer")),1)]),_:1}),s(p,{type:"primary",onClick:e.handleSelectFile,size:"small"},{default:t(()=>[d(u(e.$t("actions.open_json")),1)]),_:1},8,["onClick"]),e.fileHandle?(_(),S(p,{key:0,onClick:e.handleSaveFile,size:"small",type:"info"},{icon:t(()=>[s(a)]),default:t(()=>[d(" "+u(e.$t("actions.save")),1)]),_:1},8,["onClick"])):z("",!0),s(p,{secondary:"",onClick:e.handleExport,size:"small"},{default:t(()=>[d(u(e.$t("actions.save_as"))+"...",1)]),_:1},8,["onClick"]),e.fileHandle?z("",!0):(_(),S(n,{key:1,onPositiveClick:e.loadDemo},{trigger:t(()=>[s(p,{tertiary:"",size:"small"},{default:t(()=>[d(u(e.$t("common.demo")),1)]),_:1})]),default:t(()=>[d(" "+u(e.$t("msgs.load_demo_this_will")),1)]),_:1},8,["onPositiveClick"]))]),_:1})]),_:1})]),_:1}),w("div",ue,[(_(!0),k(G,null,K(e.translateTreeRoot,(c,$)=>(_(),S(j,{key:$,item:c,index:$},null,8,["item","index"]))),128))]),me],32)}const we=Z(pe,[["render",_e],["__scopeId","data-v-36fcbe5f"]]);export{we as default};
