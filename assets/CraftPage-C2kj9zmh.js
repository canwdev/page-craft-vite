const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-Btt2M_SS.js","./index-B_8g2bxo.js","./index-CHk4c8gu.css","./index-DvO0znUF.js","./FileChooser-X9fYpU-s.js","./index-BWzdhM7Z.js","./index-CdL_N0M1.js","./set-CUTijDv3.js","./AdvancedNumberInput-CDufGYGU.js","./Popover-BKGBJvpF.js","./Icon-CMxllykI.js","./AdvancedNumberInput-Ccww2cHf.css","./VueRender.vue_vue_type_script_lang-B7jagunM.js","./index-B6cBd3b0.js","./use-model-wrapper-C3eqSSDB.js","./index-DnquJb5N.css","./Dropdown-CsBF2fzf.js","./Select-B9LExM5-.js","./Tag-DZeuv2Mx.js","./Checkbox-BMCJIerk.js","./index-fzqIU1hc.css","./use-beforeunload-CnEAWhnx.js","./humanfs-api-DpvoJ6Sz.js","./index-vcidOvW8.js","./index-Byyymg_I.js","./index-BbANPGKv.css","./ButtonGroup-BslXupHZ.js","./index-DKkJw2cG.css","./TabLayout-yNuUsb_S.js","./TabLayout-B_oFYdz1.css","./index-Bi2kEi3J.js","./index-R1nayJ36.css","./use-remote-options-BE_XYDkf.js","./Copy20Regular-sZkODe5h.js","./use-local-dir-D7_ExQWw.js","./file-history-B7sFIa91.js","./useIDBKeyval-CyjVMSV3.js","./Spin-DKTdphx2.js","./Popconfirm-B4HoFWuD.js","./index-BFbisPxq.css"])))=>i.map(i=>d[i]);
import{d as e,o as t,c as i,a as n,t as a,u as r,b as o,r as s,e as l,_ as h,n as c,f as d,g as u,h as f,w as p,i as m,j as v,k as g,l as w,F as b,m as y,p as _,q as k,s as x,v as C,G as S,x as E,y as z,z as O,T as I,A as D,B as T,C as A,D as B,E as R,H as M,I as L,J as P,K as N,L as F,M as U,N as W,O as j,P as H,Q as V,R as $,S as Z,U as Y,V as X,W as K,X as G,Y as q,Z as J,$ as Q,a0 as ee,a1 as te,a2 as ie,a3 as ne,a4 as ae,a5 as re,a6 as oe,a7 as se,a8 as le,a9 as he,aa as ce,ab as de,ac as ue,ad as fe,ae as pe}from"./index-B_8g2bxo.js";import{c as me,f as ve,s as ge,g as we,a as be}from"./index-BWzdhM7Z.js";import{u as ye}from"./use-model-wrapper-C3eqSSDB.js";import{N as _e}from"./Icon-CMxllykI.js";import{V as ke}from"./index-Byyymg_I.js";import{r as xe,f as Ce,u as Se,c as Ee,a as ze,b as Oe,d as Ie,e as De,g as Te,h as Ae,i as Be,j as Re,k as Me,M as Le}from"./index-DvO0znUF.js";import{T as Pe}from"./TabLayout-yNuUsb_S.js";import{u as Ne,a as Fe,b as Ue,_ as We,F as je,C as He,R as Ve,D as $e,c as Ze,A as Ye,S as Xe,d as Ke,e as Ge,f as qe,g as Je,h as Qe,i as et,j as tt,k as it}from"./use-local-dir-D7_ExQWw.js";import{n as nt,f as at,g as rt}from"./humanfs-api-DpvoJ6Sz.js";import{Q as ot}from"./index-Bi2kEi3J.js";import{C as st,a as lt}from"./Copy20Regular-sZkODe5h.js";import{_ as ht}from"./Spin-DKTdphx2.js";import{_ as ct}from"./Popover-BKGBJvpF.js";import{m as dt}from"./index-B6cBd3b0.js";import{_ as ut}from"./Popconfirm-B4HoFWuD.js";import{_ as ft}from"./Dropdown-CsBF2fzf.js";const pt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},mt=[n("g",{fill:"none"},[n("path",{d:"M11.75 3a.75.75 0 0 1 .743.648l.007.102l.001 7.25h7.253a.75.75 0 0 1 .102 1.493l-.102.007h-7.253l.002 7.25a.75.75 0 0 1-1.493.101l-.007-.102l-.002-7.249H3.752a.75.75 0 0 1-.102-1.493L3.752 11h7.25L11 3.75a.75.75 0 0 1 .75-.75z",fill:"currentColor"})],-1)],vt=e({name:"Add24Regular",render:function(e,n){return t(),i("svg",pt,mt)}}),gt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},wt=[n("g",{fill:"none"},[n("path",{d:"M5.854 2.646a.5.5 0 0 1 0 .708L4.207 5H11a6 6 0 1 1-6 6a.5.5 0 0 1 1 0a5 5 0 1 0 5-5H4.207l1.647 1.646a.5.5 0 1 1-.708.708l-2.5-2.5a.5.5 0 0 1 0-.708l2.5-2.5a.5.5 0 0 1 .708 0z",fill:"currentColor"})],-1)],bt=e({name:"ArrowReset20Regular",render:function(e,n){return t(),i("svg",gt,wt)}}),yt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},_t=[n("g",{fill:"none"},[n("path",{d:"M11.3 2.48a3.5 3.5 0 0 0-2.6 0L2.943 4.785A1.5 1.5 0 0 0 2 6.176v7.646a1.5 1.5 0 0 0 .943 1.393L8.7 17.518a3.5 3.5 0 0 0 2.6 0l5.757-2.303A1.5 1.5 0 0 0 18 13.822V6.176a1.5 1.5 0 0 0-.943-1.392L11.3 2.48zm-2.228.93a2.5 2.5 0 0 1 1.857 0l5.225 2.09l-2.279.91l-6.154-2.46l1.35-.54zM6.375 4.487l6.154 2.461L10 7.961L3.846 5.499l2.529-1.011zm4.125 4.35l6.5-2.6v7.584a.5.5 0 0 1-.314.465l-5.758 2.303c-.14.055-.283.098-.428.128v-7.88zm-1 0v7.88a2.508 2.508 0 0 1-.428-.128l-5.758-2.303A.5.5 0 0 1 3 13.822V6.238l6.5 2.6z",fill:"currentColor"})],-1)],kt=e({name:"Box20Regular",render:function(e,n){return t(),i("svg",yt,_t)}}),xt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Ct=[n("g",{fill:"none"},[n("path",{d:"M11.423 2.378a3 3 0 0 1 2.154 0l3.461 1.331c.58.223.962.78.962 1.4v7.78a1.5 1.5 0 0 1-.017.22a4.479 4.479 0 0 0-.983-2.44V5.11a.5.5 0 0 0-.321-.467l-3.461-1.331a2 2 0 0 0-1.436 0L8.32 4.642A.5.5 0 0 0 8 5.11v1.1a4.001 4.001 0 0 0-1 0v-1.1a1.5 1.5 0 0 1 .962-1.4l3.46-1.331zM12.6 9.089a1.498 1.498 0 0 0-.562-.38L8.577 7.378a3 3 0 0 0-2.154 0L2.962 8.709a1.5 1.5 0 0 0-.962 1.4v4.78a1.5 1.5 0 0 0 .962 1.4l3.46 1.331a3 3 0 0 0 2.155 0l1.944-.748a4.52 4.52 0 0 1-.712-.797l-1.591.612a2 2 0 0 1-1.436 0L3.32 15.356A.5.5 0 0 1 3 14.889v-4.78a.5.5 0 0 1 .32-.467l3.462-1.331a2 2 0 0 1 1.436 0l3.164 1.217a4.469 4.469 0 0 1 1.218-.439zm-1.903.89a.497.497 0 0 0-.252.027L7.5 11.14l-2.946-1.133a.5.5 0 1 0-.359.934L7 12.018v2.49a.5.5 0 0 0 1 0v-2.49l1.496-.576a4.519 4.519 0 0 1 1.201-1.464zm4.748-4.973a.5.5 0 1 1 .359.933l-2.766 1.064a1.5 1.5 0 0 1-1.077 0L9.195 5.94a.5.5 0 0 1 .36-.933L12.32 6.07a.5.5 0 0 0 .36 0l2.765-1.064zm.858 10.59a3.5 3.5 0 1 0-.707.707l2.55 2.55a.5.5 0 0 0 .708-.707l-2.55-2.55zM16 13.498a2.5 2.5 0 1 1-5 0a2.5 2.5 0 0 1 5 0z",fill:"currentColor"})],-1)],St=e({name:"BoxMultipleSearch20Regular",render:function(e,n){return t(),i("svg",xt,Ct)}}),Et={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},zt=[n("g",{fill:"none"},[n("path",{d:"M6.25 10a1.25 1.25 0 1 1-2.5 0a1.25 1.25 0 0 1 2.5 0zm5 0a1.25 1.25 0 1 1-2.5 0a1.25 1.25 0 0 1 2.5 0zM15 11.25a1.25 1.25 0 1 0 0-2.5a1.25 1.25 0 0 0 0 2.5z",fill:"currentColor"})],-1)],Ot=e({name:"MoreHorizontal20Regular",render:function(e,n){return t(),i("svg",Et,zt)}}),It={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},Dt=[n("g",{fill:"none"},[n("path",{d:"M4 1.002a.5.5 0 0 0-.5.5V8.5a2 2 0 0 0 2 2H6V13a1.999 1.999 0 1 0 3.998 0v-2.5h.502a2 2 0 0 0 2-2V1.502a.5.5 0 0 0-.5-.5H4zM11.5 7h-7V2.002h3v1.502a.5.5 0 1 0 1 0V2.002h1v2.496a.5.5 0 0 0 1 0V2.002h1V7zm-7 1.5V8h7v.5a1 1 0 0 1-1 1H9.498a.5.5 0 0 0-.5.5v3A.999.999 0 0 1 7 13v-3a.5.5 0 0 0-.5-.5h-1a1 1 0 0 1-1-1z",fill:"currentColor"})],-1)],Tt=e({name:"PaintBrush16Regular",render:function(e,n){return t(),i("svg",It,Dt)}}),At={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},Bt=[n("g",{fill:"none"},[n("path",{d:"M6 4.5V6H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h12.003a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2H14V4.5A1.5 1.5 0 0 0 12.5 3h-5A1.5 1.5 0 0 0 6 4.5zM7.5 4h5a.5.5 0 0 1 .5.5V6H7V4.5a.5.5 0 0 1 .5-.5zM4 7h12.003a1 1 0 0 1 1 1v2H14v-.5a.5.5 0 0 0-1 0v.5H7v-.5a.5.5 0 0 0-1 0v.5H3V8a1 1 0 0 1 1-1zm9 4v.5a.5.5 0 0 0 1 0V11h3.003v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-4h3v.5a.5.5 0 0 0 1 0V11h6z",fill:"currentColor"})],-1)],Rt=e({name:"Toolbox20Regular",render:function(e,n){return t(),i("svg",At,Bt)}}),Mt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},Lt=[n("g",{fill:"none"},[n("path",{d:"M4.5 2A2.5 2.5 0 0 0 2 4.5v7A2.5 2.5 0 0 0 4.5 14h7a2.5 2.5 0 0 0 2.5-2.5v-7A2.5 2.5 0 0 0 11.5 2h-7zM13 5H3v-.5A1.5 1.5 0 0 1 4.5 3h7A1.5 1.5 0 0 1 13 4.5V5zM3 6h10v5.5a1.5 1.5 0 0 1-1.5 1.5h-7A1.5 1.5 0 0 1 3 11.5V6z",fill:"currentColor"})],-1)],Pt=e({name:"Window16Regular",render:function(e,n){return t(),i("svg",Mt,Lt)}}),Nt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 16 16"},Ft=[n("g",{fill:"none"},[n("path",{d:"M2 4.499a2.5 2.5 0 0 1 2.5-2.5h7.002a2.5 2.5 0 0 1 2.5 2.5v1.76a5.508 5.508 0 0 0-1-.659V5h-10L3 11.501a1.5 1.5 0 0 0 1.5 1.5h1.1c.183.358.404.693.658 1H4.5a2.5 2.5 0 0 1-2.5-2.5V4.5zM4.5 3a1.5 1.5 0 0 0-1.414 1h9.83A1.5 1.5 0 0 0 11.5 3h-7zm6 12a4.5 4.5 0 1 0 0-9a4.5 4.5 0 0 0 0 9zm2.354-4.854a.5.5 0 0 1-.708.708L11 9.707V12.5a.5.5 0 0 1-1 0V9.707l-1.146 1.147a.5.5 0 0 1-.708-.708l2-2A.499.499 0 0 1 10.497 8h.006a.498.498 0 0 1 .348.144l.003.003l2 2z",fill:"currentColor"})],-1)],Ut=e({name:"WindowArrowUp16Regular",render:function(e,n){return t(),i("svg",Nt,Ft)}}),Wt=e({name:"ToolItem",props:{item:{type:Object,required:!0},active:{type:Boolean,default:!1}},emits:["onDrop","onDragStart"],setup(e,{emit:t}){const{item:i}=a(e),n=r(),h=o(),c=s(!1);return{mainStore:n,settingsStore:h,color:l((()=>i.value.title&&me.hex(i.value.title))),showDropzone:c,onDragover(e){c.value=!0},async onDrop(e){c.value=!1,t("onDrop",e)}}}}),jt=["title"],Ht=["src"],Vt={key:1,class:"item-text"};const $t=h(Wt,[["render",function(e,a,r,o,s,l){return t(),i("div",{class:f([{active:e.active,blink:e.showDropzone},"mc-tool-item _mini font-code vp-button"]),title:e.item.title,draggable:"true",onDragstart:a[0]||(a[0]=t=>e.$emit("onDragStart",t)),onDragover:a[1]||(a[1]=p(((...t)=>e.onDragover&&e.onDragover(...t)),["prevent","stop"])),onDragleave:a[2]||(a[2]=p((t=>e.showDropzone=!1),["prevent","stop"])),onDrop:a[3]||(a[3]=p(((...t)=>e.onDrop&&e.onDrop(...t)),["prevent","stop"]))},[n("div",{style:c({backgroundColor:e.color}),class:"mc-tool-item-bg"},null,4),e.item.icon?(t(),i("img",{key:0,src:e.item.icon,alt:"icon"},null,8,Ht)):e.item.title?(t(),i("span",Vt,d(e.item.title),1)):u("",!0)],42,jt)}],["__scopeId","data-v-062451f0"]]),Zt=e({name:"BlockItemCard",props:{item:{type:Object,required:!0}},setup(e){const{item:t}=a(e),i=r(),n=o(),s=l((()=>t.value.id===i.currentBlock.id)),h=l((()=>t.value.title&&me.hex(t.value.title)));return{mainStore:i,settingsStore:n,isActive:s,color:h,handleDragStart(e){e.dataTransfer.setData("data-block",JSON.stringify(t.value))}}}}),Yt=["title"],Xt=["src"],Kt={key:1,class:"item-text"},Gt={key:2,class:"item-subtext"};const qt=e({name:"InventoryList",components:{BlockItemCard:h(Zt,[["render",function(e,a,r,o,s,l){return t(),i("div",{class:f([{active:e.isActive},"mc-tool-item font-code vp-button"]),title:e.item.title,draggable:"true",onDragstart:a[0]||(a[0]=(...t)=>e.handleDragStart&&e.handleDragStart(...t))},[n("div",{style:c({backgroundColor:e.color}),class:"mc-tool-item-bg"},null,4),e.item.icon?(t(),i("img",{key:0,src:e.item.icon,alt:"icon"},null,8,Xt)):e.item.title?(t(),i("span",Kt,d(e.item.title),1)):u("",!0),e.item.icon&&e.item.title?(t(),i("span",Gt,d(e.item.title),1)):u("",!0)],42,Yt)}]]),BoxMultipleSearch20Regular:St},props:{itemList:{type:Array,default:()=>[]},showFilter:{type:Boolean,default:!0},largeCard:{type:Boolean,default:!1}},emits:["onItemClick","contextmenu"],setup(e){const{itemList:t}=a(e),i=s(""),n=l((()=>{const e=i.value.toLowerCase();return i.value?t.value.filter((t=>t.title.toLowerCase().includes(e))):t.value}));return{filterText:i,itemListFiltered:n}}}),Jt={class:"inventory-list-wrap"},Qt={key:0,class:"filter-row"},ei={key:1,style:{padding:"40px","text-align":"center","font-size":"20px"}};const ti=h(qt,[["render",function(e,n,a,r,o,s){const l=m("BoxMultipleSearch20Regular"),h=_e,c=k,p=m("BlockItemCard");return t(),i("div",Jt,[e.showFilter?(t(),i("div",Qt,[v(e.$slots,"filterStart",{},void 0,!0),g(c,{value:e.filterText,"onUpdate:value":n[0]||(n[0]=t=>e.filterText=t),clearable:"",placeholder:e.$t("msgs.filter_items"),size:"small"},{prefix:w((()=>[g(h,{size:"20"},{default:w((()=>[g(l)])),_:1})])),_:1},8,["value","placeholder"]),v(e.$slots,"filterEnd",{},void 0,!0)])):u("",!0),e.itemListFiltered.length?(t(),i("div",{key:2,class:f(["inventory-list _scrollbar_mini",{_big:!1}])},[(t(!0),i(b,null,y(e.itemListFiltered,(i=>(t(),_(p,{key:i.id,class:"list-item",item:i,onClick:t=>e.$emit("onItemClick",i)},null,8,["item","onClick"])))),128))])):(t(),i("div",ei,d(e.$t("msgs.no_items")),1)),v(e.$slots,"end",{},void 0,!0)])}],["__scopeId","data-v-ceb0e2e1"]]),ii={key:0,class:"pop-window-content"},ni=["src"],ai=h(e({__name:"PopFloat",setup(e){const n=s(),a=s(!1),r=s(null),o=s(0),h=s(0),d=s(0),f=s(0),p=s("");x((()=>{C.on(S.ON_COMP_HOVER,v),C.on(S.ON_COMP_HOVER_OUT,g),C.on(S.ON_COMP_HOVER_CLEAR,b)})),E((()=>{C.off(S.ON_COMP_HOVER,v),C.off(S.ON_COMP_HOVER_OUT,g),C.off(S.ON_COMP_HOVER_CLEAR,b)}));const m=()=>{setTimeout((()=>{n.value&&(d.value=n.value.offsetWidth,f.value=n.value.offsetHeight)}),100)};z(r,(e=>{p.value="",e&&e.meta.cover&&(p.value=e.meta.cover)}));const v=e=>{const{event:t,item:i}=e||{};r.value=i,o.value=t.clientX,h.value=t.clientY,a.value=!0},g=()=>{a.value=!1},b=()=>{r.value=null},y=l((()=>{let e=o.value+40,t=h.value+25;const i=window.innerWidth,n=window.innerHeight,a=i-(e+d.value);a<0&&(e+=a),e<o.value&&(e=o.value-d.value-10);const r=n-(t+f.value);return r<0&&(t+=r),t<h.value&&(t=h.value-f.value-10),{left:e+"px",top:t+"px"}}));return(e,o)=>(t(),_(I,{name:"mc-fade-scale"},{default:w((()=>[O(a)?(t(),i("div",{key:0,ref_key:"popWindowRef",ref:n,class:"pop-window vp-window",style:c(O(y))},[O(r)?(t(),i("div",ii,[O(p)?(t(),i("img",{key:0,src:O(p),alt:"cover",class:"preview-cover",onLoad:m},null,40,ni)):u("",!0)])):u("",!0)],4)):u("",!0)])),_:1}))}}),[["__scopeId","data-v-7e0c1f26"]]);
/*!
 * Cropper.js v1.6.1
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-09-17T03:44:19.860Z
 */
function ri(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function oi(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ri(Object(i),!0).forEach((function(t){hi(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ri(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function si(e){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function li(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ui(n.key),n)}}function hi(e,t,i){return(t=ui(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ci(e){return function(e){if(Array.isArray(e))return di(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return di(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return di(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function di(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function ui(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var fi="undefined"!=typeof window&&void 0!==window.document,pi=fi?window:{},mi=!(!fi||!pi.document.documentElement)&&"ontouchstart"in pi.document.documentElement,vi=!!fi&&"PointerEvent"in pi,gi="cropper",wi="all",bi="crop",yi="move",_i="zoom",ki="e",xi="w",Ci="s",Si="n",Ei="ne",zi="nw",Oi="se",Ii="sw",Di="".concat(gi,"-crop"),Ti="".concat(gi,"-disabled"),Ai="".concat(gi,"-hidden"),Bi="".concat(gi,"-hide"),Ri="".concat(gi,"-invisible"),Mi="".concat(gi,"-modal"),Li="".concat(gi,"-move"),Pi="".concat(gi,"Action"),Ni="".concat(gi,"Preview"),Fi="crop",Ui="move",Wi="none",ji="crop",Hi="cropend",Vi="cropmove",$i="cropstart",Zi="dblclick",Yi=vi?"pointerdown":mi?"touchstart":"mousedown",Xi=vi?"pointermove":mi?"touchmove":"mousemove",Ki=vi?"pointerup pointercancel":mi?"touchend touchcancel":"mouseup",Gi="ready",qi="resize",Ji="wheel",Qi="zoom",en="image/jpeg",tn=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,nn=/^data:/,an=/^data:image\/jpeg;base64,/,rn=/^img|canvas$/i,on={viewMode:0,dragMode:Fi,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},sn=Number.isNaN||pi.isNaN;function ln(e){return"number"==typeof e&&!sn(e)}var hn=function(e){return e>0&&e<1/0};function cn(e){return void 0===e}function dn(e){return"object"===si(e)&&null!==e}var un=Object.prototype.hasOwnProperty;function fn(e){if(!dn(e))return!1;try{var t=e.constructor,i=t.prototype;return t&&i&&un.call(i,"isPrototypeOf")}catch(n){return!1}}function pn(e){return"function"==typeof e}var mn=Array.prototype.slice;function vn(e){return Array.from?Array.from(e):mn.call(e)}function gn(e,t){return e&&pn(t)&&(Array.isArray(e)||ln(e.length)?vn(e).forEach((function(i,n){t.call(e,i,n,e)})):dn(e)&&Object.keys(e).forEach((function(i){t.call(e,e[i],i,e)}))),e}var wn=Object.assign||function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return dn(e)&&i.length>0&&i.forEach((function(t){dn(t)&&Object.keys(t).forEach((function(i){e[i]=t[i]}))})),e},bn=/\.\d*(?:0|9){12}\d*$/;function yn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return bn.test(e)?Math.round(e*t)/t:e}var _n=/^width|height|left|top|marginLeft|marginTop$/;function kn(e,t){var i=e.style;gn(t,(function(e,t){_n.test(t)&&ln(e)&&(e="".concat(e,"px")),i[t]=e}))}function xn(e,t){if(t)if(ln(e.length))gn(e,(function(e){xn(e,t)}));else if(e.classList)e.classList.add(t);else{var i=e.className.trim();i?i.indexOf(t)<0&&(e.className="".concat(i," ").concat(t)):e.className=t}}function Cn(e,t){t&&(ln(e.length)?gn(e,(function(e){Cn(e,t)})):e.classList?e.classList.remove(t):e.className.indexOf(t)>=0&&(e.className=e.className.replace(t,"")))}function Sn(e,t,i){t&&(ln(e.length)?gn(e,(function(e){Sn(e,t,i)})):i?xn(e,t):Cn(e,t))}var En=/([a-z\d])([A-Z])/g;function zn(e){return e.replace(En,"$1-$2").toLowerCase()}function On(e,t){return dn(e[t])?e[t]:e.dataset?e.dataset[t]:e.getAttribute("data-".concat(zn(t)))}function In(e,t,i){dn(i)?e[t]=i:e.dataset?e.dataset[t]=i:e.setAttribute("data-".concat(zn(t)),i)}var Dn=/\s\s*/,Tn=function(){var e=!1;if(fi){var t=!1,i=function(){},n=Object.defineProperty({},"once",{get:function(){return e=!0,t},set:function(e){t=e}});pi.addEventListener("test",i,n),pi.removeEventListener("test",i,n)}return e}();function An(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=i;t.trim().split(Dn).forEach((function(t){if(!Tn){var r=e.listeners;r&&r[t]&&r[t][i]&&(a=r[t][i],delete r[t][i],0===Object.keys(r[t]).length&&delete r[t],0===Object.keys(r).length&&delete e.listeners)}e.removeEventListener(t,a,n)}))}function Bn(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=i;t.trim().split(Dn).forEach((function(t){if(n.once&&!Tn){var r=e.listeners,o=void 0===r?{}:r;a=function(){delete o[t][i],e.removeEventListener(t,a,n);for(var r=arguments.length,s=new Array(r),l=0;l<r;l++)s[l]=arguments[l];i.apply(e,s)},o[t]||(o[t]={}),o[t][i]&&e.removeEventListener(t,o[t][i],n),o[t][i]=a,e.listeners=o}e.addEventListener(t,a,n)}))}function Rn(e,t,i){var n;return pn(Event)&&pn(CustomEvent)?n=new CustomEvent(t,{detail:i,bubbles:!0,cancelable:!0}):(n=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,i),e.dispatchEvent(n)}function Mn(e){var t=e.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}var Ln=pi.location,Pn=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Nn(e){var t=e.match(Pn);return null!==t&&(t[1]!==Ln.protocol||t[2]!==Ln.hostname||t[3]!==Ln.port)}function Fn(e){var t="timestamp=".concat((new Date).getTime());return e+(-1===e.indexOf("?")?"?":"&")+t}function Un(e){var t=e.rotate,i=e.scaleX,n=e.scaleY,a=e.translateX,r=e.translateY,o=[];ln(a)&&0!==a&&o.push("translateX(".concat(a,"px)")),ln(r)&&0!==r&&o.push("translateY(".concat(r,"px)")),ln(t)&&0!==t&&o.push("rotate(".concat(t,"deg)")),ln(i)&&1!==i&&o.push("scaleX(".concat(i,")")),ln(n)&&1!==n&&o.push("scaleY(".concat(n,")"));var s=o.length?o.join(" "):"none";return{WebkitTransform:s,msTransform:s,transform:s}}function Wn(e,t){var i=e.pageX,n=e.pageY,a={endX:i,endY:n};return t?a:oi({startX:i,startY:n},a)}function jn(e){var t=e.aspectRatio,i=e.height,n=e.width,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",r=hn(n),o=hn(i);if(r&&o){var s=i*t;"contain"===a&&s>n||"cover"===a&&s<n?i=n/t:n=i*t}else r?i=n/t:o&&(n=i*t);return{width:n,height:i}}var Hn=String.fromCharCode;var Vn=/^data:.*,/;function $n(e){var t,i=new DataView(e);try{var n,a,r;if(255===i.getUint8(0)&&216===i.getUint8(1))for(var o=i.byteLength,s=2;s+1<o;){if(255===i.getUint8(s)&&225===i.getUint8(s+1)){a=s;break}s+=1}if(a){var l=a+10;if("Exif"===function(e,t,i){var n="";i+=t;for(var a=t;a<i;a+=1)n+=Hn(e.getUint8(a));return n}(i,a+4,4)){var h=i.getUint16(l);if(((n=18761===h)||19789===h)&&42===i.getUint16(l+2,n)){var c=i.getUint32(l+4,n);c>=8&&(r=l+c)}}}if(r){var d,u,f=i.getUint16(r,n);for(u=0;u<f;u+=1)if(d=r+12*u+2,274===i.getUint16(d,n)){d+=8,t=i.getUint16(d,n),i.setUint16(d,1,n);break}}}catch(p){t=1}return t}var Zn={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,i=this.container,n=this.cropper,a=Number(t.minContainerWidth),r=Number(t.minContainerHeight);xn(n,Ai),Cn(e,Ai);var o={width:Math.max(i.offsetWidth,a>=0?a:200),height:Math.max(i.offsetHeight,r>=0?r:100)};this.containerData=o,kn(n,{width:o.width,height:o.height}),xn(e,Ai),Cn(n,Ai)},initCanvas:function(){var e=this.containerData,t=this.imageData,i=this.options.viewMode,n=Math.abs(t.rotate)%180==90,a=n?t.naturalHeight:t.naturalWidth,r=n?t.naturalWidth:t.naturalHeight,o=a/r,s=e.width,l=e.height;e.height*o>e.width?3===i?s=e.height*o:l=e.width/o:3===i?l=e.width/o:s=e.height*o;var h={aspectRatio:o,naturalWidth:a,naturalHeight:r,width:s,height:l};this.canvasData=h,this.limited=1===i||2===i,this.limitCanvas(!0,!0),h.width=Math.min(Math.max(h.width,h.minWidth),h.maxWidth),h.height=Math.min(Math.max(h.height,h.minHeight),h.maxHeight),h.left=(e.width-h.width)/2,h.top=(e.height-h.height)/2,h.oldLeft=h.left,h.oldTop=h.top,this.initialCanvasData=wn({},h)},limitCanvas:function(e,t){var i=this.options,n=this.containerData,a=this.canvasData,r=this.cropBoxData,o=i.viewMode,s=a.aspectRatio,l=this.cropped&&r;if(e){var h=Number(i.minCanvasWidth)||0,c=Number(i.minCanvasHeight)||0;o>1?(h=Math.max(h,n.width),c=Math.max(c,n.height),3===o&&(c*s>h?h=c*s:c=h/s)):o>0&&(h?h=Math.max(h,l?r.width:0):c?c=Math.max(c,l?r.height:0):l&&(h=r.width,(c=r.height)*s>h?h=c*s:c=h/s));var d=jn({aspectRatio:s,width:h,height:c});h=d.width,c=d.height,a.minWidth=h,a.minHeight=c,a.maxWidth=1/0,a.maxHeight=1/0}if(t)if(o>(l?0:1)){var u=n.width-a.width,f=n.height-a.height;a.minLeft=Math.min(0,u),a.minTop=Math.min(0,f),a.maxLeft=Math.max(0,u),a.maxTop=Math.max(0,f),l&&this.limited&&(a.minLeft=Math.min(r.left,r.left+(r.width-a.width)),a.minTop=Math.min(r.top,r.top+(r.height-a.height)),a.maxLeft=r.left,a.maxTop=r.top,2===o&&(a.width>=n.width&&(a.minLeft=Math.min(0,u),a.maxLeft=Math.max(0,u)),a.height>=n.height&&(a.minTop=Math.min(0,f),a.maxTop=Math.max(0,f))))}else a.minLeft=-a.width,a.minTop=-a.height,a.maxLeft=n.width,a.maxTop=n.height},renderCanvas:function(e,t){var i=this.canvasData,n=this.imageData;if(t){var a=function(e){var t=e.width,i=e.height,n=e.degree;if(90==(n=Math.abs(n)%180))return{width:i,height:t};var a=n%90*Math.PI/180,r=Math.sin(a),o=Math.cos(a),s=t*o+i*r,l=t*r+i*o;return n>90?{width:l,height:s}:{width:s,height:l}}({width:n.naturalWidth*Math.abs(n.scaleX||1),height:n.naturalHeight*Math.abs(n.scaleY||1),degree:n.rotate||0}),r=a.width,o=a.height,s=i.width*(r/i.naturalWidth),l=i.height*(o/i.naturalHeight);i.left-=(s-i.width)/2,i.top-=(l-i.height)/2,i.width=s,i.height=l,i.aspectRatio=r/o,i.naturalWidth=r,i.naturalHeight=o,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,kn(this.canvas,wn({width:i.width,height:i.height},Un({translateX:i.left,translateY:i.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,i=this.imageData,n=i.naturalWidth*(t.width/t.naturalWidth),a=i.naturalHeight*(t.height/t.naturalHeight);wn(i,{width:n,height:a,left:(t.width-n)/2,top:(t.height-a)/2}),kn(this.image,wn({width:i.width,height:i.height},Un(wn({translateX:i.left,translateY:i.top},i)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,i=e.aspectRatio||e.initialAspectRatio,n=Number(e.autoCropArea)||.8,a={width:t.width,height:t.height};i&&(t.height*i>t.width?a.height=a.width/i:a.width=a.height*i),this.cropBoxData=a,this.limitCropBox(!0,!0),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),a.width=Math.max(a.minWidth,a.width*n),a.height=Math.max(a.minHeight,a.height*n),a.left=t.left+(t.width-a.width)/2,a.top=t.top+(t.height-a.height)/2,a.oldLeft=a.left,a.oldTop=a.top,this.initialCropBoxData=wn({},a)},limitCropBox:function(e,t){var i=this.options,n=this.containerData,a=this.canvasData,r=this.cropBoxData,o=this.limited,s=i.aspectRatio;if(e){var l=Number(i.minCropBoxWidth)||0,h=Number(i.minCropBoxHeight)||0,c=o?Math.min(n.width,a.width,a.width+a.left,n.width-a.left):n.width,d=o?Math.min(n.height,a.height,a.height+a.top,n.height-a.top):n.height;l=Math.min(l,n.width),h=Math.min(h,n.height),s&&(l&&h?h*s>l?h=l/s:l=h*s:l?h=l/s:h&&(l=h*s),d*s>c?d=c/s:c=d*s),r.minWidth=Math.min(l,c),r.minHeight=Math.min(h,d),r.maxWidth=c,r.maxHeight=d}t&&(o?(r.minLeft=Math.max(0,a.left),r.minTop=Math.max(0,a.top),r.maxLeft=Math.min(n.width,a.left+a.width)-r.width,r.maxTop=Math.min(n.height,a.top+a.height)-r.height):(r.minLeft=0,r.minTop=0,r.maxLeft=n.width-r.width,r.maxTop=n.height-r.height))},renderCropBox:function(){var e=this.options,t=this.containerData,i=this.cropBoxData;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,e.movable&&e.cropBoxMovable&&In(this.face,Pi,i.width>=t.width&&i.height>=t.height?yi:wi),kn(this.cropBox,wn({width:i.width,height:i.height},Un({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Rn(this.element,ji,this.getData())}},Yn={initPreview:function(){var e=this.element,t=this.crossOrigin,i=this.options.preview,n=t?this.crossOriginUrl:this.url,a=e.alt||"The image to preview",r=document.createElement("img");if(t&&(r.crossOrigin=t),r.src=n,r.alt=a,this.viewBox.appendChild(r),this.viewBoxImage=r,i){var o=i;"string"==typeof i?o=e.ownerDocument.querySelectorAll(i):i.querySelector&&(o=[i]),this.previews=o,gn(o,(function(e){var i=document.createElement("img");In(e,Ni,{width:e.offsetWidth,height:e.offsetHeight,html:e.innerHTML}),t&&(i.crossOrigin=t),i.src=n,i.alt=a,i.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',e.innerHTML="",e.appendChild(i)}))}},resetPreview:function(){gn(this.previews,(function(e){var t=On(e,Ni);kn(e,{width:t.width,height:t.height}),e.innerHTML=t.html,function(e,t){if(dn(e[t]))try{delete e[t]}catch(i){e[t]=void 0}else if(e.dataset)try{delete e.dataset[t]}catch(i){e.dataset[t]=void 0}else e.removeAttribute("data-".concat(zn(t)))}(e,Ni)}))},preview:function(){var e=this.imageData,t=this.canvasData,i=this.cropBoxData,n=i.width,a=i.height,r=e.width,o=e.height,s=i.left-t.left-e.left,l=i.top-t.top-e.top;this.cropped&&!this.disabled&&(kn(this.viewBoxImage,wn({width:r,height:o},Un(wn({translateX:-s,translateY:-l},e)))),gn(this.previews,(function(t){var i=On(t,Ni),h=i.width,c=i.height,d=h,u=c,f=1;n&&(u=a*(f=h/n)),a&&u>c&&(d=n*(f=c/a),u=c),kn(t,{width:d,height:u}),kn(t.getElementsByTagName("img")[0],wn({width:r*f,height:o*f},Un(wn({translateX:-s*f,translateY:-l*f},e))))})))}},Xn={bind:function(){var e=this.element,t=this.options,i=this.cropper;pn(t.cropstart)&&Bn(e,$i,t.cropstart),pn(t.cropmove)&&Bn(e,Vi,t.cropmove),pn(t.cropend)&&Bn(e,Hi,t.cropend),pn(t.crop)&&Bn(e,ji,t.crop),pn(t.zoom)&&Bn(e,Qi,t.zoom),Bn(i,Yi,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&Bn(i,Ji,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&Bn(i,Zi,this.onDblclick=this.dblclick.bind(this)),Bn(e.ownerDocument,Xi,this.onCropMove=this.cropMove.bind(this)),Bn(e.ownerDocument,Ki,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&Bn(window,qi,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,i=this.cropper;pn(t.cropstart)&&An(e,$i,t.cropstart),pn(t.cropmove)&&An(e,Vi,t.cropmove),pn(t.cropend)&&An(e,Hi,t.cropend),pn(t.crop)&&An(e,ji,t.crop),pn(t.zoom)&&An(e,Qi,t.zoom),An(i,Yi,this.onCropStart),t.zoomable&&t.zoomOnWheel&&An(i,Ji,this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&An(i,Zi,this.onDblclick),An(e.ownerDocument,Xi,this.onCropMove),An(e.ownerDocument,Ki,this.onCropEnd),t.responsive&&An(window,qi,this.onResize)}},Kn={resize:function(){if(!this.disabled){var e,t,i=this.options,n=this.container,a=this.containerData,r=n.offsetWidth/a.width,o=n.offsetHeight/a.height,s=Math.abs(r-1)>Math.abs(o-1)?r:o;if(1!==s)i.restore&&(e=this.getCanvasData(),t=this.getCropBoxData()),this.render(),i.restore&&(this.setCanvasData(gn(e,(function(t,i){e[i]=t*s}))),this.setCropBoxData(gn(t,(function(e,i){t[i]=e*s}))))}},dblclick:function(){var e,t;this.disabled||this.options.dragMode===Wi||this.setDragMode((e=this.dragBox,t=Di,(e.classList?e.classList.contains(t):e.className.indexOf(t)>-1)?Ui:Fi))},wheel:function(e){var t=this,i=Number(this.options.wheelZoomRatio)||.1,n=1;this.disabled||(e.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout((function(){t.wheeling=!1}),50),e.deltaY?n=e.deltaY>0?1:-1:e.wheelDelta?n=-e.wheelDelta/120:e.detail&&(n=e.detail>0?1:-1),this.zoom(-n*i,e)))},cropStart:function(e){var t=e.buttons,i=e.button;if(!(this.disabled||("mousedown"===e.type||"pointerdown"===e.type&&"mouse"===e.pointerType)&&(ln(t)&&1!==t||ln(i)&&0!==i||e.ctrlKey))){var n,a=this.options,r=this.pointers;e.changedTouches?gn(e.changedTouches,(function(e){r[e.identifier]=Wn(e)})):r[e.pointerId||0]=Wn(e),n=Object.keys(r).length>1&&a.zoomable&&a.zoomOnTouch?_i:On(e.target,Pi),tn.test(n)&&!1!==Rn(this.element,$i,{originalEvent:e,action:n})&&(e.preventDefault(),this.action=n,this.cropping=!1,n===bi&&(this.cropping=!0,xn(this.dragBox,Mi)))}},cropMove:function(e){var t=this.action;if(!this.disabled&&t){var i=this.pointers;e.preventDefault(),!1!==Rn(this.element,Vi,{originalEvent:e,action:t})&&(e.changedTouches?gn(e.changedTouches,(function(e){wn(i[e.identifier]||{},Wn(e,!0))})):wn(i[e.pointerId||0]||{},Wn(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,i=this.pointers;e.changedTouches?gn(e.changedTouches,(function(e){delete i[e.identifier]})):delete i[e.pointerId||0],t&&(e.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,Sn(this.dragBox,Mi,this.cropped&&this.options.modal)),Rn(this.element,Hi,{originalEvent:e,action:t}))}}},Gn={change:function(e){var t,i=this.options,n=this.canvasData,a=this.containerData,r=this.cropBoxData,o=this.pointers,s=this.action,l=i.aspectRatio,h=r.left,c=r.top,d=r.width,u=r.height,f=h+d,p=c+u,m=0,v=0,g=a.width,w=a.height,b=!0;!l&&e.shiftKey&&(l=d&&u?d/u:1),this.limited&&(m=r.minLeft,v=r.minTop,g=m+Math.min(a.width,n.width,n.left+n.width),w=v+Math.min(a.height,n.height,n.top+n.height));var y=o[Object.keys(o)[0]],_={x:y.endX-y.startX,y:y.endY-y.startY},k=function(e){switch(e){case ki:f+_.x>g&&(_.x=g-f);break;case xi:h+_.x<m&&(_.x=m-h);break;case Si:c+_.y<v&&(_.y=v-c);break;case Ci:p+_.y>w&&(_.y=w-p)}};switch(s){case wi:h+=_.x,c+=_.y;break;case ki:if(_.x>=0&&(f>=g||l&&(c<=v||p>=w))){b=!1;break}k(ki),(d+=_.x)<0&&(s=xi,h-=d=-d),l&&(u=d/l,c+=(r.height-u)/2);break;case Si:if(_.y<=0&&(c<=v||l&&(h<=m||f>=g))){b=!1;break}k(Si),u-=_.y,c+=_.y,u<0&&(s=Ci,c-=u=-u),l&&(d=u*l,h+=(r.width-d)/2);break;case xi:if(_.x<=0&&(h<=m||l&&(c<=v||p>=w))){b=!1;break}k(xi),d-=_.x,h+=_.x,d<0&&(s=ki,h-=d=-d),l&&(u=d/l,c+=(r.height-u)/2);break;case Ci:if(_.y>=0&&(p>=w||l&&(h<=m||f>=g))){b=!1;break}k(Ci),(u+=_.y)<0&&(s=Si,c-=u=-u),l&&(d=u*l,h+=(r.width-d)/2);break;case Ei:if(l){if(_.y<=0&&(c<=v||f>=g)){b=!1;break}k(Si),u-=_.y,c+=_.y,d=u*l}else k(Si),k(ki),_.x>=0?f<g?d+=_.x:_.y<=0&&c<=v&&(b=!1):d+=_.x,_.y<=0?c>v&&(u-=_.y,c+=_.y):(u-=_.y,c+=_.y);d<0&&u<0?(s=Ii,c-=u=-u,h-=d=-d):d<0?(s=zi,h-=d=-d):u<0&&(s=Oi,c-=u=-u);break;case zi:if(l){if(_.y<=0&&(c<=v||h<=m)){b=!1;break}k(Si),u-=_.y,c+=_.y,d=u*l,h+=r.width-d}else k(Si),k(xi),_.x<=0?h>m?(d-=_.x,h+=_.x):_.y<=0&&c<=v&&(b=!1):(d-=_.x,h+=_.x),_.y<=0?c>v&&(u-=_.y,c+=_.y):(u-=_.y,c+=_.y);d<0&&u<0?(s=Oi,c-=u=-u,h-=d=-d):d<0?(s=Ei,h-=d=-d):u<0&&(s=Ii,c-=u=-u);break;case Ii:if(l){if(_.x<=0&&(h<=m||p>=w)){b=!1;break}k(xi),d-=_.x,h+=_.x,u=d/l}else k(Ci),k(xi),_.x<=0?h>m?(d-=_.x,h+=_.x):_.y>=0&&p>=w&&(b=!1):(d-=_.x,h+=_.x),_.y>=0?p<w&&(u+=_.y):u+=_.y;d<0&&u<0?(s=Ei,c-=u=-u,h-=d=-d):d<0?(s=Oi,h-=d=-d):u<0&&(s=zi,c-=u=-u);break;case Oi:if(l){if(_.x>=0&&(f>=g||p>=w)){b=!1;break}k(ki),u=(d+=_.x)/l}else k(Ci),k(ki),_.x>=0?f<g?d+=_.x:_.y>=0&&p>=w&&(b=!1):d+=_.x,_.y>=0?p<w&&(u+=_.y):u+=_.y;d<0&&u<0?(s=zi,c-=u=-u,h-=d=-d):d<0?(s=Ii,h-=d=-d):u<0&&(s=Ei,c-=u=-u);break;case yi:this.move(_.x,_.y),b=!1;break;case _i:this.zoom(function(e){var t=oi({},e),i=0;return gn(e,(function(e,n){delete t[n],gn(t,(function(t){var n=Math.abs(e.startX-t.startX),a=Math.abs(e.startY-t.startY),r=Math.abs(e.endX-t.endX),o=Math.abs(e.endY-t.endY),s=Math.sqrt(n*n+a*a),l=(Math.sqrt(r*r+o*o)-s)/s;Math.abs(l)>Math.abs(i)&&(i=l)}))})),i}(o),e),b=!1;break;case bi:if(!_.x||!_.y){b=!1;break}t=Mn(this.cropper),h=y.startX-t.left,c=y.startY-t.top,d=r.minWidth,u=r.minHeight,_.x>0?s=_.y>0?Oi:Ei:_.x<0&&(h-=d,s=_.y>0?Ii:zi),_.y<0&&(c-=u),this.cropped||(Cn(this.cropBox,Ai),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}b&&(r.width=d,r.height=u,r.left=h,r.top=c,this.action=s,this.renderCropBox()),gn(o,(function(e){e.startX=e.endX,e.startY=e.endY}))}},qn={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&xn(this.dragBox,Mi),Cn(this.cropBox,Ai),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=wn({},this.initialImageData),this.canvasData=wn({},this.initialCanvasData),this.cropBoxData=wn({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(wn(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),Cn(this.dragBox,Mi),xn(this.cropBox,Ai)),this},replace:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,gn(this.previews,(function(t){t.getElementsByTagName("img")[0].src=e})))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,Cn(this.cropper,Ti)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,xn(this.cropper,Ti)),this},destroy:function(){var e=this.element;return e[gi]?(e[gi]=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.canvasData,n=i.left,a=i.top;return this.moveTo(cn(e)?e:n+Number(e),cn(t)?t:a+Number(t))},moveTo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.canvasData,n=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(ln(e)&&(i.left=e,n=!0),ln(t)&&(i.top=t,n=!0),n&&this.renderCanvas(!0)),this},zoom:function(e,t){var i=this.canvasData;return e=(e=Number(e))<0?1/(1-e):1+e,this.zoomTo(i.width*e/i.naturalWidth,null,t)},zoomTo:function(e,t,i){var n=this.options,a=this.canvasData,r=a.width,o=a.height,s=a.naturalWidth,l=a.naturalHeight;if((e=Number(e))>=0&&this.ready&&!this.disabled&&n.zoomable){var h=s*e,c=l*e;if(!1===Rn(this.element,Qi,{ratio:e,oldRatio:r/s,originalEvent:i}))return this;if(i){var d=this.pointers,u=Mn(this.cropper),f=d&&Object.keys(d).length?function(e){var t=0,i=0,n=0;return gn(e,(function(e){var a=e.startX,r=e.startY;t+=a,i+=r,n+=1})),{pageX:t/=n,pageY:i/=n}}(d):{pageX:i.pageX,pageY:i.pageY};a.left-=(h-r)*((f.pageX-u.left-a.left)/r),a.top-=(c-o)*((f.pageY-u.top-a.top)/o)}else fn(t)&&ln(t.x)&&ln(t.y)?(a.left-=(h-r)*((t.x-a.left)/r),a.top-=(c-o)*((t.y-a.top)/o)):(a.left-=(h-r)/2,a.top-=(c-o)/2);a.width=h,a.height=c,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return ln(e=Number(e))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,ln(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(ln(t)?t:1,e)},scale:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=this.imageData,n=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(ln(e)&&(i.scaleX=e,n=!0),ln(t)&&(i.scaleY=t,n=!0),n&&this.renderCanvas(!0,!0)),this},getData:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.options,n=this.imageData,a=this.canvasData,r=this.cropBoxData;if(this.ready&&this.cropped){e={x:r.left-a.left,y:r.top-a.top,width:r.width,height:r.height};var o=n.width/n.naturalWidth;if(gn(e,(function(t,i){e[i]=t/o})),t){var s=Math.round(e.y+e.height),l=Math.round(e.x+e.width);e.x=Math.round(e.x),e.y=Math.round(e.y),e.width=l-e.x,e.height=s-e.y}}else e={x:0,y:0,width:0,height:0};return i.rotatable&&(e.rotate=n.rotate||0),i.scalable&&(e.scaleX=n.scaleX||1,e.scaleY=n.scaleY||1),e},setData:function(e){var t=this.options,i=this.imageData,n=this.canvasData,a={};if(this.ready&&!this.disabled&&fn(e)){var r=!1;t.rotatable&&ln(e.rotate)&&e.rotate!==i.rotate&&(i.rotate=e.rotate,r=!0),t.scalable&&(ln(e.scaleX)&&e.scaleX!==i.scaleX&&(i.scaleX=e.scaleX,r=!0),ln(e.scaleY)&&e.scaleY!==i.scaleY&&(i.scaleY=e.scaleY,r=!0)),r&&this.renderCanvas(!0,!0);var o=i.width/i.naturalWidth;ln(e.x)&&(a.left=e.x*o+n.left),ln(e.y)&&(a.top=e.y*o+n.top),ln(e.width)&&(a.width=e.width*o),ln(e.height)&&(a.height=e.height*o),this.setCropBoxData(a)}return this},getContainerData:function(){return this.ready?wn({},this.containerData):{}},getImageData:function(){return this.sized?wn({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&gn(["left","top","width","height","naturalWidth","naturalHeight"],(function(i){t[i]=e[i]})),t},setCanvasData:function(e){var t=this.canvasData,i=t.aspectRatio;return this.ready&&!this.disabled&&fn(e)&&(ln(e.left)&&(t.left=e.left),ln(e.top)&&(t.top=e.top),ln(e.width)?(t.width=e.width,t.height=e.width/i):ln(e.height)&&(t.height=e.height,t.width=e.height*i),this.renderCanvas(!0)),this},getCropBoxData:function(){var e,t=this.cropBoxData;return this.ready&&this.cropped&&(e={left:t.left,top:t.top,width:t.width,height:t.height}),e||{}},setCropBoxData:function(e){var t,i,n=this.cropBoxData,a=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&fn(e)&&(ln(e.left)&&(n.left=e.left),ln(e.top)&&(n.top=e.top),ln(e.width)&&e.width!==n.width&&(t=!0,n.width=e.width),ln(e.height)&&e.height!==n.height&&(i=!0,n.height=e.height),a&&(t?n.height=n.width/a:i&&(n.width=n.height*a)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t=this.canvasData,i=function(e,t,i,n){var a=t.aspectRatio,r=t.naturalWidth,o=t.naturalHeight,s=t.rotate,l=void 0===s?0:s,h=t.scaleX,c=void 0===h?1:h,d=t.scaleY,u=void 0===d?1:d,f=i.aspectRatio,p=i.naturalWidth,m=i.naturalHeight,v=n.fillColor,g=void 0===v?"transparent":v,w=n.imageSmoothingEnabled,b=void 0===w||w,y=n.imageSmoothingQuality,_=void 0===y?"low":y,k=n.maxWidth,x=void 0===k?1/0:k,C=n.maxHeight,S=void 0===C?1/0:C,E=n.minWidth,z=void 0===E?0:E,O=n.minHeight,I=void 0===O?0:O,D=document.createElement("canvas"),T=D.getContext("2d"),A=jn({aspectRatio:f,width:x,height:S}),B=jn({aspectRatio:f,width:z,height:I},"cover"),R=Math.min(A.width,Math.max(B.width,p)),M=Math.min(A.height,Math.max(B.height,m)),L=jn({aspectRatio:a,width:x,height:S}),P=jn({aspectRatio:a,width:z,height:I},"cover"),N=Math.min(L.width,Math.max(P.width,r)),F=Math.min(L.height,Math.max(P.height,o)),U=[-N/2,-F/2,N,F];return D.width=yn(R),D.height=yn(M),T.fillStyle=g,T.fillRect(0,0,R,M),T.save(),T.translate(R/2,M/2),T.rotate(l*Math.PI/180),T.scale(c,u),T.imageSmoothingEnabled=b,T.imageSmoothingQuality=_,T.drawImage.apply(T,[e].concat(ci(U.map((function(e){return Math.floor(yn(e))}))))),T.restore(),D}(this.image,this.imageData,t,e);if(!this.cropped)return i;var n=this.getData(e.rounded),a=n.x,r=n.y,o=n.width,s=n.height,l=i.width/Math.floor(t.naturalWidth);1!==l&&(a*=l,r*=l,o*=l,s*=l);var h=o/s,c=jn({aspectRatio:h,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),d=jn({aspectRatio:h,width:e.minWidth||0,height:e.minHeight||0},"cover"),u=jn({aspectRatio:h,width:e.width||(1!==l?i.width:o),height:e.height||(1!==l?i.height:s)}),f=u.width,p=u.height;f=Math.min(c.width,Math.max(d.width,f)),p=Math.min(c.height,Math.max(d.height,p));var m=document.createElement("canvas"),v=m.getContext("2d");m.width=yn(f),m.height=yn(p),v.fillStyle=e.fillColor||"transparent",v.fillRect(0,0,f,p);var g=e.imageSmoothingEnabled,w=void 0===g||g,b=e.imageSmoothingQuality;v.imageSmoothingEnabled=w,b&&(v.imageSmoothingQuality=b);var y,_,k,x,C,S,E=i.width,z=i.height,O=a,I=r;O<=-o||O>E?(O=0,y=0,k=0,C=0):O<=0?(k=-O,O=0,C=y=Math.min(E,o+O)):O<=E&&(k=0,C=y=Math.min(o,E-O)),y<=0||I<=-s||I>z?(I=0,_=0,x=0,S=0):I<=0?(x=-I,I=0,S=_=Math.min(z,s+I)):I<=z&&(x=0,S=_=Math.min(s,z-I));var D=[O,I,y,_];if(C>0&&S>0){var T=f/o;D.push(k*T,x*T,C*T,S*T)}return v.drawImage.apply(v,[i].concat(ci(D.map((function(e){return Math.floor(yn(e))}))))),m},setAspectRatio:function(e){var t=this.options;return this.disabled||cn(e)||(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,i=this.dragBox,n=this.face;if(this.ready&&!this.disabled){var a=e===Fi,r=t.movable&&e===Ui;e=a||r?e:Wi,t.dragMode=e,In(i,Pi,e),Sn(i,Di,a),Sn(i,Li,r),t.cropBoxMovable||(In(n,Pi,e),Sn(n,Di,a),Sn(n,Li,r))}return this}},Jn=pi.Cropper,Qn=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t||!rn.test(t.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=t,this.options=wn({},on,fn(i)&&i),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}var t,i,n;return t=e,n=[{key:"noConflict",value:function(){return window.Cropper=Jn,e}},{key:"setDefaults",value:function(e){wn(on,fn(e)&&e)}}],(i=[{key:"init",value:function(){var e,t=this.element,i=t.tagName.toLowerCase();if(!t[gi]){if(t[gi]=this,"img"===i){if(this.isImg=!0,e=t.getAttribute("src")||"",this.originalUrl=e,!e)return;e=t.src}else"canvas"===i&&window.HTMLCanvasElement&&(e=t.toDataURL());this.load(e)}}},{key:"load",value:function(e){var t=this;if(e){this.url=e,this.imageData={};var i=this.element,n=this.options;if(n.rotatable||n.scalable||(n.checkOrientation=!1),n.checkOrientation&&window.ArrayBuffer)if(nn.test(e))an.test(e)?this.read((a=e.replace(Vn,""),r=atob(a),o=new ArrayBuffer(r.length),gn(s=new Uint8Array(o),(function(e,t){s[t]=r.charCodeAt(t)})),o)):this.clone();else{var a,r,o,s,l=new XMLHttpRequest,h=this.clone.bind(this);this.reloading=!0,this.xhr=l,l.onabort=h,l.onerror=h,l.ontimeout=h,l.onprogress=function(){l.getResponseHeader("content-type")!==en&&l.abort()},l.onload=function(){t.read(l.response)},l.onloadend=function(){t.reloading=!1,t.xhr=null},n.checkCrossOrigin&&Nn(e)&&i.crossOrigin&&(e=Fn(e)),l.open("GET",e,!0),l.responseType="arraybuffer",l.withCredentials="use-credentials"===i.crossOrigin,l.send()}else this.clone()}}},{key:"read",value:function(e){var t=this.options,i=this.imageData,n=$n(e),a=0,r=1,o=1;if(n>1){this.url=function(e,t){for(var i=[],n=new Uint8Array(e);n.length>0;)i.push(Hn.apply(null,vn(n.subarray(0,8192)))),n=n.subarray(8192);return"data:".concat(t,";base64,").concat(btoa(i.join("")))}(e,en);var s=function(e){var t=0,i=1,n=1;switch(e){case 2:i=-1;break;case 3:t=-180;break;case 4:n=-1;break;case 5:t=90,n=-1;break;case 6:t=90;break;case 7:t=90,i=-1;break;case 8:t=-90}return{rotate:t,scaleX:i,scaleY:n}}(n);a=s.rotate,r=s.scaleX,o=s.scaleY}t.rotatable&&(i.rotate=a),t.scalable&&(i.scaleX=r,i.scaleY=o),this.clone()}},{key:"clone",value:function(){var e=this.element,t=this.url,i=e.crossOrigin,n=t;this.options.checkCrossOrigin&&Nn(t)&&(i||(i="anonymous"),n=Fn(t)),this.crossOrigin=i,this.crossOriginUrl=n;var a=document.createElement("img");i&&(a.crossOrigin=i),a.src=n||t,a.alt=e.alt||"The image to crop",this.image=a,a.onload=this.start.bind(this),a.onerror=this.stop.bind(this),xn(a,Bi),e.parentNode.insertBefore(a,e.nextSibling)}},{key:"start",value:function(){var e=this,t=this.image;t.onload=null,t.onerror=null,this.sizing=!0;var i=pi.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(pi.navigator.userAgent),n=function(t,i){wn(e.imageData,{naturalWidth:t,naturalHeight:i,aspectRatio:t/i}),e.initialImageData=wn({},e.imageData),e.sizing=!1,e.sized=!0,e.build()};if(!t.naturalWidth||i){var a=document.createElement("img"),r=document.body||document.documentElement;this.sizingImage=a,a.onload=function(){n(a.width,a.height),i||r.removeChild(a)},a.src=t.src,i||(a.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",r.appendChild(a))}else n(t.naturalWidth,t.naturalHeight)}},{key:"stop",value:function(){var e=this.image;e.onload=null,e.onerror=null,e.parentNode.removeChild(e),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var e=this.element,t=this.options,i=this.image,n=e.parentNode,a=document.createElement("div");a.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var r=a.querySelector(".".concat(gi,"-container")),o=r.querySelector(".".concat(gi,"-canvas")),s=r.querySelector(".".concat(gi,"-drag-box")),l=r.querySelector(".".concat(gi,"-crop-box")),h=l.querySelector(".".concat(gi,"-face"));this.container=n,this.cropper=r,this.canvas=o,this.dragBox=s,this.cropBox=l,this.viewBox=r.querySelector(".".concat(gi,"-view-box")),this.face=h,o.appendChild(i),xn(e,Ai),n.insertBefore(r,e.nextSibling),Cn(i,Bi),this.initPreview(),this.bind(),t.initialAspectRatio=Math.max(0,t.initialAspectRatio)||NaN,t.aspectRatio=Math.max(0,t.aspectRatio)||NaN,t.viewMode=Math.max(0,Math.min(3,Math.round(t.viewMode)))||0,xn(l,Ai),t.guides||xn(l.getElementsByClassName("".concat(gi,"-dashed")),Ai),t.center||xn(l.getElementsByClassName("".concat(gi,"-center")),Ai),t.background&&xn(r,"".concat(gi,"-bg")),t.highlight||xn(h,Ri),t.cropBoxMovable&&(xn(h,Li),In(h,Pi,wi)),t.cropBoxResizable||(xn(l.getElementsByClassName("".concat(gi,"-line")),Ai),xn(l.getElementsByClassName("".concat(gi,"-point")),Ai)),this.render(),this.ready=!0,this.setDragMode(t.dragMode),t.autoCrop&&this.crop(),this.setData(t.data),pn(t.ready)&&Bn(e,Gi,t.ready,{once:!0}),Rn(e,Gi)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var e=this.cropper.parentNode;e&&e.removeChild(this.cropper),Cn(this.element,Ai)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}])&&li(t.prototype,i),n&&li(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();wn(Qn.prototype,Zn,Yn,Xn,Kn,Gn,qn);const ea=e({name:"DialogImageCropper",props:{visible:{type:Boolean,default:!1},src:{type:String,default:null}},emits:["onSave","onCancel","update:visible"],setup(e,{emit:t}){a(e);const i=ye(e,t,"visible"),n=s(),r=D();return z(i,(e=>{e?T((()=>{r.value=new Qn(n.value,{modal:!1,autoCropArea:.1})})):r.value=null})),{mVisible:i,imgRef:n,handleSave(){const e=r.value.getCroppedCanvas();t("onSave",e.toDataURL("image/png",1))},handleCancel(){t("onCancel")}}}}),ta=["src"];const ia=h(ea,[["render",function(e,a,r,o,s,l){const h=B;return t(),_(h,{style:{width:"100%",height:"100vh"},preset:"dialog","positive-text":e.$t("actions.done"),title:"Image Cropper",onPositiveClick:e.handleSave,onNegativeClick:e.handleCancel,onClose:a[1]||(a[1]=t=>e.mVisible=!1),show:e.mVisible,"auto-focus":!1,onKeyup:A(e.handleSave,["enter"])},{default:w((()=>[e.mVisible?(t(),i("div",{key:0,onDblclick:a[0]||(a[0]=p(((...t)=>e.handleSave&&e.handleSave(...t)),["stop"]))},[n("img",{ref:"imgRef",class:"cropping-image",src:e.src},null,8,ta)],32)):u("",!0)])),_:1},8,["positive-text","onPositiveClick","onNegativeClick","show","onKeyup"])}],["__scopeId","data-v-d99e3591"]]),na=e=>e.isDirectory&&!xe.test(e.name);var aa=(e=>(e.name="name",e.nameDesc="nameDesc",e.birthTime="birthTime",e.birthTimeDesc="birthTimeDesc",e))(aa||{});const ra={name:(e,t)=>e.name.toLowerCase().localeCompare(t.name.toLowerCase()),nameDesc:(e,t)=>-e.name.toLowerCase().localeCompare(t.name.toLowerCase()),birthTime:(e,t)=>{var i,n;const a=(na(e)?1:2)-(na(t)?1:2);return 0!==a?a:((null==(i=e.meta)?void 0:i.timeCreated)||0)-((null==(n=t.meta)?void 0:n.timeCreated)||0)},birthTimeDesc:(e,t)=>{var i,n;const a=(na(e)?1:2)-(na(t)?1:2);return 0!==a?a:((null==(i=t.meta)?void 0:i.timeCreated)||0)-((null==(n=e.meta)?void 0:n.timeCreated)||0)}},oa=["draggable","title"],sa=["checked"],la={class:"action-menu"},ha={class:"title-wrap"},ca={key:0,class:"item-text-c"},da={class:"meta-info"},ua={key:0,class:"timestamp"},fa=h(e({__name:"ComponentCard",props:{item:{},checked:{type:Boolean}},emits:["open","select","handleDragStart"],setup(e,{emit:r}){const s=r,h=e,{item:m}=a(h),g=o(),w=()=>{s("open",m.value)},b=l((()=>m.value.name.replace(xe,""))),y=l((()=>xe.test(m.value.name))),_=l((()=>{if(y.value)return me.rgb(m.value.name).join(", ")}));let k;const x=M((e=>{m.value.meta&&m.value.meta.cover&&(k=e,C.emit(S.ON_COMP_HOVER,{event:k,item:m.value}))}),70),E=()=>{C.emit(S.ON_COMP_HOVER_OUT)},z=e=>{s("handleDragStart",e),E()};return(e,a)=>{var r,o,s,l;return t(),i("div",{tabindex:"0",class:f(["mc-comp-item btn-no-style",{checked:e.checked,active:O(m).meta&&O(g).curCompInStore&&O(m).meta.id===O(g).curCompInStore.id&&O(g).curCompInStore.basePath===O(m).basePath,hidden:O(m).hidden}]),onClick:p(w,["stop"]),onKeyup:A(w,["enter"]),style:c({"--block-color-rgb":O(_)}),onMousemove:a[2]||(a[2]=(...e)=>O(x)&&O(x)(...e)),onMouseleave:E,draggable:O(y),onDragstart:z,title:O(b)},[n("div",{style:c({backgroundColor:`rgb(${O(_)}, 0.24)`}),class:"mc-comp-item-bg"},null,4),n("input",{class:"file-checkbox",type:"checkbox",checked:e.checked,onClick:a[0]||(a[0]=p((t=>e.$emit("select",{item:O(m),event:t,toggle:!0})),["stop"])),onDblclick:a[1]||(a[1]=p((()=>{}),["stop"]))},null,40,sa),n("div",la,[v(e.$slots,"actionMenu",{item:O(m)},void 0,!0)]),n("div",ha,[O(b)?(t(),i("span",ca,d(O(y)?"":O(m).isDirectory?"":"")+" "+d(O(b)),1)):u("",!0)]),(null==(r=O(m).meta)?void 0:r.cover)?(t(),i("div",{key:0,class:"component-cover",style:c({backgroundImage:`url(${null==(o=O(m).meta)?void 0:o.cover})`})},null,4)):u("",!0),n("div",da,[(null==(s=O(m).meta)?void 0:s.timeCreated)?(t(),i("span",ua,d(O(ve)(null==(l=O(m).meta)?void 0:l.timeCreated)),1)):u("",!0)])],46,oa)}}}),[["__scopeId","data-v-0831c721"]]),pa=async e=>(await ge(300),document.hasFocus()?e:pa(e)),ma=async(e={})=>{const{onCaptureEnd:t,onCaptureStart:i,quality:n=.7,type:a="image/png",soundEffectUrl:r}=e;return await(null==i?void 0:i()),navigator.mediaDevices.getDisplayMedia({preferCurrentTab:!0,video:{frameRate:30}}).then(pa).then((async i=>{const o=(e=>{const t=document.createElement("video");return t.autoplay=!0,t.muted=!0,t.playsInline=!0,t.srcObject=e,t.setAttribute("style","position:fixed;top:0;left:0;pointer-events:none;visibility:hidden;"),t})(i);document.body.appendChild(o),r&&(e=>{const t=document.createElement("audio");t.loop=!1,t.src=e,t.play(),t.remove()})(r),await ge(300);const s=(e=>{var t;const i=null==(t=e.srcObject)?void 0:t.getTracks()[0].getSettings(),n=document.createElement("canvas");n.width=(null==i?void 0:i.width)??0,n.height=(null==i?void 0:i.height)??0;const a=n.getContext("2d");return null==a||a.drawImage(e,0,0),n})(o),l=s.toDataURL(a,n);return(e=>{var t;const i=null==(t=e.srcObject)?void 0:t.getTracks();null==i||i.forEach((e=>e.stop())),e.srcObject=null,e.remove()})(o),s.remove(),"function"==typeof t?await t(s,e):l}))};var va={exports:{}};
/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/const ga=N(va.exports=function e(t,i,n){function a(o,s){if(!i[o]){if(!t[o]){var l="function"==typeof P&&P;if(!s&&l)return l(o,!0);if(r)return r(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[o]={exports:{}};t[o][0].call(c.exports,(function(e){return a(t[o][1][e]||e)}),c,c.exports,e,t,i,n)}return i[o].exports}for(var r="function"==typeof P&&P,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(e,t,i){var n=e("./utils"),a=e("./support"),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(e){for(var t,i,a,o,s,l,h,c=[],d=0,u=e.length,f=u,p="string"!==n.getTypeOf(e);d<e.length;)f=u-d,a=p?(t=e[d++],i=d<u?e[d++]:0,d<u?e[d++]:0):(t=e.charCodeAt(d++),i=d<u?e.charCodeAt(d++):0,d<u?e.charCodeAt(d++):0),o=t>>2,s=(3&t)<<4|i>>4,l=1<f?(15&i)<<2|a>>6:64,h=2<f?63&a:64,c.push(r.charAt(o)+r.charAt(s)+r.charAt(l)+r.charAt(h));return c.join("")},i.decode=function(e){var t,i,n,o,s,l,h=0,c=0,d="data:";if(e.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var u,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===r.charAt(64)&&f--,e.charAt(e.length-2)===r.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(u=a.uint8array?new Uint8Array(0|f):new Array(0|f);h<e.length;)t=r.indexOf(e.charAt(h++))<<2|(o=r.indexOf(e.charAt(h++)))>>4,i=(15&o)<<4|(s=r.indexOf(e.charAt(h++)))>>2,n=(3&s)<<6|(l=r.indexOf(e.charAt(h++))),u[c++]=t,64!==s&&(u[c++]=i),64!==l&&(u[c++]=n);return u}},{"./support":30,"./utils":32}],2:[function(e,t,i){var n=e("./external"),a=e("./stream/DataWorker"),r=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function s(e,t,i,n,a){this.compressedSize=e,this.uncompressedSize=t,this.crc32=i,this.compression=n,this.compressedContent=a}s.prototype={getContentWorker:function(){var e=new a(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new a(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,i){return e.pipe(new r).pipe(new o("uncompressedSize")).pipe(t.compressWorker(i)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,i){var n=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,i){var n=e("./utils"),a=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==n.getTypeOf(e)?function(e,t,i,n){var r=a,o=n+i;e^=-1;for(var s=n;s<o;s++)e=e>>>8^r[255&(e^t[s])];return~e}(0|t,e,e.length,0):function(e,t,i,n){var r=a,o=n+i;e^=-1;for(var s=n;s<o;s++)e=e>>>8^r[255&(e^t.charCodeAt(s))];return~e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,t,i){var n=null;n="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:n}},{lie:37}],7:[function(e,t,i){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,a=e("pako"),r=e("./utils"),o=e("./stream/GenericWorker"),s=n?"uint8array":"array";function l(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}i.magic="\b\0",r.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(r.transformTo(s,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},i.compressWorker=function(e){return new l("Deflate",e)},i.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,i){function n(e,t){var i,n="";for(i=0;i<t;i++)n+=String.fromCharCode(255&e),e>>>=8;return n}function a(e,t,i,a,o,c){var d,u,f=e.file,p=e.compression,m=c!==s.utf8encode,v=r.transformTo("string",c(f.name)),g=r.transformTo("string",s.utf8encode(f.name)),w=f.comment,b=r.transformTo("string",c(w)),y=r.transformTo("string",s.utf8encode(w)),_=g.length!==f.name.length,k=y.length!==w.length,x="",C="",S="",E=f.dir,z=f.date,O={crc32:0,compressedSize:0,uncompressedSize:0};t&&!i||(O.crc32=e.crc32,O.compressedSize=e.compressedSize,O.uncompressedSize=e.uncompressedSize);var I=0;t&&(I|=8),m||!_&&!k||(I|=2048);var D,T,A,B=0,R=0;E&&(B|=16),"UNIX"===o?(R=798,B|=(D=f.unixPermissions,T=E,A=D,D||(A=T?16893:33204),(65535&A)<<16)):(R=20,B|=function(e){return 63&(e||0)}(f.dosPermissions)),d=z.getUTCHours(),d<<=6,d|=z.getUTCMinutes(),d<<=5,d|=z.getUTCSeconds()/2,u=z.getUTCFullYear()-1980,u<<=4,u|=z.getUTCMonth()+1,u<<=5,u|=z.getUTCDate(),_&&(C=n(1,1)+n(l(v),4)+g,x+="up"+n(C.length,2)+C),k&&(S=n(1,1)+n(l(b),4)+y,x+="uc"+n(S.length,2)+S);var M="";return M+="\n\0",M+=n(I,2),M+=p.magic,M+=n(d,2),M+=n(u,2),M+=n(O.crc32,4),M+=n(O.compressedSize,4),M+=n(O.uncompressedSize,4),M+=n(v.length,2),M+=n(x.length,2),{fileRecord:h.LOCAL_FILE_HEADER+M+v+x,dirRecord:h.CENTRAL_FILE_HEADER+n(R,2)+M+n(b.length,2)+"\0\0\0\0"+n(B,4)+n(a,4)+v+x+b}}var r=e("../utils"),o=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),h=e("../signature");function c(e,t,i,n){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=i,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(c,o),c.prototype.push=function(e){var t=e.meta.percent||0,i=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:i?(t+100*(i-n-1))/i:100}}))},c.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var i=a(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0},c.prototype.closedSource=function(e){this.accumulate=!1;var t,i=this.streamFiles&&!e.file.dir,r=a(e,i,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),i)this.push({data:(t=e,h.DATA_DESCRIPTOR+n(t.crc32,4)+n(t.compressedSize,4)+n(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},c.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var i,a,o,s,l,c,d=this.bytesWritten-e,u=(i=this.dirRecords.length,a=d,o=e,s=this.zipComment,l=this.encodeFileName,c=r.transformTo("string",l(s)),h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(i,2)+n(i,2)+n(a,4)+n(o,4)+n(c.length,2)+c);this.push({data:u,meta:{percent:100}})},c.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},c.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},c.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},c.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var i=0;i<t.length;i++)try{t[i].error(e)}catch(n){}return!0},c.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=c},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,i){var n=e("../compressions"),a=e("./ZipFileWorker");i.generateWorker=function(e,t,i){var r=new a(t.streamFiles,i,t.platform,t.encodeFileName),o=0;try{e.forEach((function(e,i){o++;var a=function(e,t){var i=e||t,a=n[i];if(!a)throw new Error(i+" is not a valid compression method !");return a}(i.options.compression,t.compression),s=i.options.compressionOptions||t.compressionOptions||{},l=i.dir,h=i.date;i._compressWorker(a,s).withStreamInfo("file",{name:e,dir:l,date:h,comment:i.comment||"",unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions}).pipe(r)})),r.entriesCount=o}catch(s){r.error(s)}return r}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,i){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new n;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(e,t){return(new n).loadAsync(e,t)},n.external=e("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,i){var n=e("./utils"),a=e("./external"),r=e("./utf8"),o=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function h(e){return new a.Promise((function(t,i){var n=e.decompressed.getContentWorker().pipe(new s);n.on("error",(function(e){i(e)})).on("end",(function(){n.streamInfo.crc32!==e.decompressed.crc32?i(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var i=this;return t=n.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:r.utf8decode}),l.isNode&&l.isStream(e)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var i=new o(t);return i.load(e),i})).then((function(e){var i=[a.Promise.resolve(e)],n=e.files;if(t.checkCRC32)for(var r=0;r<n.length;r++)i.push(h(n[r]));return a.Promise.all(i)})).then((function(e){for(var a=e.shift(),r=a.files,o=0;o<r.length;o++){var s=r[o],l=s.fileNameStr,h=n.resolve(s.fileNameStr);i.file(h,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(i.file(h).unsafeOriginalName=l)}return a.zipComment.length&&(i.comment=a.zipComment),i}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,i){var n=e("../utils"),a=e("../stream/GenericWorker");function r(e,t){a.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}n.inherits(r,a),r.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},r.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},r.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=r},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,i){var n=e("readable-stream").Readable;function a(e,t,i){n.call(this,t),this._helper=e;var a=this;e.on("data",(function(e,t){a.push(e)||a._helper.pause(),i&&i(t)})).on("error",(function(e){a.emit("error",e)})).on("end",(function(){a.push(null)}))}e("../utils").inherits(a,n),a.prototype._read=function(){this._helper.resume()},t.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,t,i){t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,i){function n(e,t,i){var n,a=r.getTypeOf(t),s=r.extend(i||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=m(e)),s.createFolders&&(n=p(e))&&v.call(this,n,!0);var d="string"===a&&!1===s.binary&&!1===s.base64;i&&void 0!==i.binary||(s.binary=!d),(t instanceof h&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",a="string");var g=null;g=t instanceof h||t instanceof o?t:u.isNode&&u.isStream(t)?new f(e,t):r.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var w=new c(e,g,s);this.files[e]=w}var a=e("./utf8"),r=e("./utils"),o=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),l=e("./defaults"),h=e("./compressedObject"),c=e("./zipObject"),d=e("./generate"),u=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},v=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||n.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function g(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,i,n;for(t in this.files)n=this.files[t],(i=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(i,n)},filter:function(e){var t=[];return this.forEach((function(i,n){e(i,n)&&t.push(n)})),t},file:function(e,t,i){if(1!==arguments.length)return e=this.root+e,n.call(this,e,t,i),this;if(g(e)){var a=e;return this.filter((function(e,t){return!t.dir&&a.test(e)}))}var r=this.files[this.root+e];return r&&!r.dir?r:null},folder:function(e){if(!e)return this;if(g(e))return this.filter((function(t,i){return i.dir&&e.test(t)}));var t=this.root+e,i=v.call(this,t),n=this.clone();return n.root=i.name,n},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var i=this.filter((function(t,i){return i.name.slice(0,e.length)===e})),n=0;n<i.length;n++)delete this.files[i[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,i={};try{if((i=r.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=i.type.toLowerCase(),i.compression=i.compression.toUpperCase(),"binarystring"===i.type&&(i.type="string"),!i.type)throw new Error("No output type specified.");r.checkSupport(i.type),"darwin"!==i.platform&&"freebsd"!==i.platform&&"linux"!==i.platform&&"sunos"!==i.platform||(i.platform="UNIX"),"win32"===i.platform&&(i.platform="DOS");var n=i.comment||this.comment||"";t=d.generateWorker(this,i,n)}catch(l){(t=new o("error")).error(l)}return new s(t,i.type||"string",i.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,i){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,i){var n=e("./DataReader");function a(e){n.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(a,n),a.prototype.byteAt=function(e){return this.data[this.zero+e]},a.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),i=e.charCodeAt(1),n=e.charCodeAt(2),a=e.charCodeAt(3),r=this.length-4;0<=r;--r)if(this.data[r]===t&&this.data[r+1]===i&&this.data[r+2]===n&&this.data[r+3]===a)return r-this.zero;return-1},a.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),i=e.charCodeAt(1),n=e.charCodeAt(2),a=e.charCodeAt(3),r=this.readData(4);return t===r[0]&&i===r[1]&&n===r[2]&&a===r[3]},a.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,t,i){var n=e("../utils");function a(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,i=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)i=(i<<8)+this.byteAt(t);return this.index+=e,i},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=a},{"../utils":32}],19:[function(e,t,i){var n=e("./Uint8ArrayReader");function a(e){n.call(this,e)}e("../utils").inherits(a,n),a.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,i){var n=e("./DataReader");function a(e){n.call(this,e)}e("../utils").inherits(a,n),a.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},a.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},a.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},a.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,t,i){var n=e("./ArrayReader");function a(e){n.call(this,e)}e("../utils").inherits(a,n),a.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,i){var n=e("../utils"),a=e("../support"),r=e("./ArrayReader"),o=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=n.getTypeOf(e);return n.checkSupport(t),"string"!==t||a.uint8array?"nodebuffer"===t?new s(e):a.uint8array?new l(n.transformTo("uint8array",e)):new r(n.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,i){var n=e("./GenericWorker"),a=e("../utils");function r(e){n.call(this,"ConvertWorker to "+e),this.destType=e}a.inherits(r,n),r.prototype.processChunk=function(e){this.push({data:a.transformTo(this.destType,e.data),meta:e.meta})},t.exports=r},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,i){var n=e("./GenericWorker"),a=e("../crc32");function r(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(r,n),r.prototype.processChunk=function(e){this.streamInfo.crc32=a(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=r},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,i){var n=e("../utils"),a=e("./GenericWorker");function r(e){a.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}n.inherits(r,a),r.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}a.prototype.processChunk.call(this,e)},t.exports=r},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,i){var n=e("../utils"),a=e("./GenericWorker");function r(e){a.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=n.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}n.inherits(r,a),r.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},r.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},r.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},r.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=r},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,i){function n(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var i=0;i<this._listeners[e].length;i++)this._listeners[e][i].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=n},{}],29:[function(e,t,i){var n=e("../utils"),a=e("./ConvertWorker"),r=e("./GenericWorker"),o=e("../base64"),s=e("../support"),l=e("../external"),h=null;if(s.nodestream)try{h=e("../nodejs/NodejsStreamOutputAdapter")}catch(u){}function c(e,t){return new l.Promise((function(i,a){var r=[],s=e._internalType,l=e._outputType,h=e._mimeType;e.on("data",(function(e,i){r.push(e),t&&t(i)})).on("error",(function(e){r=[],a(e)})).on("end",(function(){try{var e=function(e,t,i){switch(e){case"blob":return n.newBlob(n.transformTo("arraybuffer",t),i);case"base64":return o.encode(t);default:return n.transformTo(e,t)}}(l,function(e,t){var i,n=0,a=null,r=0;for(i=0;i<t.length;i++)r+=t[i].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(a=new Uint8Array(r),i=0;i<t.length;i++)a.set(t[i],n),n+=t[i].length;return a;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,r),h);i(e)}catch(t){a(t)}r=[]})).resume()}))}function d(e,t,i){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=i,n.checkSupport(o),this._worker=e.pipe(new a(o)),e.lock()}catch(s){this._worker=new r("error"),this._worker.error(s)}}d.prototype={accumulate:function(e){return c(this,e)},on:function(e,t){var i=this;return"data"===e?this._worker.on(e,(function(e){t.call(i,e.data,e.meta)})):this._worker.on(e,(function(){n.delay(t,arguments,i)})),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(n.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,i.nodebuffer="undefined"!=typeof Buffer,i.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)i.blob=!1;else{var n=new ArrayBuffer(0);try{i.blob=0===new Blob([n],{type:"application/zip"}).size}catch(r){try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(n),i.blob=0===a.getBlob("application/zip").size}catch(o){i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch(r){i.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,i){for(var n=e("./utils"),a=e("./support"),r=e("./nodejsUtils"),o=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function h(){o.call(this,"utf-8 decode"),this.leftOver=null}function c(){o.call(this,"utf-8 encode")}s[254]=s[254]=1,i.utf8encode=function(e){return a.nodebuffer?r.newBufferFrom(e,"utf-8"):function(e){var t,i,n,r,o,s=e.length,l=0;for(r=0;r<s;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(n=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++),l+=i<128?1:i<2048?2:i<65536?3:4;for(t=a.uint8array?new Uint8Array(l):new Array(l),r=o=0;o<l;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(n=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++),i<128?t[o++]=i:(i<2048?t[o++]=192|i>>>6:(i<65536?t[o++]=224|i>>>12:(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63),t[o++]=128|i>>>6&63),t[o++]=128|63&i);return t}(e)},i.utf8decode=function(e){return a.nodebuffer?n.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,i,a,r,o=e.length,l=new Array(2*o);for(t=i=0;t<o;)if((a=e[t++])<128)l[i++]=a;else if(4<(r=s[a]))l[i++]=65533,t+=r-1;else{for(a&=2===r?31:3===r?15:7;1<r&&t<o;)a=a<<6|63&e[t++],r--;1<r?l[i++]=65533:a<65536?l[i++]=a:(a-=65536,l[i++]=55296|a>>10&1023,l[i++]=56320|1023&a)}return l.length!==i&&(l.subarray?l=l.subarray(0,i):l.length=i),n.applyFromCharCode(l)}(e=n.transformTo(a.uint8array?"uint8array":"array",e))},n.inherits(h,o),h.prototype.processChunk=function(e){var t=n.transformTo(a.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var r=t;(t=new Uint8Array(r.length+this.leftOver.length)).set(this.leftOver,0),t.set(r,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0||0===i?t:i+s[e[i]]>t?i:t}(t),l=t;o!==t.length&&(a.uint8array?(l=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(l=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:i.utf8decode(l),meta:e.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=h,n.inherits(c,o),c.prototype.processChunk=function(e){this.push({data:i.utf8encode(e.data),meta:e.meta})},i.Utf8EncodeWorker=c},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,i){var n=e("./support"),a=e("./base64"),r=e("./nodejsUtils"),o=e("./external");function s(e){return e}function l(e,t){for(var i=0;i<e.length;++i)t[i]=255&e.charCodeAt(i);return t}e("setimmediate"),i.newBlob=function(e,t){i.checkSupport("blob");try{return new Blob([e],{type:t})}catch(a){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(e),n.getBlob(t)}catch(r){throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(e,t,i){var n=[],a=0,r=e.length;if(r<=i)return String.fromCharCode.apply(null,e);for(;a<r;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(a,Math.min(a+i,r)))):n.push(String.fromCharCode.apply(null,e.subarray(a,Math.min(a+i,r)))),a+=i;return n.join("")},stringifyByChar:function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&1===String.fromCharCode.apply(null,r.allocBuffer(1)).length}catch(e){return!1}}()}};function c(e){var t=65536,n=i.getTypeOf(e),a=!0;if("uint8array"===n?a=h.applyCanBeUsed.uint8array:"nodebuffer"===n&&(a=h.applyCanBeUsed.nodebuffer),a)for(;1<t;)try{return h.stringifyByChunk(e,n,t)}catch(r){t=Math.floor(t/2)}return h.stringifyByChar(e)}function d(e,t){for(var i=0;i<e.length;i++)t[i]=e[i];return t}i.applyFromCharCode=c;var u={};u.string={string:s,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return u.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,r.allocBuffer(e.length))}},u.array={string:c,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(e)}},u.arraybuffer={string:function(e){return c(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(new Uint8Array(e))}},u.uint8array={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return r.newBufferFrom(e)}},u.nodebuffer={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return u.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:s},i.transformTo=function(e,t){if(t=t||"",!e)return t;i.checkSupport(e);var n=i.getTypeOf(t);return u[n][e](t)},i.resolve=function(e){for(var t=e.split("/"),i=[],n=0;n<t.length;n++){var a=t[n];"."===a||""===a&&0!==n&&n!==t.length-1||(".."===a?i.pop():i.push(a))}return i.join("/")},i.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":n.nodebuffer&&r.isBuffer(e)?"nodebuffer":n.uint8array&&e instanceof Uint8Array?"uint8array":n.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(e){if(!n[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(e){var t,i,n="";for(i=0;i<(e||"").length;i++)n+="\\x"+((t=e.charCodeAt(i))<16?"0":"")+t.toString(16).toUpperCase();return n},i.delay=function(e,t,i){setImmediate((function(){e.apply(i||null,t||[])}))},i.inherits=function(e,t){function i(){}i.prototype=t.prototype,e.prototype=new i},i.extend=function(){var e,t,i={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===i[t]&&(i[t]=arguments[e][t]);return i},i.prepareContent=function(e,t,r,s,h){return o.Promise.resolve(t).then((function(e){return n.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise((function(t,i){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(e){i(e.target.error)},n.readAsArrayBuffer(e)})):e})).then((function(t){var c,d=i.getTypeOf(t);return d?("arraybuffer"===d?t=i.transformTo("uint8array",t):"string"===d&&(h?t=a.decode(t):r&&!0!==s&&(t=l(c=t,n.uint8array?new Uint8Array(c.length):new Array(c.length)))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,i){var n=e("./reader/readerFor"),a=e("./utils"),r=e("./signature"),o=e("./zipEntry"),s=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(t)+", expected "+a.pretty(e)+")")}},isSignature:function(e,t){var i=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(i),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",i=a.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,i,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),i=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(r.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(r.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,r.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(r.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,r.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var n=t-i;if(0<n)this.isSignature(t,r.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){this.reader=n(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,i){var n=e("./reader/readerFor"),a=e("./utils"),r=e("./compressedObject"),o=e("./crc32"),s=e("./utf8"),l=e("./compressions"),h=e("./support");function c(e,t){this.options=e,this.loadOptions=t}c.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,i;if(e.skip(22),this.fileNameLength=e.readInt(2),i=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(i),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new r(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=n(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,i,n,a=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<a;)t=e.readInt(2),i=e.readInt(2),n=e.readData(i),this.extraFields[t]={id:t,length:i,value:n};e.setIndex(a)},handleUTF8:function(){var e=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var i=a.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var r=a.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(r)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=n(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=n(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,i){function n(e,t,i){this.name=e,this.dir=i.dir,this.date=i.date,this.comment=i.comment,this.unixPermissions=i.unixPermissions,this.dosPermissions=i.dosPermissions,this._data=t,this._dataBinary=i.binary,this.options={compression:i.compression,compressionOptions:i.compressionOptions}}var a=e("./stream/StreamHelper"),r=e("./stream/DataWorker"),o=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");n.prototype={internalStream:function(e){var t=null,i="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(i=e.toLowerCase())||"text"===i;"binarystring"!==i&&"text"!==i||(i="string"),t=this._decompressWorker();var r=!this._dataBinary;r&&!n&&(t=t.pipe(new o.Utf8EncodeWorker)),!r&&n&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(s){(t=new l("error")).error(s)}return new a(t,i,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var i=this._decompressWorker();return this._dataBinary||(i=i.pipe(new o.Utf8EncodeWorker)),s.createWorkerFrom(i,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new r(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<h.length;d++)n.prototype[h[d]]=c;t.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,i){(function(e){var i,n,a=e.MutationObserver||e.WebKitMutationObserver;if(a){var r=0,o=new a(c),s=e.document.createTextNode("");o.observe(s,{characterData:!0}),i=function(){s.data=r=++r%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){c(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(c,0)};else{var l=new e.MessageChannel;l.port1.onmessage=c,i=function(){l.port2.postMessage(0)}}var h=[];function c(){var e,t;n=!0;for(var i=h.length;i;){for(t=h,h=[],e=-1;++e<i;)t[e]();i=h.length}n=!1}t.exports=function(e){1!==h.push(e)||n||i()}}).call(this,void 0!==L?L:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,i){var n=e("immediate");function a(){}var r={},o=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function h(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==a&&f(this,e)}function c(e,t,i){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function d(e,t,i){n((function(){var n;try{n=t(i)}catch(a){return r.reject(e,a)}n===e?r.reject(e,new TypeError("Cannot resolve promise with itself")):r.resolve(e,n)}))}function u(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var i=!1;function n(t){i||(i=!0,r.reject(e,t))}function a(t){i||(i=!0,r.resolve(e,t))}var o=p((function(){t(a,n)}));"error"===o.status&&n(o.value)}function p(e,t){var i={};try{i.value=e(t),i.status="success"}catch(n){i.status="error",i.value=n}return i}(t.exports=h).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(i){return t.resolve(e()).then((function(){return i}))}),(function(i){return t.resolve(e()).then((function(){throw i}))}))},h.prototype.catch=function(e){return this.then(null,e)},h.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o)return this;var i=new this.constructor(a);return this.state!==l?d(i,this.state===s?e:t,this.outcome):this.queue.push(new c(i,e,t)),i},c.prototype.callFulfilled=function(e){r.resolve(this.promise,e)},c.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},c.prototype.callRejected=function(e){r.reject(this.promise,e)},c.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},r.resolve=function(e,t){var i=p(u,t);if("error"===i.status)return r.reject(e,i.value);var n=i.value;if(n)f(e,n);else{e.state=s,e.outcome=t;for(var a=-1,o=e.queue.length;++a<o;)e.queue[a].callFulfilled(t)}return e},r.reject=function(e,t){e.state=o,e.outcome=t;for(var i=-1,n=e.queue.length;++i<n;)e.queue[i].callRejected(t);return e},h.resolve=function(e){return e instanceof this?e:r.resolve(new this(a),e)},h.reject=function(e){var t=new this(a);return r.reject(t,e)},h.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,n=!1;if(!i)return this.resolve([]);for(var o=new Array(i),s=0,l=-1,h=new this(a);++l<i;)c(e[l],l);return h;function c(e,a){t.resolve(e).then((function(e){o[a]=e,++s!==i||n||(n=!0,r.resolve(h,o))}),(function(e){n||(n=!0,r.reject(h,e))}))}},h.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,n=!1;if(!i)return this.resolve([]);for(var o,s=-1,l=new this(a);++s<i;)o=e[s],t.resolve(o).then((function(e){n||(n=!0,r.resolve(l,e))}),(function(e){n||(n=!0,r.reject(l,e))}));return l}},{immediate:36}],38:[function(e,t,i){var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,i){var n=e("./zlib/deflate"),a=e("./utils/common"),r=e("./utils/strings"),o=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString,h=0,c=-1,d=0,u=8;function f(e){if(!(this instanceof f))return new f(e);this.options=a.assign({level:c,method:u,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var i=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==h)throw new Error(o[i]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){var p;if(p="string"==typeof t.dictionary?r.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(i=n.deflateSetDictionary(this.strm,p))!==h)throw new Error(o[i]);this._dict_set=!0}}function p(e,t){var i=new f(t);if(i.push(e,!0),i.err)throw i.msg||o[i.err];return i.result}f.prototype.push=function(e,t){var i,o,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=r.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new a.Buf8(c),s.next_out=0,s.avail_out=c),1!==(i=n.deflate(s,o))&&i!==h)return this.onEnd(i),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(r.buf2binstring(a.shrinkBuf(s.output,s.next_out))):this.onData(a.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==i);return 4===o?(i=n.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===h):2!==o||(this.onEnd(h),!(s.avail_out=0))},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){e===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Deflate=f,i.deflate=p,i.deflateRaw=function(e,t){return(t=t||{}).raw=!0,p(e,t)},i.gzip=function(e,t){return(t=t||{}).gzip=!0,p(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,i){var n=e("./zlib/inflate"),a=e("./utils/common"),r=e("./utils/strings"),o=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),h=e("./zlib/gzheader"),c=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=n.inflateInit2(this.strm,t.windowBits);if(i!==o.Z_OK)throw new Error(s[i]);this.header=new h,n.inflateGetHeader(this.strm,this.header)}function u(e,t){var i=new d(t);if(i.push(e,!0),i.err)throw i.msg||s[i.err];return i.result}d.prototype.push=function(e,t){var i,s,l,h,d,u,f=this.strm,p=this.options.chunkSize,m=this.options.dictionary,v=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?f.input=r.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new a.Buf8(p),f.next_out=0,f.avail_out=p),(i=n.inflate(f,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&m&&(u="string"==typeof m?r.string2buf(m):"[object ArrayBuffer]"===c.call(m)?new Uint8Array(m):m,i=n.inflateSetDictionary(this.strm,u)),i===o.Z_BUF_ERROR&&!0===v&&(i=o.Z_OK,v=!1),i!==o.Z_STREAM_END&&i!==o.Z_OK)return this.onEnd(i),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&i!==o.Z_STREAM_END&&(0!==f.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=r.utf8border(f.output,f.next_out),h=f.next_out-l,d=r.buf2string(f.output,l),f.next_out=h,f.avail_out=p-h,h&&a.arraySet(f.output,f.output,l,h,0),this.onData(d)):this.onData(a.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(v=!0)}while((0<f.avail_in||0===f.avail_out)&&i!==o.Z_STREAM_END);return i===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(i=n.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(f.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Inflate=d,i.inflate=u,i.inflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},i.ungzip=u},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,i){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])}}return e},i.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,i,n,a){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+n),a);else for(var r=0;r<n;r++)e[a+r]=t[i+r]},flattenChunks:function(e){var t,i,n,a,r,o;for(t=n=0,i=e.length;t<i;t++)n+=e[t].length;for(o=new Uint8Array(n),t=a=0,i=e.length;t<i;t++)r=e[t],o.set(r,a),a+=r.length;return o}},r={arraySet:function(e,t,i,n,a){for(var r=0;r<n;r++)e[a+r]=t[i+r]},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){e?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,r))},i.setTyped(n)},{}],42:[function(e,t,i){var n=e("./common"),a=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch(h){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(h){r=!1}for(var o=new n.Buf8(256),s=0;s<256;s++)o[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&r||!e.subarray&&a))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var i="",o=0;o<t;o++)i+=String.fromCharCode(e[o]);return i}o[254]=o[254]=1,i.string2buf=function(e){var t,i,a,r,o,s=e.length,l=0;for(r=0;r<s;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(a=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(a-56320),r++),l+=i<128?1:i<2048?2:i<65536?3:4;for(t=new n.Buf8(l),r=o=0;o<l;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(a=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(a-56320),r++),i<128?t[o++]=i:(i<2048?t[o++]=192|i>>>6:(i<65536?t[o++]=224|i>>>12:(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63),t[o++]=128|i>>>6&63),t[o++]=128|63&i);return t},i.buf2binstring=function(e){return l(e,e.length)},i.binstring2buf=function(e){for(var t=new n.Buf8(e.length),i=0,a=t.length;i<a;i++)t[i]=e.charCodeAt(i);return t},i.buf2string=function(e,t){var i,n,a,r,s=t||e.length,h=new Array(2*s);for(i=n=0;i<s;)if((a=e[i++])<128)h[n++]=a;else if(4<(r=o[a]))h[n++]=65533,i+=r-1;else{for(a&=2===r?31:3===r?15:7;1<r&&i<s;)a=a<<6|63&e[i++],r--;1<r?h[n++]=65533:a<65536?h[n++]=a:(a-=65536,h[n++]=55296|a>>10&1023,h[n++]=56320|1023&a)}return l(h,n)},i.utf8border=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0||0===i?t:i+o[e[i]]>t?i:t}},{"./common":41}],43:[function(e,t,i){t.exports=function(e,t,i,n){for(var a=65535&e,r=e>>>16&65535,o=0;0!==i;){for(i-=o=2e3<i?2e3:i;r=r+(a=a+t[n++]|0)|0,--o;);a%=65521,r%=65521}return a|r<<16}},{}],44:[function(e,t,i){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,i){var n=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t,i,a){var r=n,o=a+i;e^=-1;for(var s=a;s<o;s++)e=e>>>8^r[255&(e^t[s])];return~e}},{}],46:[function(e,t,i){var n,a=e("../utils/common"),r=e("./trees"),o=e("./adler32"),s=e("./crc32"),l=e("./messages"),h=0,c=4,d=0,u=-2,f=-1,p=4,m=2,v=8,g=9,w=286,b=30,y=19,_=2*w+1,k=15,x=3,C=258,S=C+x+1,E=42,z=113,O=1,I=2,D=3,T=4;function A(e,t){return e.msg=l[t],t}function B(e){return(e<<1)-(4<e?9:0)}function R(e){for(var t=e.length;0<=--t;)e[t]=0}function M(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(a.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))}function L(e,t){r._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,M(e.strm)}function P(e,t){e.pending_buf[e.pending++]=t}function N(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function F(e,t){var i,n,a=e.max_chain_length,r=e.strstart,o=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-S?e.strstart-(e.w_size-S):0,h=e.window,c=e.w_mask,d=e.prev,u=e.strstart+C,f=h[r+o-1],p=h[r+o];e.prev_length>=e.good_match&&(a>>=2),s>e.lookahead&&(s=e.lookahead);do{if(h[(i=t)+o]===p&&h[i+o-1]===f&&h[i]===h[r]&&h[++i]===h[r+1]){r+=2,i++;do{}while(h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&r<u);if(n=C-(u-r),r=u-C,o<n){if(e.match_start=t,s<=(o=n))break;f=h[r+o-1],p=h[r+o]}}}while((t=d[t&c])>l&&0!=--a);return o<=e.lookahead?o:e.lookahead}function U(e){var t,i,n,r,l,h,c,d,u,f,p=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-S)){for(a.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=i=e.hash_size;n=e.head[--t],e.head[t]=p<=n?n-p:0,--i;);for(t=i=p;n=e.prev[--t],e.prev[t]=p<=n?n-p:0,--i;);r+=p}if(0===e.strm.avail_in)break;if(h=e.strm,c=e.window,d=e.strstart+e.lookahead,f=void 0,(u=r)<(f=h.avail_in)&&(f=u),i=0===f?0:(h.avail_in-=f,a.arraySet(c,h.input,h.next_in,f,d),1===h.state.wrap?h.adler=o(h.adler,c,f,d):2===h.state.wrap&&(h.adler=s(h.adler,c,f,d)),h.next_in+=f,h.total_in+=f,f),e.lookahead+=i,e.lookahead+e.insert>=x)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+x-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<x)););}while(e.lookahead<S&&0!==e.strm.avail_in)}function W(e,t){for(var i,n;;){if(e.lookahead<S){if(U(e),e.lookahead<S&&t===h)return O;if(0===e.lookahead)break}if(i=0,e.lookahead>=x&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-S&&(e.match_length=F(e,i)),e.match_length>=x)if(n=r._tr_tally(e,e.strstart-e.match_start,e.match_length-x),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=x){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(L(e,!1),0===e.strm.avail_out))return O}return e.insert=e.strstart<x-1?e.strstart:x-1,t===c?(L(e,!0),0===e.strm.avail_out?D:T):e.last_lit&&(L(e,!1),0===e.strm.avail_out)?O:I}function j(e,t){for(var i,n,a;;){if(e.lookahead<S){if(U(e),e.lookahead<S&&t===h)return O;if(0===e.lookahead)break}if(i=0,e.lookahead>=x&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=x-1,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-S&&(e.match_length=F(e,i),e.match_length<=5&&(1===e.strategy||e.match_length===x&&4096<e.strstart-e.match_start)&&(e.match_length=x-1)),e.prev_length>=x&&e.match_length<=e.prev_length){for(a=e.strstart+e.lookahead-x,n=r._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-x),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=x-1,e.strstart++,n&&(L(e,!1),0===e.strm.avail_out))return O}else if(e.match_available){if((n=r._tr_tally(e,0,e.window[e.strstart-1]))&&L(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return O}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=r._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<x-1?e.strstart:x-1,t===c?(L(e,!0),0===e.strm.avail_out?D:T):e.last_lit&&(L(e,!1),0===e.strm.avail_out)?O:I}function H(e,t,i,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=n,this.func=a}function V(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*_),this.dyn_dtree=new a.Buf16(2*(2*b+1)),this.bl_tree=new a.Buf16(2*(2*y+1)),R(this.dyn_ltree),R(this.dyn_dtree),R(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(k+1),this.heap=new a.Buf16(2*w+1),R(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*w+1),R(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function $(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=m,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?E:z,e.adler=2===t.wrap?0:1,t.last_flush=h,r._tr_init(t),d):A(e,u)}function Z(e){var t,i=$(e);return i===d&&((t=e.state).window_size=2*t.w_size,R(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=x-1,t.match_available=0,t.ins_h=0),i}function Y(e,t,i,n,r,o){if(!e)return u;var s=1;if(t===f&&(t=6),n<0?(s=0,n=-n):15<n&&(s=2,n-=16),r<1||g<r||i!==v||n<8||15<n||t<0||9<t||o<0||p<o)return A(e,u);8===n&&(n=9);var l=new V;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=r+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+x-1)/x),l.window=new a.Buf8(2*l.w_size),l.head=new a.Buf16(l.hash_size),l.prev=new a.Buf16(l.w_size),l.lit_bufsize=1<<r+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new a.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=i,Z(e)}n=[new H(0,0,0,0,(function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(U(e),0===e.lookahead&&t===h)return O;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+i;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,L(e,!1),0===e.strm.avail_out))return O;if(e.strstart-e.block_start>=e.w_size-S&&(L(e,!1),0===e.strm.avail_out))return O}return e.insert=0,t===c?(L(e,!0),0===e.strm.avail_out?D:T):(e.strstart>e.block_start&&(L(e,!1),e.strm.avail_out),O)})),new H(4,4,8,4,W),new H(4,5,16,8,W),new H(4,6,32,32,W),new H(4,4,16,16,j),new H(8,16,32,32,j),new H(8,16,128,128,j),new H(8,32,128,256,j),new H(32,128,258,1024,j),new H(32,258,258,4096,j)],i.deflateInit=function(e,t){return Y(e,t,v,15,8,0)},i.deflateInit2=Y,i.deflateReset=Z,i.deflateResetKeep=$,i.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?u:(e.state.gzhead=t,d):u},i.deflate=function(e,t){var i,a,o,l;if(!e||!e.state||5<t||t<0)return e?A(e,u):u;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||666===a.status&&t!==c)return A(e,0===e.avail_out?-5:u);if(a.strm=e,i=a.last_flush,a.last_flush=t,a.status===E)if(2===a.wrap)e.adler=0,P(a,31),P(a,139),P(a,8),a.gzhead?(P(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),P(a,255&a.gzhead.time),P(a,a.gzhead.time>>8&255),P(a,a.gzhead.time>>16&255),P(a,a.gzhead.time>>24&255),P(a,9===a.level?2:2<=a.strategy||a.level<2?4:0),P(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(P(a,255&a.gzhead.extra.length),P(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=s(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69):(P(a,0),P(a,0),P(a,0),P(a,0),P(a,0),P(a,9===a.level?2:2<=a.strategy||a.level<2?4:0),P(a,3),a.status=z);else{var f=v+(a.w_bits-8<<4)<<8;f|=(2<=a.strategy||a.level<2?0:a.level<6?1:6===a.level?2:3)<<6,0!==a.strstart&&(f|=32),f+=31-f%31,a.status=z,N(a,f),0!==a.strstart&&(N(a,e.adler>>>16),N(a,65535&e.adler)),e.adler=1}if(69===a.status)if(a.gzhead.extra){for(o=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),M(e),o=a.pending,a.pending!==a.pending_buf_size));)P(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=73)}else a.status=73;if(73===a.status)if(a.gzhead.name){o=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),M(e),o=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,P(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),0===l&&(a.gzindex=0,a.status=91)}else a.status=91;if(91===a.status)if(a.gzhead.comment){o=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),M(e),o=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,P(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>o&&(e.adler=s(e.adler,a.pending_buf,a.pending-o,o)),0===l&&(a.status=103)}else a.status=103;if(103===a.status&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&M(e),a.pending+2<=a.pending_buf_size&&(P(a,255&e.adler),P(a,e.adler>>8&255),e.adler=0,a.status=z)):a.status=z),0!==a.pending){if(M(e),0===e.avail_out)return a.last_flush=-1,d}else if(0===e.avail_in&&B(t)<=B(i)&&t!==c)return A(e,-5);if(666===a.status&&0!==e.avail_in)return A(e,-5);if(0!==e.avail_in||0!==a.lookahead||t!==h&&666!==a.status){var p=2===a.strategy?function(e,t){for(var i;;){if(0===e.lookahead&&(U(e),0===e.lookahead)){if(t===h)return O;break}if(e.match_length=0,i=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(L(e,!1),0===e.strm.avail_out))return O}return e.insert=0,t===c?(L(e,!0),0===e.strm.avail_out?D:T):e.last_lit&&(L(e,!1),0===e.strm.avail_out)?O:I}(a,t):3===a.strategy?function(e,t){for(var i,n,a,o,s=e.window;;){if(e.lookahead<=C){if(U(e),e.lookahead<=C&&t===h)return O;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=x&&0<e.strstart&&(n=s[a=e.strstart-1])===s[++a]&&n===s[++a]&&n===s[++a]){o=e.strstart+C;do{}while(n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&a<o);e.match_length=C-(o-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=x?(i=r._tr_tally(e,1,e.match_length-x),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(L(e,!1),0===e.strm.avail_out))return O}return e.insert=0,t===c?(L(e,!0),0===e.strm.avail_out?D:T):e.last_lit&&(L(e,!1),0===e.strm.avail_out)?O:I}(a,t):n[a.level].func(a,t);if(p!==D&&p!==T||(a.status=666),p===O||p===D)return 0===e.avail_out&&(a.last_flush=-1),d;if(p===I&&(1===t?r._tr_align(a):5!==t&&(r._tr_stored_block(a,0,0,!1),3===t&&(R(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),M(e),0===e.avail_out))return a.last_flush=-1,d}return t!==c?d:a.wrap<=0?1:(2===a.wrap?(P(a,255&e.adler),P(a,e.adler>>8&255),P(a,e.adler>>16&255),P(a,e.adler>>24&255),P(a,255&e.total_in),P(a,e.total_in>>8&255),P(a,e.total_in>>16&255),P(a,e.total_in>>24&255)):(N(a,e.adler>>>16),N(a,65535&e.adler)),M(e),0<a.wrap&&(a.wrap=-a.wrap),0!==a.pending?d:1)},i.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==E&&69!==t&&73!==t&&91!==t&&103!==t&&t!==z&&666!==t?A(e,u):(e.state=null,t===z?A(e,-3):d):u},i.deflateSetDictionary=function(e,t){var i,n,r,s,l,h,c,f,p=t.length;if(!e||!e.state)return u;if(2===(s=(i=e.state).wrap)||1===s&&i.status!==E||i.lookahead)return u;for(1===s&&(e.adler=o(e.adler,t,p,0)),i.wrap=0,p>=i.w_size&&(0===s&&(R(i.head),i.strstart=0,i.block_start=0,i.insert=0),f=new a.Buf8(i.w_size),a.arraySet(f,t,p-i.w_size,i.w_size,0),t=f,p=i.w_size),l=e.avail_in,h=e.next_in,c=e.input,e.avail_in=p,e.next_in=0,e.input=t,U(i);i.lookahead>=x;){for(n=i.strstart,r=i.lookahead-(x-1);i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+x-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++,--r;);i.strstart=n,i.lookahead=x-1,U(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=x-1,i.match_available=0,e.next_in=h,e.input=c,e.avail_in=l,i.wrap=s,d},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,i){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,i){t.exports=function(e,t){var i,n,a,r,o,s,l,h,c,d,u,f,p,m,v,g,w,b,y,_,k,x,C,S,E;i=e.state,n=e.next_in,S=e.input,a=n+(e.avail_in-5),r=e.next_out,E=e.output,o=r-(t-e.avail_out),s=r+(e.avail_out-257),l=i.dmax,h=i.wsize,c=i.whave,d=i.wnext,u=i.window,f=i.hold,p=i.bits,m=i.lencode,v=i.distcode,g=(1<<i.lenbits)-1,w=(1<<i.distbits)-1;e:do{p<15&&(f+=S[n++]<<p,p+=8,f+=S[n++]<<p,p+=8),b=m[f&g];t:for(;;){if(f>>>=y=b>>>24,p-=y,0==(y=b>>>16&255))E[r++]=65535&b;else{if(!(16&y)){if(!(64&y)){b=m[(65535&b)+(f&(1<<y)-1)];continue t}if(32&y){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}_=65535&b,(y&=15)&&(p<y&&(f+=S[n++]<<p,p+=8),_+=f&(1<<y)-1,f>>>=y,p-=y),p<15&&(f+=S[n++]<<p,p+=8,f+=S[n++]<<p,p+=8),b=v[f&w];i:for(;;){if(f>>>=y=b>>>24,p-=y,!(16&(y=b>>>16&255))){if(!(64&y)){b=v[(65535&b)+(f&(1<<y)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(k=65535&b,p<(y&=15)&&(f+=S[n++]<<p,(p+=8)<y&&(f+=S[n++]<<p,p+=8)),l<(k+=f&(1<<y)-1)){e.msg="invalid distance too far back",i.mode=30;break e}if(f>>>=y,p-=y,(y=r-o)<k){if(c<(y=k-y)&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(C=u,(x=0)===d){if(x+=h-y,y<_){for(_-=y;E[r++]=u[x++],--y;);x=r-k,C=E}}else if(d<y){if(x+=h+d-y,(y-=d)<_){for(_-=y;E[r++]=u[x++],--y;);if(x=0,d<_){for(_-=y=d;E[r++]=u[x++],--y;);x=r-k,C=E}}}else if(x+=d-y,y<_){for(_-=y;E[r++]=u[x++],--y;);x=r-k,C=E}for(;2<_;)E[r++]=C[x++],E[r++]=C[x++],E[r++]=C[x++],_-=3;_&&(E[r++]=C[x++],1<_&&(E[r++]=C[x++]))}else{for(x=r-k;E[r++]=E[x++],E[r++]=E[x++],E[r++]=E[x++],2<(_-=3););_&&(E[r++]=E[x++],1<_&&(E[r++]=E[x++]))}break}}break}}while(n<a&&r<s);n-=_=p>>3,f&=(1<<(p-=_<<3))-1,e.next_in=n,e.next_out=r,e.avail_in=n<a?a-n+5:5-(n-a),e.avail_out=r<s?s-r+257:257-(r-s),i.hold=f,i.bits=p}},{}],49:[function(e,t,i){var n=e("../utils/common"),a=e("./adler32"),r=e("./crc32"),o=e("./inffast"),s=e("./inftrees"),l=1,h=2,c=0,d=-2,u=1,f=852,p=592;function m(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function g(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=u,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(f),t.distcode=t.distdyn=new n.Buf32(p),t.sane=1,t.back=-1,c):d}function w(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,g(e)):d}function b(e,t){var i,n;return e&&e.state?(n=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?d:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,w(e))):d}function y(e,t){var i,n;return e?(n=new v,(e.state=n).window=null,(i=b(e,t))!==c&&(e.state=null),i):d}var _,k,x=!0;function C(e){if(x){var t;for(_=new n.Buf32(512),k=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(l,e.lens,0,288,_,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(h,e.lens,0,32,k,0,e.work,{bits:5}),x=!1}e.lencode=_,e.lenbits=9,e.distcode=k,e.distbits=5}function S(e,t,i,a){var r,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new n.Buf8(o.wsize)),a>=o.wsize?(n.arraySet(o.window,t,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(a<(r=o.wsize-o.wnext)&&(r=a),n.arraySet(o.window,t,i-a,r,o.wnext),(a-=r)?(n.arraySet(o.window,t,i-a,a,0),o.wnext=a,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0}i.inflateReset=w,i.inflateReset2=b,i.inflateResetKeep=g,i.inflateInit=function(e){return y(e,15)},i.inflateInit2=y,i.inflate=function(e,t){var i,f,p,v,g,w,b,y,_,k,x,E,z,O,I,D,T,A,B,R,M,L,P,N,F=0,U=new n.Buf8(4),W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return d;12===(i=e.state).mode&&(i.mode=13),g=e.next_out,p=e.output,b=e.avail_out,v=e.next_in,f=e.input,w=e.avail_in,y=i.hold,_=i.bits,k=w,x=b,L=c;e:for(;;)switch(i.mode){case u:if(0===i.wrap){i.mode=13;break}for(;_<16;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}if(2&i.wrap&&35615===y){U[i.check=0]=255&y,U[1]=y>>>8&255,i.check=r(i.check,U,2,0),_=y=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",i.mode=30;break}if(8!=(15&y)){e.msg="unknown compression method",i.mode=30;break}if(_-=4,M=8+(15&(y>>>=4)),0===i.wbits)i.wbits=M;else if(M>i.wbits){e.msg="invalid window size",i.mode=30;break}i.dmax=1<<M,e.adler=i.check=1,i.mode=512&y?10:12,_=y=0;break;case 2:for(;_<16;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}if(i.flags=y,8!=(255&i.flags)){e.msg="unknown compression method",i.mode=30;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=30;break}i.head&&(i.head.text=y>>8&1),512&i.flags&&(U[0]=255&y,U[1]=y>>>8&255,i.check=r(i.check,U,2,0)),_=y=0,i.mode=3;case 3:for(;_<32;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}i.head&&(i.head.time=y),512&i.flags&&(U[0]=255&y,U[1]=y>>>8&255,U[2]=y>>>16&255,U[3]=y>>>24&255,i.check=r(i.check,U,4,0)),_=y=0,i.mode=4;case 4:for(;_<16;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}i.head&&(i.head.xflags=255&y,i.head.os=y>>8),512&i.flags&&(U[0]=255&y,U[1]=y>>>8&255,i.check=r(i.check,U,2,0)),_=y=0,i.mode=5;case 5:if(1024&i.flags){for(;_<16;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}i.length=y,i.head&&(i.head.extra_len=y),512&i.flags&&(U[0]=255&y,U[1]=y>>>8&255,i.check=r(i.check,U,2,0)),_=y=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(w<(E=i.length)&&(E=w),E&&(i.head&&(M=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),n.arraySet(i.head.extra,f,v,E,M)),512&i.flags&&(i.check=r(i.check,f,E,v)),w-=E,v+=E,i.length-=E),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===w)break e;for(E=0;M=f[v+E++],i.head&&M&&i.length<65536&&(i.head.name+=String.fromCharCode(M)),M&&E<w;);if(512&i.flags&&(i.check=r(i.check,f,E,v)),w-=E,v+=E,M)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===w)break e;for(E=0;M=f[v+E++],i.head&&M&&i.length<65536&&(i.head.comment+=String.fromCharCode(M)),M&&E<w;);if(512&i.flags&&(i.check=r(i.check,f,E,v)),w-=E,v+=E,M)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;_<16;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}if(y!==(65535&i.check)){e.msg="header crc mismatch",i.mode=30;break}_=y=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=12;break;case 10:for(;_<32;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}e.adler=i.check=m(y),_=y=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=g,e.avail_out=b,e.next_in=v,e.avail_in=w,i.hold=y,i.bits=_,2;e.adler=i.check=1,i.mode=12;case 12:if(5===t||6===t)break e;case 13:if(i.last){y>>>=7&_,_-=7&_,i.mode=27;break}for(;_<3;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}switch(i.last=1&y,_-=1,3&(y>>>=1)){case 0:i.mode=14;break;case 1:if(C(i),i.mode=20,6!==t)break;y>>>=2,_-=2;break e;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=30}y>>>=2,_-=2;break;case 14:for(y>>>=7&_,_-=7&_;_<32;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",i.mode=30;break}if(i.length=65535&y,_=y=0,i.mode=15,6===t)break e;case 15:i.mode=16;case 16:if(E=i.length){if(w<E&&(E=w),b<E&&(E=b),0===E)break e;n.arraySet(p,f,v,E,g),w-=E,v+=E,b-=E,g+=E,i.length-=E;break}i.mode=12;break;case 17:for(;_<14;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}if(i.nlen=257+(31&y),y>>>=5,_-=5,i.ndist=1+(31&y),y>>>=5,_-=5,i.ncode=4+(15&y),y>>>=4,_-=4,286<i.nlen||30<i.ndist){e.msg="too many length or distance symbols",i.mode=30;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;_<3;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}i.lens[W[i.have++]]=7&y,y>>>=3,_-=3}for(;i.have<19;)i.lens[W[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,P={bits:i.lenbits},L=s(0,i.lens,0,19,i.lencode,0,i.work,P),i.lenbits=P.bits,L){e.msg="invalid code lengths set",i.mode=30;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;D=(F=i.lencode[y&(1<<i.lenbits)-1])>>>16&255,T=65535&F,!((I=F>>>24)<=_);){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}if(T<16)y>>>=I,_-=I,i.lens[i.have++]=T;else{if(16===T){for(N=I+2;_<N;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}if(y>>>=I,_-=I,0===i.have){e.msg="invalid bit length repeat",i.mode=30;break}M=i.lens[i.have-1],E=3+(3&y),y>>>=2,_-=2}else if(17===T){for(N=I+3;_<N;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}_-=I,M=0,E=3+(7&(y>>>=I)),y>>>=3,_-=3}else{for(N=I+7;_<N;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}_-=I,M=0,E=11+(127&(y>>>=I)),y>>>=7,_-=7}if(i.have+E>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=30;break}for(;E--;)i.lens[i.have++]=M}}if(30===i.mode)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=30;break}if(i.lenbits=9,P={bits:i.lenbits},L=s(l,i.lens,0,i.nlen,i.lencode,0,i.work,P),i.lenbits=P.bits,L){e.msg="invalid literal/lengths set",i.mode=30;break}if(i.distbits=6,i.distcode=i.distdyn,P={bits:i.distbits},L=s(h,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,P),i.distbits=P.bits,L){e.msg="invalid distances set",i.mode=30;break}if(i.mode=20,6===t)break e;case 20:i.mode=21;case 21:if(6<=w&&258<=b){e.next_out=g,e.avail_out=b,e.next_in=v,e.avail_in=w,i.hold=y,i.bits=_,o(e,x),g=e.next_out,p=e.output,b=e.avail_out,v=e.next_in,f=e.input,w=e.avail_in,y=i.hold,_=i.bits,12===i.mode&&(i.back=-1);break}for(i.back=0;D=(F=i.lencode[y&(1<<i.lenbits)-1])>>>16&255,T=65535&F,!((I=F>>>24)<=_);){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}if(D&&!(240&D)){for(A=I,B=D,R=T;D=(F=i.lencode[R+((y&(1<<A+B)-1)>>A)])>>>16&255,T=65535&F,!(A+(I=F>>>24)<=_);){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}y>>>=A,_-=A,i.back+=A}if(y>>>=I,_-=I,i.back+=I,i.length=T,0===D){i.mode=26;break}if(32&D){i.back=-1,i.mode=12;break}if(64&D){e.msg="invalid literal/length code",i.mode=30;break}i.extra=15&D,i.mode=22;case 22:if(i.extra){for(N=i.extra;_<N;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}i.length+=y&(1<<i.extra)-1,y>>>=i.extra,_-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;D=(F=i.distcode[y&(1<<i.distbits)-1])>>>16&255,T=65535&F,!((I=F>>>24)<=_);){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}if(!(240&D)){for(A=I,B=D,R=T;D=(F=i.distcode[R+((y&(1<<A+B)-1)>>A)])>>>16&255,T=65535&F,!(A+(I=F>>>24)<=_);){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}y>>>=A,_-=A,i.back+=A}if(y>>>=I,_-=I,i.back+=I,64&D){e.msg="invalid distance code",i.mode=30;break}i.offset=T,i.extra=15&D,i.mode=24;case 24:if(i.extra){for(N=i.extra;_<N;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}i.offset+=y&(1<<i.extra)-1,y>>>=i.extra,_-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=30;break}i.mode=25;case 25:if(0===b)break e;if(E=x-b,i.offset>E){if((E=i.offset-E)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=30;break}z=E>i.wnext?(E-=i.wnext,i.wsize-E):i.wnext-E,E>i.length&&(E=i.length),O=i.window}else O=p,z=g-i.offset,E=i.length;for(b<E&&(E=b),b-=E,i.length-=E;p[g++]=O[z++],--E;);0===i.length&&(i.mode=21);break;case 26:if(0===b)break e;p[g++]=i.length,b--,i.mode=21;break;case 27:if(i.wrap){for(;_<32;){if(0===w)break e;w--,y|=f[v++]<<_,_+=8}if(x-=b,e.total_out+=x,i.total+=x,x&&(e.adler=i.check=i.flags?r(i.check,p,x,g-x):a(i.check,p,x,g-x)),x=b,(i.flags?y:m(y))!==i.check){e.msg="incorrect data check",i.mode=30;break}_=y=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;_<32;){if(0===w)break e;w--,y+=f[v++]<<_,_+=8}if(y!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=30;break}_=y=0}i.mode=29;case 29:L=1;break e;case 30:L=-3;break e;case 31:return-4;default:return d}return e.next_out=g,e.avail_out=b,e.next_in=v,e.avail_in=w,i.hold=y,i.bits=_,(i.wsize||x!==e.avail_out&&i.mode<30&&(i.mode<27||4!==t))&&S(e,e.output,e.next_out,x-e.avail_out)?(i.mode=31,-4):(k-=e.avail_in,x-=e.avail_out,e.total_in+=k,e.total_out+=x,i.total+=x,i.wrap&&x&&(e.adler=i.check=i.flags?r(i.check,p,x,e.next_out-x):a(i.check,p,x,e.next_out-x)),e.data_type=i.bits+(i.last?64:0)+(12===i.mode?128:0)+(20===i.mode||15===i.mode?256:0),(0==k&&0===x||4===t)&&L===c&&(L=-5),L)},i.inflateEnd=function(e){if(!e||!e.state)return d;var t=e.state;return t.window&&(t.window=null),e.state=null,c},i.inflateGetHeader=function(e,t){var i;return e&&e.state&&2&(i=e.state).wrap?((i.head=t).done=!1,c):d},i.inflateSetDictionary=function(e,t){var i,n=t.length;return e&&e.state?0!==(i=e.state).wrap&&11!==i.mode?d:11===i.mode&&a(1,t,n,0)!==i.check?-3:S(e,t,n,n)?(i.mode=31,-4):(i.havedict=1,c):d},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,i){var n=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,i,l,h,c,d,u){var f,p,m,v,g,w,b,y,_,k=u.bits,x=0,C=0,S=0,E=0,z=0,O=0,I=0,D=0,T=0,A=0,B=null,R=0,M=new n.Buf16(16),L=new n.Buf16(16),P=null,N=0;for(x=0;x<=15;x++)M[x]=0;for(C=0;C<l;C++)M[t[i+C]]++;for(z=k,E=15;1<=E&&0===M[E];E--);if(E<z&&(z=E),0===E)return h[c++]=20971520,h[c++]=20971520,u.bits=1,0;for(S=1;S<E&&0===M[S];S++);for(z<S&&(z=S),x=D=1;x<=15;x++)if(D<<=1,(D-=M[x])<0)return-1;if(0<D&&(0===e||1!==E))return-1;for(L[1]=0,x=1;x<15;x++)L[x+1]=L[x]+M[x];for(C=0;C<l;C++)0!==t[i+C]&&(d[L[t[i+C]]++]=C);if(w=0===e?(B=P=d,19):1===e?(B=a,R-=257,P=r,N-=257,256):(B=o,P=s,-1),x=S,g=c,I=C=A=0,m=-1,v=(T=1<<(O=z))-1,1===e&&852<T||2===e&&592<T)return 1;for(;;){for(b=x-I,_=d[C]<w?(y=0,d[C]):d[C]>w?(y=P[N+d[C]],B[R+d[C]]):(y=96,0),f=1<<x-I,S=p=1<<O;h[g+(A>>I)+(p-=f)]=b<<24|y<<16|_,0!==p;);for(f=1<<x-1;A&f;)f>>=1;if(0!==f?(A&=f-1,A+=f):A=0,C++,0==--M[x]){if(x===E)break;x=t[i+d[C]]}if(z<x&&(A&v)!==m){for(0===I&&(I=z),g+=S,D=1<<(O=x-I);O+I<E&&!((D-=M[O+I])<=0);)O++,D<<=1;if(T+=1<<O,1===e&&852<T||2===e&&592<T)return 1;h[m=A&v]=z<<24|O<<16|g-c}}return 0!==A&&(h[g+A]=x-I<<24|64<<16),u.bits=z,0}},{"../utils/common":41}],51:[function(e,t,i){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,i){var n=e("../utils/common"),a=0,r=1;function o(e){for(var t=e.length;0<=--t;)e[t]=0}var s=0,l=29,h=256,c=h+1+l,d=30,u=19,f=2*c+1,p=15,m=16,v=7,g=256,w=16,b=17,y=18,_=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],k=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=new Array(2*(c+2));o(S);var E=new Array(2*d);o(E);var z=new Array(512);o(z);var O=new Array(256);o(O);var I=new Array(l);o(I);var D,T,A,B=new Array(d);function R(e,t,i,n,a){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=n,this.max_length=a,this.has_stree=e&&e.length}function M(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function L(e){return e<256?z[e]:z[256+(e>>>7)]}function P(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function N(e,t,i){e.bi_valid>m-i?(e.bi_buf|=t<<e.bi_valid&65535,P(e,e.bi_buf),e.bi_buf=t>>m-e.bi_valid,e.bi_valid+=i-m):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)}function F(e,t,i){N(e,i[2*t],i[2*t+1])}function U(e,t){for(var i=0;i|=1&e,e>>>=1,i<<=1,0<--t;);return i>>>1}function W(e,t,i){var n,a,r=new Array(p+1),o=0;for(n=1;n<=p;n++)r[n]=o=o+i[n-1]<<1;for(a=0;a<=t;a++){var s=e[2*a+1];0!==s&&(e[2*a]=U(r[s]++,s))}}function j(e){var t;for(t=0;t<c;t++)e.dyn_ltree[2*t]=0;for(t=0;t<d;t++)e.dyn_dtree[2*t]=0;for(t=0;t<u;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*g]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function H(e){8<e.bi_valid?P(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function V(e,t,i,n){var a=2*t,r=2*i;return e[a]<e[r]||e[a]===e[r]&&n[t]<=n[i]}function $(e,t,i){for(var n=e.heap[i],a=i<<1;a<=e.heap_len&&(a<e.heap_len&&V(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!V(t,n,e.heap[a],e.depth));)e.heap[i]=e.heap[a],i=a,a<<=1;e.heap[i]=n}function Z(e,t,i){var n,a,r,o,s=0;if(0!==e.last_lit)for(;n=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],a=e.pending_buf[e.l_buf+s],s++,0===n?F(e,a,t):(F(e,(r=O[a])+h+1,t),0!==(o=_[r])&&N(e,a-=I[r],o),F(e,r=L(--n),i),0!==(o=k[r])&&N(e,n-=B[r],o)),s<e.last_lit;);F(e,g,t)}function Y(e,t){var i,n,a,r=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,h=-1;for(e.heap_len=0,e.heap_max=f,i=0;i<l;i++)0!==r[2*i]?(e.heap[++e.heap_len]=h=i,e.depth[i]=0):r[2*i+1]=0;for(;e.heap_len<2;)r[2*(a=e.heap[++e.heap_len]=h<2?++h:0)]=1,e.depth[a]=0,e.opt_len--,s&&(e.static_len-=o[2*a+1]);for(t.max_code=h,i=e.heap_len>>1;1<=i;i--)$(e,r,i);for(a=l;i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],$(e,r,1),n=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=n,r[2*a]=r[2*i]+r[2*n],e.depth[a]=(e.depth[i]>=e.depth[n]?e.depth[i]:e.depth[n])+1,r[2*i+1]=r[2*n+1]=a,e.heap[1]=a++,$(e,r,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var i,n,a,r,o,s,l=t.dyn_tree,h=t.max_code,c=t.stat_desc.static_tree,d=t.stat_desc.has_stree,u=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,v=t.stat_desc.max_length,g=0;for(r=0;r<=p;r++)e.bl_count[r]=0;for(l[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<f;i++)v<(r=l[2*l[2*(n=e.heap[i])+1]+1]+1)&&(r=v,g++),l[2*n+1]=r,h<n||(e.bl_count[r]++,o=0,m<=n&&(o=u[n-m]),s=l[2*n],e.opt_len+=s*(r+o),d&&(e.static_len+=s*(c[2*n+1]+o)));if(0!==g){do{for(r=v-1;0===e.bl_count[r];)r--;e.bl_count[r]--,e.bl_count[r+1]+=2,e.bl_count[v]--,g-=2}while(0<g);for(r=v;0!==r;r--)for(n=e.bl_count[r];0!==n;)h<(a=e.heap[--i])||(l[2*a+1]!==r&&(e.opt_len+=(r-l[2*a+1])*l[2*a],l[2*a+1]=r),n--)}}(e,t),W(r,h,e.bl_count)}function X(e,t,i){var n,a,r=-1,o=t[1],s=0,l=7,h=4;for(0===o&&(l=138,h=3),t[2*(i+1)+1]=65535,n=0;n<=i;n++)a=o,o=t[2*(n+1)+1],++s<l&&a===o||(s<h?e.bl_tree[2*a]+=s:0!==a?(a!==r&&e.bl_tree[2*a]++,e.bl_tree[2*w]++):s<=10?e.bl_tree[2*b]++:e.bl_tree[2*y]++,r=a,h=(s=0)===o?(l=138,3):a===o?(l=6,3):(l=7,4))}function K(e,t,i){var n,a,r=-1,o=t[1],s=0,l=7,h=4;for(0===o&&(l=138,h=3),n=0;n<=i;n++)if(a=o,o=t[2*(n+1)+1],!(++s<l&&a===o)){if(s<h)for(;F(e,a,e.bl_tree),0!=--s;);else 0!==a?(a!==r&&(F(e,a,e.bl_tree),s--),F(e,w,e.bl_tree),N(e,s-3,2)):s<=10?(F(e,b,e.bl_tree),N(e,s-3,3)):(F(e,y,e.bl_tree),N(e,s-11,7));r=a,h=(s=0)===o?(l=138,3):a===o?(l=6,3):(l=7,4)}}o(B);var G=!1;function q(e,t,i,a){var r,o,l;N(e,(s<<1)+(a?1:0),3),o=t,l=i,H(r=e),P(r,l),P(r,~l),n.arraySet(r.pending_buf,r.window,o,l,r.pending),r.pending+=l}i._tr_init=function(e){G||(function(){var e,t,i,n,a,r=new Array(p+1);for(n=i=0;n<l-1;n++)for(I[n]=i,e=0;e<1<<_[n];e++)O[i++]=n;for(O[i-1]=n,n=a=0;n<16;n++)for(B[n]=a,e=0;e<1<<k[n];e++)z[a++]=n;for(a>>=7;n<d;n++)for(B[n]=a<<7,e=0;e<1<<k[n]-7;e++)z[256+a++]=n;for(t=0;t<=p;t++)r[t]=0;for(e=0;e<=143;)S[2*e+1]=8,e++,r[8]++;for(;e<=255;)S[2*e+1]=9,e++,r[9]++;for(;e<=279;)S[2*e+1]=7,e++,r[7]++;for(;e<=287;)S[2*e+1]=8,e++,r[8]++;for(W(S,c+1,r),e=0;e<d;e++)E[2*e+1]=5,E[2*e]=U(e,5);D=new R(S,_,h+1,c,p),T=new R(E,k,0,d,p),A=new R(new Array(0),x,0,u,v)}(),G=!0),e.l_desc=new M(e.dyn_ltree,D),e.d_desc=new M(e.dyn_dtree,T),e.bl_desc=new M(e.bl_tree,A),e.bi_buf=0,e.bi_valid=0,j(e)},i._tr_stored_block=q,i._tr_flush_block=function(e,t,i,n){var o,s,l=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return a;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return r;for(t=32;t<h;t++)if(0!==e.dyn_ltree[2*t])return r;return a}(e)),Y(e,e.l_desc),Y(e,e.d_desc),l=function(e){var t;for(X(e,e.dyn_ltree,e.l_desc.max_code),X(e,e.dyn_dtree,e.d_desc.max_code),Y(e,e.bl_desc),t=u-1;3<=t&&0===e.bl_tree[2*C[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=o&&(o=s)):o=s=i+5,i+4<=o&&-1!==t?q(e,t,i,n):4===e.strategy||s===o?(N(e,2+(n?1:0),3),Z(e,S,E)):(N(e,4+(n?1:0),3),function(e,t,i,n){var a;for(N(e,t-257,5),N(e,i-1,5),N(e,n-4,4),a=0;a<n;a++)N(e,e.bl_tree[2*C[a]+1],3);K(e,e.dyn_ltree,t-1),K(e,e.dyn_dtree,i-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),Z(e,e.dyn_ltree,e.dyn_dtree)),j(e),n&&H(e)},i._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(O[i]+h+1)]++,e.dyn_dtree[2*L(t)]++),e.last_lit===e.lit_bufsize-1},i._tr_align=function(e){var t;N(e,2,3),F(e,g,S),16===(t=e).bi_valid?(P(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,i){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,i){(function(e){!function(e,t){if(!e.setImmediate){var i,n,a,r,o=1,s={},l=!1,h=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,i="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick((function(){u(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,i=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=i,t}}()?(r="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",f,!1):e.attachEvent("onmessage",f),function(t){e.postMessage(r+t,"*")}):e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){u(e.data)},function(e){a.port2.postMessage(e)}):h&&"onreadystatechange"in h.createElement("script")?(n=h.documentElement,function(e){var t=h.createElement("script");t.onreadystatechange=function(){u(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):function(e){setTimeout(u,0,e)},c.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var a={callback:e,args:t};return s[o]=a,i(o),o++},c.clearImmediate=d}function d(e){delete s[e]}function u(e){if(l)setTimeout(u,0,e);else{var i=s[e];if(i){l=!0;try{!function(e){var i=e.callback,n=e.args;switch(n.length){case 0:i();break;case 1:i(n[0]);break;case 2:i(n[0],n[1]);break;case 3:i(n[0],n[1],n[2]);break;default:i.apply(t,n)}}(i)}finally{d(e),l=!1}}}}function f(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(r)&&u(+t.data.slice(r.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==L?L:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10));async function wa(e,t=new ga,i=""){for await(const[n,a]of e.entries()){const e=i?`${i}/${n}`:n;if("file"===a.kind){const i=await a.getFile();t.file(e,i)}else"directory"===a.kind&&await wa(a,t,e)}return t}async function ba(e){console.log("[exportZip]",e);(await wa(e)).generateAsync({type:"blob"}).then((e=>{F.saveAs(e,"page_craft_all_components_export.zip")}))}async function ya(e,t,i=""){const n=await ga.loadAsync(e);await async function(e,t,i=""){for(const a in e.files){const r=e.files[a],o=((i?`${i}/`:"")+a).split("/").filter((e=>e.length>0)),s=o.pop();let l=t;for(const e of o)try{l=await l.getDirectoryHandle(e,{create:!0})}catch(n){throw console.error("Error creating/accessing directory:",e,n),n}if(!r.dir)try{const e=await r.async("blob"),t=await l.getFileHandle(s,{create:!0}),i=await t.createWritable();await i.write(e),await i.close()}catch(n){throw console.error("Error writing file:",s,n),n}}}(n,t,i)}const _a=({isLoading:e,selectedPaths:t,basePath:i,selectedItems:n,enablePaste:a,handlePaste:r,handleCut:h,handleCopy:c,selectedItemsSet:d,files:u,emit:f})=>{const{t:p}=U(),m=o(),{handleCreateComponent:v,importComponentAllJson:g,exportComponentAllJson:w,exportComponentJson:b}=Se({isLoading:e,files:u,basePath:i,emit:f}),y=e=>{if(u.value.some((t=>t.name===e)))return window.$message.error("Filename already exists, please rename it!"),!0},_=async()=>{try{const t=await W({title:"Create Folder",value:`folder_${j(new Date).format("YYYYMMDD_HHmmss")}`});if(y(t))return;e.value=!0,await at.createDir({path:nt(i.value+"/"+t)}),f("refresh")}finally{e.value=!1}},k=async()=>{try{const t=n.value[0],a=await W({title:p("actions.rename"),value:t.name});if(y(a))return;e.value=!0,await at.renameEntry({fromPath:nt(i.value+"/"+t.name),toPath:nt(i.value+"/"+a)}),f("refresh")}finally{e.value=!1}},x=async()=>{try{e.value=!0,await at.deleteEntry({path:t.value})}finally{e.value=!1,f("refresh")}},E=()=>{window.$dialog.warning({title:p("actions.confirm"),content:p("msgs.are_you_sure_to_dele")+" component(s) ?",positiveText:p("actions.ok"),negativeText:p("actions.cancel"),onPositiveClick:()=>{x()},onNegativeClick:()=>{}})},z=async()=>{try{e.value=!0;const t=await fetch("./preset-components.json"),i=await t.json();await g(i)}finally{e.value=!1,f("refresh")}},{getCoverOption:O,isShowImageCropper:I,cropperEditingSrc:D,handleCropperSave:T,handleCropperCancel:A}=(({exportComponentJson:e})=>{const t=s(!1),i=s(""),n=s(null),a=s(null),r=e=>{const{src:r="",onComplete:o,onCancel:s}=e;i.value=r,n.value=o,a.value=s,t.value=!0},o=()=>{t.value=!1,i.value="",a.value=null,n.value=null},l=async(e,t)=>{e.meta.cover=t;const i=nt(e.basePath+"/"+e.name+"/cover.base64");t?await at.createFile({path:i,file:t,isOverride:!0}):await at.deleteEntry({path:i})};return{getCoverOption:t=>({label:" Cover",children:[{label:" Capture cover...",props:{onClick:async()=>{try{const i=await ma({async onCaptureStart(){C.emit(S.ON_COMP_PREVIEW,{item:await e(t),maximum:!0}),await ge(500)},quality:.7});r({src:i,onComplete(e){l(t,e)}}),C.emit(S.ON_COMP_PREVIEW_CLOSE,{maximum:!1})}catch(i){console.error(i),C.emit(S.ON_COMP_PREVIEW_CLOSE,{maximum:!1})}}}},{label:" Upload cover",props:{onClick:async()=>{const[e]=await window.showOpenFilePicker({types:[{description:" Cover Image",accept:{"image/*":[".png",".jpg",".jpeg",".gif",".webp"]}}]}),i=await e.getFile(),n=await Ce(i);l(t,n)}}},t.meta.cover&&{label:" Edit cover",props:{onClick:async()=>{r({src:t.meta.cover,onComplete(e){l(t,e)}})}}},t.meta.cover&&{label:" Remove cover",props:{onClick:async()=>{l(t,void 0)}}}].filter(Boolean)}),isShowImageCropper:t,cropperEditingSrc:i,handleCropperSave:e=>{"function"==typeof n.value&&n.value(e),o()},handleCropperCancel:()=>{"function"==typeof a.value&&n.value(),o()}}})({exportComponentJson:b}),B=l((()=>(n.value.length?n.value:u.value).filter((e=>xe.test(e.name))))),R=l((()=>{const t=B.value;if(!n.value.length)return[{label:` ${p("actions.add_component")}`,props:{onClick:v}},{label:" Create Folder",props:{onClick:_}},{label:" Refresh",props:{onClick:()=>f("refresh")}},{label:" Paste",props:{onClick:r},disabled:!a.value},{split:!0},{label:` ${p("actions.import")}/${p("actions.export")}`,children:[{label:` ${p("actions.import")} ${p("common.all_components")} Json (Flat)`,props:{onClick:()=>{(async()=>{try{const t=await window.$mcUtils.handleImportJson();e.value=!0,await g(t),window.$message.success("Import success!"),f("refresh")}finally{e.value=!1}})()}}},{label:` ${p("actions.export")} ${p("common.all_components")} Json (Flat)`,props:{onClick:async()=>{await w(t)}},disabled:!t.length},{split:!0},{label:` ${p("actions.import")} Current Folder Zip (Recursive)`,props:{onClick:async()=>{try{e.value=!0,await async function(e,t=""){const[i]=await window.showOpenFilePicker({types:[{description:"Zip Files",accept:{"application/zip":[".zip"]}}]}),n=await i.getFile();await ya(n,e,t)}(at.getRoot(),i.value),f("refresh")}finally{e.value=!1}}}},{label:` ${p("actions.import")} Folder (Recursive)`,props:{onClick:async()=>{try{e.value=!0,await async function(e,t=""){const i=await window.showDirectoryPicker();let n=e;if(t){const e=t.split("/").filter((e=>e.length>0));for(const t of e)n=await n.getDirectoryHandle(t,{create:!0})}await async function e(t,i){for await(const[n,a]of t)if("file"===a.kind){const e=await a.getFile(),t=await i.getFileHandle(n,{create:!0}),r=await t.createWritable();await r.write(e),await r.close()}else if("directory"===a.kind){const t=await i.getDirectoryHandle(n,{create:!0});await e(a,t)}}(i,n)}(at.getRoot(),i.value),f("refresh")}finally{e.value=!1}}}},{label:` ${p("actions.import")} Files`,props:{onClick:async()=>{try{e.value=!0,await async function(e,t=""){const i=await window.showOpenFilePicker({multiple:!0});let n=e;if(t){const e=t.split("/").filter((e=>e.length>0));for(const t of e)n=await n.getDirectoryHandle(t,{create:!0})}for(const a of i){const e=await a.getFile(),t=await n.getFileHandle(e.name,{create:!0}),i=await t.createWritable();await i.write(e),await i.close()}}(at.getRoot(),i.value),f("refresh")}finally{e.value=!1}}}},{label:` ${p("actions.export")} Current Folder Zip (Recursive)`,props:{onClick:async()=>{try{const e=await async function(e,t,i){const n=t.split("/").filter((e=>e.length));let a=e;for(const r of n){if("directory"!==a.kind)return null;{const e=await a.getDirectoryHandle(r,{create:!1}).catch((()=>null));if(!e&&n.indexOf(r)!==n.length-1)return null;if(!e)return null;a=e}}return a.kind===i?a:null}(at.getRoot(),i.value,"directory");if(!e)return void console.error("handle not found");await ba(e)}finally{e.value=!1}}}}]},{split:!0},{label:" Append Preset",props:{onClick:()=>{u.value.length?window.$dialog.warning({title:p("actions.confirm"),content:"This action will override same name component, continue?",positiveText:p("actions.ok"),negativeText:p("actions.cancel"),onPositiveClick:()=>{z()},onNegativeClick:()=>{}}):z()}}},{label:" "+p("common.default_board"),props:{class:m.curCompInStore?"":"active",onClick:async()=>{m.curCompInStore=null}}}];const o=1===n.value.length,s=o?n.value[0]:null,l=o&&!!s.meta;let d=!1;if(m.curCompInStore){const e=m.curCompInStore.id;d=l&&s.meta.id===e||!!t.find((t=>t.meta.id===e))}return[o&&{label:" Open",props:{onClick:()=>f("open",s)}},l&&{label:" "+p("actions.preview"),props:{onClick:async()=>{C.emit(S.ON_COMP_PREVIEW,{item:await b(s)})}}},l&&O(s),{split:!0},{label:` ${p("actions.cut")}`,props:{onClick:h},disabled:d},{label:` ${p("actions.copy")}`,props:{onClick:c}},l&&{label:` ${p("actions.duplicate")}...`,props:{onClick:()=>{(async t=>{try{const n=await W({title:p("actions.duplicate"),value:t.name.replace(xe,"")+"-1.comp"});if(y(n))return;e.value=!0;const a=nt(i.value+"/"+t.name),r=nt(i.value+"/"+n);await at.copyPaste({fromPaths:[a],toPathAbs:r});const o=we(),s={...t.meta,id:o,timeCreated:Date.now()};await Ee(r,"index.json",JSON.stringify(s)),f("refresh"),setTimeout((()=>{var e;null==(e=document.querySelector(`.mc-comp-item[data-name="${n}"]`))||e.click()}),100)}finally{e.value=!1}})(s)}}},l?{label:` ${p("actions.export")} JSON`,props:{onClick:()=>{(async e=>{const t=await H("",e.name);if(!t)return;const i=[await b(e)];window.$mcUtils.handleExportFile(t,JSON.stringify(i,null,2),".json")})(s)}}}:t.length?{label:` ${p("actions.export")} JSON`,props:{onClick:async()=>{await w(t)}}}:null,{split:!0},o&&{label:" "+p("actions.rename"),props:{onClick:k},disabled:d},{label:" "+p("actions.delete"),props:{onClick:E},disabled:d},d&&{html:`<div style="font-size: 12px; max-width: 150px; word-break: break-word">${p("msgs.bu_fen_xuan_xiang_bu")}</div>`,disabled:!0}].filter(Boolean)})),M=s(),L=l((()=>n.value.length>0));return{handleCreateFolder:_,handleRename:k,doDeleteSelected:x,confirmDelete:E,ctxMenuOptions:R,ctxMenuRef:M,handleShowCtxMenu:(e,t)=>{null!==e&&(void 0===e?n.value=[]:d.value.has(e)||(n.value=[e])),M.value.isShow=!1,setTimeout((()=>{M.value.showMenu(t)}))},enableAction:L,handleCreateComponent:v,handleDragStart:async({item:e,event:t})=>{if(!xe.test(e.name))return!1;window.$draggingComponentExportData=await b(e)},isShowImageCropper:I,cropperEditingSrc:D,handleCropperSave:T,handleCropperCancel:A}},ka=e=>(Y("data-v-13de45a4"),e=e(),X(),e),xa={key:0,class:"os-loading-container _absolute"},Ca={class:"explorer-actions vp-panel"},Sa={class:"action-group"},Ea=["title"],za=ka((()=>n("div",{class:"split-line"},null,-1))),Oa=["disabled"],Ia=["disabled"],Da=["disabled"],Ta=["disabled"],Aa=["disabled"],Ba=ka((()=>n("div",{class:"split-line"},null,-1))),Ra={class:"action-group"},Ma={class:"action-button-wrap"},La={class:"explorer-grid-view"},Pa=h(e({__name:"ComponentList",props:{files:{},isLoading:{type:Boolean},basePath:{}},emits:["open","update:isLoading","refresh"],setup(e,{emit:r}){const h=r,c=e,{basePath:d,files:f}=a(c),m=V(c,"isLoading",h),v=o(),{showSortMenu:k,sortOptions:C,filteredFiles:S}=(e=>{const t=s(!1),i=R("mc_explorer_component_sort_type",aa.birthTimeDesc,localStorage,{listenToStorageChanges:!1});return{isGridView:t,showSortMenu:s(!1),sortOptions:l((()=>[{label:"Name ",value:aa.name},{label:"Name ",value:aa.nameDesc},{label:"Created Time ",value:aa.birthTime},{label:"Created Time ",value:aa.birthTimeDesc}].map((e=>({label:e.label,props:{class:i.value===e.value?"active":"",onClick:()=>{i.value=e.value}}}))))),filteredFiles:l((()=>e.value.sort(ra[i.value])))}})(f),{selectedItems:E,selectedItemsSet:z,explorerContentRef:D,toggleSelect:T,toggleSelectAll:A,selectedPaths:B,selectionArea:M}=Ne({filteredFiles:S,basePath:d});x((()=>{M.value.on("beforestart",(({event:e})=>{var t;return!(null==(t=e.target)?void 0:t.closest(".mc-comp-item"))}))}));const{enablePaste:L,handleCut:P,handleCopy:N,handlePaste:F}=Fe({selectedPaths:B,basePath:d,isLoading:m,emit:h}),{handleCreateFolder:U,handleRename:W,confirmDelete:j,ctxMenuOptions:H,ctxMenuRef:Y,handleShowCtxMenu:X,enableAction:K,handleCreateComponent:G,handleDragStart:q,isShowImageCropper:J,cropperEditingSrc:Q,handleCropperSave:ee,handleCropperCancel:te}=_a({isLoading:m,selectedPaths:B,basePath:d,selectedItems:E,enablePaste:L,handlePaste:F,handleCut:P,handleCopy:N,selectedItemsSet:z,files:f,emit:h});ze(h);const{openComponent:ie}=Oe(),ne=e=>{var t,i;const n=nt(d.value+"/"+e.name);xe.test(n)?e.meta.id===(null==(t=v.curCompInStore)?void 0:t.id)&&e.basePath===(null==(i=v.curCompInStore)?void 0:i.basePath)||ie(e,n):h("open",e)},{handleOpenLocalDir:ae,localDirHistoryOptions:re}=Ue({emit:h});return(e,a)=>{const r=ht,o=_e,s=ct;return t(),i("div",{class:"comp-list-wrap",onContextmenu:a[15]||(a[15]=p((()=>{}),["prevent"]))},[g(I,{name:"fade"},{default:w((()=>[O(m)?(t(),i("div",xa,[g(r)])):u("",!0)])),_:1}),n("div",Ca,[n("div",Sa,[n("button",{class:"vp-button",onClick:a[0]||(a[0]=e=>O(G)()),title:e.$t("actions.add_component")},[g(o,{size:"16"},{default:w((()=>[g(O(vt))])),_:1})],8,Ea),n("button",{class:"vp-button",onClick:a[1]||(a[1]=(...e)=>O(U)&&O(U)(...e)),title:"Create Folder"},[g(o,{size:"16"},{default:w((()=>[g(O(je))])),_:1})]),za,n("button",{class:"vp-button",disabled:!O(K),onClick:a[2]||(a[2]=(...e)=>O(P)&&O(P)(...e)),title:"Cut"},[g(o,{size:"16"},{default:w((()=>[g(O(He))])),_:1})],8,Oa),n("button",{class:"vp-button",disabled:!O(K),onClick:a[3]||(a[3]=(...e)=>O(N)&&O(N)(...e)),title:"Copy"},[g(o,{size:"16"},{default:w((()=>[g(O(st))])),_:1})],8,Ia),n("button",{class:"vp-button",disabled:!O(L),onClick:a[4]||(a[4]=(...e)=>O(F)&&O(F)(...e)),title:"Paste"},[g(o,{size:"16"},{default:w((()=>[g(O(lt))])),_:1})],8,Da),n("button",{class:"vp-button",disabled:1!==O(E).length,onClick:a[5]||(a[5]=(...e)=>O(W)&&O(W)(...e)),title:"Rename"},[g(o,{size:"16"},{default:w((()=>[g(O(Ve))])),_:1})],8,Ta),n("button",{class:"vp-button",disabled:!O(K),onClick:a[6]||(a[6]=(...e)=>O(j)&&O(j)(...e)),title:"Delete"},[g(o,{size:"16"},{default:w((()=>[g(O($e))])),_:1})],8,Aa),Ba,g(s,{trigger:"hover",placement:"bottom-start",style:{padding:"0"}},{trigger:w((()=>[n("button",{class:"vp-button",title:"Open Local Folder",onClick:a[7]||(a[7]=(...e)=>O(ae)&&O(ae)(...e))},[g(o,{size:"16"},{default:w((()=>[g(O(Ze))])),_:1})])])),default:w((()=>[O(re).length?(t(),_(ot,{key:0,options:O(re),"is-static":"",class:"vp-panel"},null,8,["options"])):u("",!0)])),_:1})]),n("div",Ra,[n("div",Ma,[n("button",{class:"vp-button",title:"Toggle Sort",onClick:a[8]||(a[8]=e=>k.value=!0)},[g(o,{size:"16"},{default:w((()=>[g(O(Ye))])),_:1})]),g(I,{name:"fade-scale"},{default:w((()=>[g(ot,{visible:O(k),"onUpdate:visible":a[9]||(a[9]=e=>$(k)?k.value=e:null),options:O(C)},null,8,["visible","options"])])),_:1})]),n("button",{class:"vp-button",onClick:a[10]||(a[10]=(...e)=>O(A)&&O(A)(...e)),title:"Toggle Select All"},[g(o,{size:"16"},{default:w((()=>[g(O(Xe))])),_:1})]),n("button",{class:"vp-button",onClick:a[11]||(a[11]=e=>O(X)(null,e)),title:"Menu"},[g(o,{size:"16"},{default:w((()=>[g(O(Ot))])),_:1})])])]),n("div",{ref_key:"explorerContentRef",ref:D,class:"explorer-content",onClick:a[12]||(a[12]=e=>E.value=[]),onContextmenu:a[13]||(a[13]=p((e=>O(X)(void 0,e)),["prevent","stop"]))},[n("div",La,[(t(!0),i(b,null,y(O(S),(e=>(t(),_(fa,{class:"selectable",item:e,key:e.name,"data-name":e.name,checked:O(z).has(e),onOpen:ne,onSelect:O(T),onContextmenu:p((t=>O(X)(e,t)),["prevent","stop"]),onHandleDragStart:t=>O(q)({item:e,event:t})},null,8,["item","data-name","checked","onSelect","onContextmenu","onHandleDragStart"])))),128))]),(t(),_(Z,{to:"body"},[g(I,{name:"fade"},{default:w((()=>[g(We,{options:O(H),ref_key:"ctxMenuRef",ref:Y},null,8,["options"])])),_:1})]))],544),g(ai),g(ia,{visible:O(J),"onUpdate:visible":a[14]||(a[14]=e=>$(J)?J.value=e:null),src:O(Q),onOnSave:O(ee),onOnCancel:O(te)},null,8,["visible","src","onOnSave","onOnCancel"])],32)}}}),[["__scopeId","data-v-13de45a4"]]),Na={class:"mc-component-explorer"},Fa={class:"explorer-header vp-panel"},Ua={class:"nav-address"},Wa={class:"nav-wrap"},ja=["disabled"],Ha=["disabled"],Va=["disabled"],$a={class:"input-wrap"},Za=["placeholder"],Ya={key:0,class:"star-list"},Xa=["onClick","title","onContextmenu"],Ka={class:"explorer-content-wrap _scrollbar_mini"};const Ga=h(e({name:"InventoryModal",components:{TabLayout:Pe,DialogImageCropper:ia,PopFloat:ai,ViewPortWindow:ke,InventoryList:ti,Window16Regular:Pt,WindowArrowUp16Regular:Ut,Box20Regular:kt,ComponentExplorer:e({__name:"ComponentExplorer",setup(e){const{isLoading:a,filteredFiles:r,handleOpen:o,handleRefresh:s,basePathNormalized:l,starList:h,handleOpenPath:c,backHistory:f,goBack:m,forwardHistory:v,goForward:k,allowUp:C,goUp:S,basePath:E,toggleStar:z,isStared:I,filterText:D}=Ke({getListFn:async()=>{const e=await at.getList({path:E.value}),t=[];for(const i in e){const n=e[i];let a;xe.test(n.name)&&(a=await at.getFile({path:nt(E.value+"/"+n.name+"/index.json"),mode:"json"})||{},a.cover=await at.getFile({path:nt(E.value+"/"+n.name+"/cover.base64")})),t.push({...n,meta:a,basePath:E.value})}return t},openEntryFn:async({path:e})=>{const t=await at.getFile({path:e});console.log(t)}});return x((()=>{s()})),(e,x)=>{const T=_e;return t(),i("div",Na,[n("div",Fa,[n("div",Ua,[n("div",Wa,[n("button",{disabled:O(f).length<=1,class:"btn-action vp-button",onClick:x[0]||(x[0]=(...e)=>O(m)&&O(m)(...e)),title:"Back"},[g(T,{size:"16"},{default:w((()=>[g(O(Ge))])),_:1})],8,ja),n("button",{disabled:O(v).length<=0,class:"btn-action vp-button",onClick:x[1]||(x[1]=(...e)=>O(k)&&O(k)(...e)),title:"Forward"},[g(T,{size:"16"},{default:w((()=>[g(O(qe))])),_:1})],8,Ha),n("button",{class:"btn-action vp-button",disabled:!O(C),onClick:x[2]||(x[2]=(...e)=>O(S)&&O(S)(...e)),title:"Up"},[g(T,{size:"16"},{default:w((()=>[g(O(Je))])),_:1})],8,Va)]),n("div",$a,[K(n("input",{placeholder:`Filter name in ${O(E)}`,"onUpdate:modelValue":x[3]||(x[3]=e=>$(D)?D.value=e:null),class:"input-addr vp-input"},null,8,Za),[[G,O(D)]]),n("button",{class:"vp-button btn-action",onClick:x[4]||(x[4]=(...e)=>O(s)&&O(s)(...e))},[g(T,{size:"16"},{default:w((()=>[g(O(Qe))])),_:1})]),n("button",{class:"vp-button btn-action",onClick:x[5]||(x[5]=(...e)=>O(z)&&O(z)(...e))},[g(T,{size:"16"},{default:w((()=>[O(I)?(t(),_(O(et),{key:0})):(t(),_(O(tt),{key:1}))])),_:1})])]),O(h).length?(t(),i("div",Ya,[(t(!0),i(b,null,y(O(h),((e,a)=>(t(),i("div",{key:e},[n("button",{onClick:t=>O(c)(e),class:"vp-button",title:e,onContextmenu:p((()=>O(h).splice(a,1)),["prevent"])},d(O(rt)(e)),41,Xa)])))),128))])):u("",!0)])]),n("div",Ka,[g(Pa,{"is-loading":O(a),"onUpdate:isLoading":x[6]||(x[6]=e=>$(a)?a.value=e:null),files:O(r),onOpen:O(o),onRefresh:O(s),"base-path":O(l)},null,8,["is-loading","files","onOpen","onRefresh","base-path"])])])}}})},props:{visible:{type:Boolean,default:!1}},emits:["onItemClick","update:visible"],setup(e,{emit:t}){U();const i=ye(e,t,"visible"),n=r(),a=o(),{play:s}=Ie();return z((()=>a.inventoryTab),(()=>{s()})),{mainStore:n,settingsStore:a,mVisible:i,BlockType:q,TabType:J,actionBlockItemList:Q,htmlBlockItemList:ee,colorHash:me,playSfxPop:s}}}),[["render",function(e,i,a,r,o,s){const l=m("Box20Regular"),h=_e,c=m("Window16Regular"),p=m("WindowArrowUp16Regular"),v=m("InventoryList"),b=m("ComponentExplorer"),y=m("TabLayout"),k=m("ViewPortWindow");return t(),_(k,{class:f(["inventory-modal",{_topLayout:e.settingsStore.enableTopLayout,_docked:e.settingsStore.isInvDocked}]),visible:e.mVisible,"onUpdate:visible":i[4]||(i[4]=t=>e.mVisible=t),wid:"inv","init-win-options":{height:"400px"},"allow-move":!e.settingsStore.isInvDocked},{titleBarLeft:w((()=>[g(h,{class:"window-icon",size:"18"},{default:w((()=>[g(l)])),_:1}),te(d(e.$t("common.inventory_list")),1)])),titleBarRightControls:w((()=>[n("button",{onClick:i[0]||(i[0]=t=>e.settingsStore.isInvDocked=!e.settingsStore.isInvDocked)},[g(h,{size:"16"},{default:w((()=>[e.settingsStore.isInvDocked?(t(),_(p,{key:1})):(t(),_(c,{key:0}))])),_:1})])])),default:w((()=>[g(y,{modelValue:e.settingsStore.inventoryTab,"onUpdate:modelValue":i[3]||(i[3]=t=>e.settingsStore.inventoryTab=t),"tab-list":[{label:`Tools (${e.actionBlockItemList.length})`,value:e.TabType.TOOLS},{label:`HTML (${e.htmlBlockItemList.length})`,value:e.TabType.HTML_ELEMENTS},{label:e.$t("common.components"),value:e.TabType.COMPONENTS}]},{default:w((()=>[e.settingsStore.inventoryTab===e.TabType.TOOLS?(t(),_(v,{key:0,"item-list":e.actionBlockItemList,onOnItemClick:i[1]||(i[1]=t=>e.$emit("onItemClick",t))},null,8,["item-list"])):e.settingsStore.inventoryTab===e.TabType.HTML_ELEMENTS?(t(),_(v,{key:1,"item-list":e.htmlBlockItemList,onOnItemClick:i[2]||(i[2]=t=>e.$emit("onItemClick",t))},null,8,["item-list"])):e.settingsStore.inventoryTab===e.TabType.COMPONENTS?(t(),_(b,{key:2})):u("",!0)])),_:1},8,["modelValue","tab-list"])])),_:1},8,["visible","class","allow-move"])}],["__scopeId","data-v-e3a15992"]]),qa=e({name:"VStyle",render(){var e,t;return ie("style",null==(t=(e=this.$slots).default)?void 0:t.call(e))}}),Ja=e({name:"DomPreview",components:{VStyle:qa},props:{id:{type:String,default:""},style:{type:String,default:""}},emits:["styleCompiled"],setup(e,{emit:t}){const{style:i,id:n}=a(e),r=s(""),o=l((()=>n.value?n.value:"dom_preview_temp_id"));return z(i,(async e=>{try{r.value=await ne(`div[data-app-name="${o.value}"] { ${e} }`)}catch(i){console.error(i),r.value=""}T((()=>{t("styleCompiled")}))}),{immediate:!0}),{styleRewrote:r,mId:o}}}),Qa=["data-app-name"];const er=e({name:"PopWindow",components:{ViewPortWindow:ke,DomPreview:h(Ja,[["render",function(e,n,a,r,o,s){const l=m("VStyle");return t(),i("div",{"data-app-name":e.mId},[g(l,{id:e.mId},{default:w((()=>[te(d(e.styleRewrote),1)])),_:1},8,["id"]),v(e.$slots,"default")],8,Qa)}]])},emits:["update:visible"],setup(e,{emit:t}){const i=s(!1),n=s(null);x((()=>{C.on(S.ON_COMP_PREVIEW,r),C.on(S.ON_COMP_PREVIEW_CLOSE,o)})),E((()=>{C.off(S.ON_COMP_PREVIEW,r),C.off(S.ON_COMP_PREVIEW_CLOSE,o)}));const a=s(),r=e=>{const{item:t,maximum:r=!1}=e||{};n.value=t,a.value.isMaximized=r,i.value=!0},o=e=>{const{maximum:t=!1}=e||{};a.value.isMaximized=t,i.value=!1};return{previewWinRef:a,mVisible:i,previewData:n}}}),tr=["innerHTML"];const ir=h(er,[["render",function(e,i,a,r,o,s){const l=m("DomPreview"),h=m("ViewPortWindow");return t(),_(h,{ref:"previewWinRef",class:"preview-dialog",visible:e.mVisible,"onUpdate:visible":i[0]||(i[0]=t=>e.mVisible=t),wid:"preview","allow-maximum":"","init-win-options":{width:"500px",height:"500px"}},{titleBarLeft:w((()=>{var t;return[te(d(e.$t("actions.preview"))+": "+d(null==(t=e.previewData)?void 0:t.name),1)]})),default:w((()=>[e.previewData&&e.mVisible?(t(),_(l,{key:0,id:e.previewData.id,style:c(e.previewData.style)},{default:w((()=>[n("div",{innerHTML:e.previewData.html},null,8,tr)])),_:1},8,["id","style"])):u("",!0)])),_:1},8,["visible"])}],["__scopeId","data-v-8ff6fd1f"]]),nr=["onKeyup"],ar=h(e({__name:"InputAutoTips",props:{modelValue:{},hid:{}},emits:["update:modelValue","onSelectTip","historyChanged"],setup(e,{emit:a}){const r=e,o=a,h=V(r,"modelValue",o),d=R(`mc_input_history_${r.hid}`,[]),u=l((()=>{const e=new Set;return d.value.forEach((t=>{e.add(t.label)})),e}));z(d,(e=>{o("historyChanged",e)}),{immediate:!0});const f=()=>{const e=h.value;e&&!u.value.has(e)&&d.value.push({label:e,count:0})},m=s([]),v=()=>{let e=d.value;const t=h.value;t&&(e=e.filter((e=>e.label.toLowerCase().includes(t))).sort(((e,t)=>t.count-e.count)));const i=e.slice(0,9).map((e=>({label:`${e.label} (${e.count})`,props:{onClick:()=>{h.value=e.label,e.count++,o("onSelectTip",e.label),P()},onContextmenu:()=>{window.$dialog.warning({title:"Delete history item?",positiveText:"OK",negativeText:"Cancel",onPositiveClick:async()=>{const t=d.value.findIndex((t=>t.label===e.label));-1!==t&&(d.value.splice(t,1),v())},onNegativeClick:()=>{}})}}})));S(),i.length?m.value=[...i,{label:" Clear History",props:{onClick:()=>{window.$dialog.warning({title:"Confirm clear history?",positiveText:"OK",negativeText:"Cancel",onPositiveClick:()=>{d.value=[],v(),P()},onNegativeClick:()=>{}})}}}]:m.value=[]};ae(h,(()=>{v()}),{debounce:300,immediate:!0});const{menuRef:b,ctxMenuStyle:y,showMenuByPoint:k,isShow:x,updateCardSize:C}=it({getExtraSize(){const{height:e}=E.value.getBoundingClientRect();return{height:e,width:0}}}),S=M((()=>{C()}),300,!0),E=s(),D=s(),T=()=>{if(x.value)return;const e=D.value.getBoundingClientRect();k(e.x,e.y+e.height)},B=()=>{T(),setTimeout((()=>{var e;null==(e=b.value)||e.focus()}))},L=()=>{setTimeout((()=>{var e;(null==(e=b.value)?void 0:e.isFocused())&&(x.value=!1)}),100)},P=()=>{setTimeout((()=>{E.value.focus(),L()}),100)},N=()=>{f(),v(),L()};return(e,a)=>(t(),i("div",{ref_key:"rootRef",ref:D,class:"mc-input-auto-tips"},[(t(),_(Z,{to:".page-craft-root"},[g(I,{name:"mc-fade-scale"},{default:w((()=>[g(ot,{ref_key:"menuRef",ref:b,style:c({...O(y),transition:"all .2s"}),class:"auto-tips-wrap",options:O(m),visible:O(x),"onUpdate:visible":a[0]||(a[0]=e=>$(x)?x.value=e:null),"auto-focus":!1,"close-on-click":!1,onOnClose:P},null,8,["style","options","visible"])])),_:1})])),K(n("input",re({ref_key:"inputRef",ref:E,"onUpdate:modelValue":a[1]||(a[1]=e=>$(h)?h.value=e:null),type:"text",placeholder:"CSS class",class:"vp-input sl-css-class-input"},e.$attrs,{onFocus:T,onClick:T,onBlur:N,onKeyup:[a[2]||(a[2]=A((e=>h.value=""),["esc"])),A(p(f,["stop"]),["enter"]),A(p(B,["prevent"]),["up"]),A(p(B,["prevent"]),["down"])],onInput:T}),null,16,nr),[[G,O(h)]])],512))}}),[["__scopeId","data-v-ff5bc952"]]),rr={$monacoClassNameHistory:[],$monacoScssVariables:[],$monacoScssSnippets:[],$monacoScssSnippetsCustom:[]};dt.languages.registerCompletionItemProvider("scss",{triggerCharacters:[".","$","`"],provideCompletionItems:(e,t)=>{const i=()=>({insertTextRules:dt.languages.CompletionItemInsertTextRule.InsertAsSnippet,range:new dt.Range(t.lineNumber,1,t.lineNumber,t.column)}),n=(e=[])=>(e||[]).map((e=>{let t=e.label.toLowerCase();return/^\./g.test(t)||(t="`"+t),{...i(),label:t,insertText:e.snippet,kind:dt.languages.CompletionItemKind.Snippet}}));return{suggestions:[...((e=[])=>(e||[]).map((e=>{let t="";return e.label.split(" ").forEach((e=>{t+="."+e})),{...i(),kind:dt.languages.CompletionItemKind.Keyword,label:`${t}`,insertText:`${t} {\n  \${1:}\n}`}})))(rr.$monacoClassNameHistory),...((e=[])=>(e||[]).map((e=>({...i(),label:e,insertText:e,kind:dt.languages.CompletionItemKind.Variable}))))(rr.$monacoScssVariables),...n(rr.$monacoScssSnippets),...n(rr.$monacoScssSnippetsCustom)]}}});const or=e({name:"BottomToolBar",components:{ClassNameInput:e({__name:"ClassNameInput",setup(e){const a=r(),o=()=>{const e=a.className;if(!e)return;let t="";e.split(" ").forEach((e=>{t+="."+e}));const i=`\n${t} {\n}\n`;C.emit(S.ON_ADD_STYLE,{code:i,isAppend:!1}),a.className=""},s=e=>{rr.$monacoClassNameHistory=e};return(e,r)=>(t(),i(b,null,[g(ar,{modelValue:O(a).className,"onUpdate:modelValue":r[0]||(r[0]=e=>O(a).className=e),class:"sl-css-class-input font-code",title:"Focus shortcut: alt+1\nPress enter to insert css class\nInput without dot(.)",hid:"class",onKeyup:A(o,["enter"]),onHistoryChanged:s},null,8,["modelValue","title"]),K(n("input",{type:"text","onUpdate:modelValue":r[1]||(r[1]=e=>O(a).innerText=e),placeholder:"innerHTML | src | value",title:"Focus shortcut: alt+2\nPress esc to clear",class:"vp-input sl-inner-html-input font-code",onKeyup:r[2]||(r[2]=A((e=>O(a).innerText=""),["esc"]))},null,544),[[G,O(a).innerText]])],64))}}),PreviewWindow:ir,ToolItem:$t,InventoryModal:Ga,ArrowReset20Regular:bt,Box20Regular:kt,Toolbox20Regular:Rt},setup(e,{emit:t}){U(),le();const i=r(),n=o(),a=R(oe.TOOL_BAR_LIST,[...se]),l=s(-1),h=e=>{l.value=e,setTimeout((()=>{l.value=-1}),200)},c=e=>{i.setCurrentBlock(e),d()},{play:d,stop:u}=De();z((()=>n.toolbarIndex),(e=>{c(a.value[e]),u(),d()}));const f=()=>{n.toolbarIndex!==a.value.length-1?n.toolbarIndex+=1:n.toolbarIndex=0},p=()=>{n.toolbarIndex<=0?n.toolbarIndex=a.value.length-1:n.toolbarIndex-=1},m=e=>{e.preventDefault(),e.deltaY>0?f():p()},v=e=>{e.shiftKey&&(e.deltaY>0?f():p())},g=s();E((()=>{c(a.value[n.toolbarIndex])})),x((()=>{document.addEventListener("wheel",v),g.value.addEventListener("wheel",m,{passive:!1})})),E((()=>{document.removeEventListener("wheel",v),g.value.removeEventListener("wheel",m)}));const w=s(!0);return Te((()=>n.showInventory)),{settingsStore:n,toolbarRef:g,toolBarList:a,mainStore:i,setCurrentToolItem:e=>{const t=[...a.value];t.splice(n.toolbarIndex,1,e),a.value=t,c(e),h(n.toolbarIndex)},handleToolItemClick:(e,t)=>{n.toolbarIndex=t,d()},resetToolbar(){a.value=[...se],c(a.value[n.toolbarIndex]),window.$message.success("Toolbar reset success!")},handleDragStart:(e,t,i)=>{e.dataTransfer.setData("data-index",t),e.dataTransfer.setData("data-block",JSON.stringify(i))},switchItemsPosition:(e,t)=>{const i=Number(e.dataTransfer.getData("data-index"))||n.toolbarIndex,r=[...a.value];[r[t],r[i]]=[r[i],r[t]],a.value=r,i===n.toolbarIndex&&(n.toolbarIndex=t),h(t)},blinkAnimIndex:l,isShowPreviewDialog:w}}}),sr={ref:"toolbarRef",class:"mc-toolbar vp-panel vp-window-panel _panel-bg"},lr={class:"mc-toolbar-above"},hr={class:"mc-toolbar-group"},cr={class:"mc-toolbar-group"},dr={class:"mc-toolbar-main _scrollbar_mini"};const ur=h(or,[["render",function(e,a,r,o,s,l){const h=m("PreviewWindow"),c=m("InventoryModal"),p=m("portal-target"),k=m("ClassNameInput"),x=m("ArrowReset20Regular"),C=_e,S=he,E=ut,z=m("Box20Regular"),O=m("Toolbox20Regular"),I=m("ToolItem");return t(),i(b,null,[g(h),e.settingsStore.isInvDocked?u("",!0):(t(),_(c,{key:0,visible:e.settingsStore.showInventory,"onUpdate:visible":a[0]||(a[0]=t=>e.settingsStore.showInventory=t),onOnItemClick:e.setCurrentToolItem},null,8,["visible","onOnItemClick"])),n("div",{class:f(["page-craft-toolbar-root",{_topLayout:e.settingsStore.enableTopLayout}])},[e.settingsStore.isInvDocked?(t(),_(c,{key:0,visible:e.settingsStore.showInventory,"onUpdate:visible":a[1]||(a[1]=t=>e.settingsStore.showInventory=t),onOnItemClick:e.setCurrentToolItem},null,8,["visible","onOnItemClick"])):u("",!0),n("div",sr,[n("div",lr,[n("div",hr,[g(p,{name:"indicatorBarTeleportDest"}),g(k)]),n("div",cr,[g(E,{onPositiveClick:e.resetToolbar},{trigger:w((()=>[g(S,{secondary:"",size:"tiny"},{icon:w((()=>[g(C,{size:"18"},{default:w((()=>[g(x)])),_:1})])),_:1})])),default:w((()=>[te(" "+d(e.$t("msgs.confirm_reset_toolba")),1)])),_:1},8,["onPositiveClick"]),g(S,{style:{"min-width":"80px"},size:"tiny",onClick:a[2]||(a[2]=t=>e.settingsStore.showInventory=!e.settingsStore.showInventory),title:"(alt+a)"},{icon:w((()=>[e.settingsStore.showInventory?(t(),_(C,{key:0,size:"18"},{default:w((()=>[g(z)])),_:1})):u("",!0)])),default:w((()=>[te(" "+d(e.$t("common.inventory")),1)])),_:1}),v(e.$slots,"default"),g(S,{size:"tiny",onClick:a[3]||(a[3]=t=>e.mainStore.isShowQuickLaunch=!e.mainStore.isShowQuickLaunch)},{icon:w((()=>[g(C,{size:"18"},{default:w((()=>[g(O)])),_:1})])),default:w((()=>[te(" "+d(e.$t("common.toolbox")),1)])),_:1})])]),n("div",dr,[(t(!0),i(b,null,y(e.toolBarList,((i,n)=>(t(),_(I,{key:n,item:i,class:f({blinkFast:e.blinkAnimIndex===n}),onClick:t=>e.handleToolItemClick(i,n),active:e.settingsStore.toolbarIndex===n,onOnDragStart:t=>e.handleDragStart(t,n,i),onOnDrop:t=>e.switchItemsPosition(t,n)},null,8,["item","class","onClick","active","onOnDragStart","onOnDrop"])))),128))])],512),v(e.$slots,"end")],2)],64)}]]),fr=h(e({__name:"CraftPage",setup(e){const a=fe((()=>pe((()=>import("./index-Btt2M_SS.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39]),import.meta.url))),{t:l}=U(),h=o(),c=r(),{play:p}=Ae(),{play:m}=Be();Te((()=>h.showStyleEditor)),Re((()=>c.selecting)),z((()=>h.enableSoundFx),(()=>{window.$dialog.warning({title:l("msgs.refresh_page"),positiveText:l("actions.ok"),negativeText:l("actions.cancel"),onPositiveClick:()=>{location.reload()},onNegativeClick:()=>{}})})),ce(document,"keydown",(e=>{const t=e.key.toLowerCase();if(e.altKey&&"a"===t&&!e.ctrlKey)h.showInventory=!h.showInventory;else if(e.altKey&&"s"===t&&!e.ctrlKey)h.showStyleEditor=!h.showStyleEditor;else if(e.altKey&&"w"===t)c.isShowSettings=!c.isShowSettings;else if(e.altKey&&"1"===t){const e=document.querySelector(".sl-css-class-input input");e&&e.focus()}else if(e.altKey&&"2"===t){const e=document.querySelector(".sl-inner-html-input input");e&&e.focus()}}));const{loadCurCompStyle:v,saveCurCompStyle:y}=Oe(),k=[{label:" "+l("actions.copy_compiled_css"),props:{onClick:async()=>{const e=await v(),t=Me(await ne(e));await be(t)}}}],C=s(),E=s(!1),I=s("");z(I,(async()=>{E.value&&await y(I.value)}));const D=async()=>{E.value=!1,I.value=await v(),setTimeout((()=>{E.value=!0}),100)};return x((async()=>{await D()})),z((()=>h.curCompInStore),(async()=>{await D()})),de(S.IMPORT_SUCCESS,D),de(S.ON_ADD_STYLE,(e=>{C.value.handleAddStyle(e)})),(e,r)=>{const o=_e,s=he,v=ft;return t(),i(b,null,[n("div",{class:f(["page-craft-home-view",{_topLayout:O(h).enableTopLayout}])},[g(Le),g(ur,null,{end:w((()=>[])),default:w((()=>[g(v,{options:k,"key-field":"label",placement:"bottom-start",trigger:"hover"},{default:w((()=>[g(s,{size:"tiny",style:{"min-width":"70px"},onClick:r[0]||(r[0]=e=>O(h).showStyleEditor=!O(h).showStyleEditor),title:"(alt+s)"},{icon:w((()=>[O(h).showStyleEditor?(t(),_(o,{key:0,size:"18"},{default:w((()=>[g(O(Tt))])),_:1})):u("",!0)])),default:w((()=>[te(d(O(l)("common.style")),1)])),_:1})])),_:1})])),_:1})],2),g(O(a),{ref_key:"styleEditorRef",ref:C,visible:O(h).showStyleEditor,"onUpdate:visible":r[1]||(r[1]=e=>O(h).showStyleEditor=e),selecting:O(c).selecting,"onUpdate:selecting":r[2]||(r[2]=e=>O(c).selecting=e),styleCode:O(I),"onUpdate:styleCode":r[3]||(r[3]=e=>$(I)?I.value=e:null),"selecting-parent-class":O(ue),onOnFormat:O(p),onOnInsertCode:O(m),"show-tabs":""},null,8,["visible","selecting","styleCode","selecting-parent-class","onOnFormat","onOnInsertCode"])],64)}}}),[["__scopeId","data-v-67b72516"]]),pr=Object.freeze(Object.defineProperty({__proto__:null,default:fr},Symbol.toStringTag,{value:"Module"}));export{pr as C,rr as m};
