import{b as rt,c as $n,D as Do,d as xn,e as Tn,a as Rt,_ as Rn,u as Io,i as Oo,v as Ao}from"./file-history-G6BBEG6w.js";import{d as le,X as C,Y as Eo,Z as Ko,$ as Lo,a0 as on,a1 as lt,a2 as O,a3 as j,a4 as Ne,r as D,a5 as Nt,a6 as Pt,a7 as Nn,m as U,a8 as Ft,a9 as Dt,aa as Z,ab as de,ac as Pn,ad as Bo,ae as Pe,af as We,ag as H,ah as pt,ai as ie,aj as Mo,ak as zo,M as jo,al as _t,am as Ho,an as fe,o as It,ao as Vo,ap as an,aq as Fn,ar as Uo,as as rn,at as Le,au as Go,av as qo,aw as Ue,w as be,ax as kt,ay as ln,az as Wo,aA as Ge,aB as sn,aC as Yo,aD as Jo,aE as ve,aF as dn,aG as Xo,aH as cn,c as N,x as W,B as oe,aI as ot,aJ as Ot,aK as Qo,aL as xt,aM as Tt,l as At,g as Et,aN as Kt,aO as Zo,i as Dn,aP as ea,V as Lt,aQ as ta,b as Je,aR as Ye,e as re,z as P,y as K,C as _e,I as J,J as Te,H as q,N as Bt,aS as In,aT as na,P as On,E as An,K as at,aU as En,aV as oa,F as Kn,G as Ln,aW as Bn,h as aa,L as ra,j as un,aX as la,k as ia,U as sa,W as da,S as ca,aY as ua,A as fn,D as Ct,aZ as fa,a_ as ha,Q as va,a$ as ga}from"./index-318Yy3CW.js";import{d as Mt,_ as Mn,u as ya,a as ba,c as ma,b as pa}from"./use-meta-ZuvfTi5J.js";import{_ as _a,a as ka}from"./Tabs-2Ku8Qeta.js";function zn(e){return typeof e=="string"?`s-${e}`:`n-${e}`}const Ca=le({name:"Switcher",render(){return C("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},C("path",{d:"M12 8l10 8l-10 8z"}))}}),Sa=e=>{const{baseColor:t,textColor2:n,bodyColor:a,cardColor:r,dividerColor:l,actionColor:d,scrollbarColor:f,scrollbarColorHover:h,invertedColor:s}=e;return{textColor:n,textColorInverted:"#FFF",color:a,colorEmbedded:d,headerColor:r,headerColorInverted:s,footerColor:d,footerColorInverted:s,headerBorderColor:l,headerBorderColorInverted:s,footerBorderColor:l,footerBorderColorInverted:s,siderBorderColor:l,siderBorderColorInverted:s,siderColor:r,siderColorInverted:s,siderToggleButtonBorder:`1px solid ${l}`,siderToggleButtonColor:t,siderToggleButtonIconColor:n,siderToggleButtonIconColorInverted:n,siderToggleBarColor:on(a,f),siderToggleBarColorHover:on(a,h),__invertScrollbar:"true"}},wa=Eo({name:"Layout",common:Ko,peers:{Scrollbar:Lo},self:Sa}),jn=wa,$a=lt("n-layout-sider"),Hn={type:String,default:"static"},xa=O("layout",`
 color: var(--n-text-color);
 background-color: var(--n-color);
 box-sizing: border-box;
 position: relative;
 z-index: auto;
 flex: auto;
 overflow: hidden;
 transition:
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[O("layout-scroll-container",`
 overflow-x: hidden;
 box-sizing: border-box;
 height: 100%;
 `),j("absolute-positioned",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 `)]),Ta={embedded:Boolean,position:Hn,nativeScrollbar:{type:Boolean,default:!0},scrollbarProps:Object,onScroll:Function,contentClass:String,contentStyle:{type:[String,Object],default:""},hasSider:Boolean,siderPlacement:{type:String,default:"left"}},Vn=lt("n-layout");function Un(e){return le({name:e?"LayoutContent":"Layout",props:Object.assign(Object.assign({},Ne.props),Ta),setup(t){const n=D(null),a=D(null),{mergedClsPrefixRef:r,inlineThemeDisabled:l}=Nt(t),d=Ne("Layout","-layout",xa,jn,t,r);function f(y,c){if(t.nativeScrollbar){const{value:u}=n;u&&(c===void 0?u.scrollTo(y):u.scrollTo(y,c))}else{const{value:u}=a;u&&u.scrollTo(y,c)}}Pt(Vn,t);let h=0,s=0;const k=y=>{var c;const u=y.target;h=u.scrollLeft,s=u.scrollTop,(c=t.onScroll)===null||c===void 0||c.call(t,y)};Nn(()=>{if(t.nativeScrollbar){const y=n.value;y&&(y.scrollTop=s,y.scrollLeft=h)}});const T={display:"flex",flexWrap:"nowrap",width:"100%",flexDirection:"row"},m={scrollTo:f},p=U(()=>{const{common:{cubicBezierEaseInOut:y},self:c}=d.value;return{"--n-bezier":y,"--n-color":t.embedded?c.colorEmbedded:c.color,"--n-text-color":c.textColor}}),g=l?Ft("layout",U(()=>t.embedded?"e":""),p,t):void 0;return Object.assign({mergedClsPrefix:r,scrollableElRef:n,scrollbarInstRef:a,hasSiderStyle:T,mergedTheme:d,handleNativeElScroll:k,cssVars:l?void 0:p,themeClass:g==null?void 0:g.themeClass,onRender:g==null?void 0:g.onRender},m)},render(){var t;const{mergedClsPrefix:n,hasSider:a}=this;(t=this.onRender)===null||t===void 0||t.call(this);const r=a?this.hasSiderStyle:void 0,l=[this.themeClass,e&&`${n}-layout-content`,`${n}-layout`,`${n}-layout--${this.position}-positioned`];return C("div",{class:l,style:this.cssVars},this.nativeScrollbar?C("div",{ref:"scrollableElRef",class:[`${n}-layout-scroll-container`,this.contentClass],style:[this.contentStyle,r],onScroll:this.handleNativeElScroll},this.$slots):C(Dt,Object.assign({},this.scrollbarProps,{onScroll:this.onScroll,ref:"scrollbarInstRef",theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar,contentClass:this.contentClass,contentStyle:[this.contentStyle,r]}),this.$slots))}})}const Ra=Un(!1),Na=Un(!0),Pa=O("layout-sider",`
 flex-shrink: 0;
 box-sizing: border-box;
 position: relative;
 z-index: 1;
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 min-width .3s var(--n-bezier),
 max-width .3s var(--n-bezier),
 transform .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 background-color: var(--n-color);
 display: flex;
 justify-content: flex-end;
`,[j("bordered",[Z("border",`
 content: "";
 position: absolute;
 top: 0;
 bottom: 0;
 width: 1px;
 background-color: var(--n-border-color);
 transition: background-color .3s var(--n-bezier);
 `)]),Z("left-placement",[j("bordered",[Z("border",`
 right: 0;
 `)])]),j("right-placement",`
 justify-content: flex-start;
 `,[j("bordered",[Z("border",`
 left: 0;
 `)]),j("collapsed",[O("layout-toggle-button",[O("base-icon",`
 transform: rotate(180deg);
 `)]),O("layout-toggle-bar",[de("&:hover",[Z("top",{transform:"rotate(-12deg) scale(1.15) translateY(-2px)"}),Z("bottom",{transform:"rotate(12deg) scale(1.15) translateY(2px)"})])])]),O("layout-toggle-button",`
 left: 0;
 transform: translateX(-50%) translateY(-50%);
 `,[O("base-icon",`
 transform: rotate(0);
 `)]),O("layout-toggle-bar",`
 left: -28px;
 transform: rotate(180deg);
 `,[de("&:hover",[Z("top",{transform:"rotate(12deg) scale(1.15) translateY(-2px)"}),Z("bottom",{transform:"rotate(-12deg) scale(1.15) translateY(2px)"})])])]),j("collapsed",[O("layout-toggle-bar",[de("&:hover",[Z("top",{transform:"rotate(-12deg) scale(1.15) translateY(-2px)"}),Z("bottom",{transform:"rotate(12deg) scale(1.15) translateY(2px)"})])]),O("layout-toggle-button",[O("base-icon",`
 transform: rotate(0);
 `)])]),O("layout-toggle-button",`
 transition:
 color .3s var(--n-bezier),
 right .3s var(--n-bezier),
 left .3s var(--n-bezier),
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 cursor: pointer;
 width: 24px;
 height: 24px;
 position: absolute;
 top: 50%;
 right: 0;
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 font-size: 18px;
 color: var(--n-toggle-button-icon-color);
 border: var(--n-toggle-button-border);
 background-color: var(--n-toggle-button-color);
 box-shadow: 0 2px 4px 0px rgba(0, 0, 0, .06);
 transform: translateX(50%) translateY(-50%);
 z-index: 1;
 `,[O("base-icon",`
 transition: transform .3s var(--n-bezier);
 transform: rotate(180deg);
 `)]),O("layout-toggle-bar",`
 cursor: pointer;
 height: 72px;
 width: 32px;
 position: absolute;
 top: calc(50% - 36px);
 right: -28px;
 `,[Z("top, bottom",`
 position: absolute;
 width: 4px;
 border-radius: 2px;
 height: 38px;
 left: 14px;
 transition: 
 background-color .3s var(--n-bezier),
 transform .3s var(--n-bezier);
 `),Z("bottom",`
 position: absolute;
 top: 34px;
 `),de("&:hover",[Z("top",{transform:"rotate(12deg) scale(1.15) translateY(-2px)"}),Z("bottom",{transform:"rotate(-12deg) scale(1.15) translateY(2px)"})]),Z("top, bottom",{backgroundColor:"var(--n-toggle-bar-color)"}),de("&:hover",[Z("top, bottom",{backgroundColor:"var(--n-toggle-bar-color-hover)"})])]),Z("border",`
 position: absolute;
 top: 0;
 right: 0;
 bottom: 0;
 width: 1px;
 transition: background-color .3s var(--n-bezier);
 `),O("layout-sider-scroll-container",`
 flex-grow: 1;
 flex-shrink: 0;
 box-sizing: border-box;
 height: 100%;
 opacity: 0;
 transition: opacity .3s var(--n-bezier);
 max-width: 100%;
 `),j("show-content",[O("layout-sider-scroll-container",{opacity:1})]),j("absolute-positioned",`
 position: absolute;
 left: 0;
 top: 0;
 bottom: 0;
 `)]),Fa=le({name:"LayoutToggleButton",props:{clsPrefix:{type:String,required:!0},onClick:Function},render(){const{clsPrefix:e}=this;return C("div",{class:`${e}-layout-toggle-button`,onClick:this.onClick},C(Pn,{clsPrefix:e},{default:()=>C(Bo,null)}))}}),Da=le({props:{clsPrefix:{type:String,required:!0},onClick:Function},render(){const{clsPrefix:e}=this;return C("div",{onClick:this.onClick,class:`${e}-layout-toggle-bar`},C("div",{class:`${e}-layout-toggle-bar__top`}),C("div",{class:`${e}-layout-toggle-bar__bottom`}))}}),Ia={position:Hn,bordered:Boolean,collapsedWidth:{type:Number,default:48},width:{type:[Number,String],default:272},contentClass:String,contentStyle:{type:[String,Object],default:""},collapseMode:{type:String,default:"transform"},collapsed:{type:Boolean,default:void 0},defaultCollapsed:Boolean,showCollapsedContent:{type:Boolean,default:!0},showTrigger:{type:[Boolean,String],default:!1},nativeScrollbar:{type:Boolean,default:!0},inverted:Boolean,scrollbarProps:Object,triggerClass:String,triggerStyle:[String,Object],collapsedTriggerClass:String,collapsedTriggerStyle:[String,Object],"onUpdate:collapsed":[Function,Array],onUpdateCollapsed:[Function,Array],onAfterEnter:Function,onAfterLeave:Function,onExpand:[Function,Array],onCollapse:[Function,Array],onScroll:Function},Oa=le({name:"LayoutSider",props:Object.assign(Object.assign({},Ne.props),Ia),setup(e){const t=Pe(Vn),n=D(null),a=D(null),r=U(()=>pt(h.value?e.collapsedWidth:e.width)),l=U(()=>e.collapseMode!=="transform"?{}:{minWidth:pt(e.width)}),d=U(()=>t?t.siderPlacement:"left"),f=D(e.defaultCollapsed),h=We(H(e,"collapsed"),f);function s(A,S){if(e.nativeScrollbar){const{value:L}=n;L&&(S===void 0?L.scrollTo(A):L.scrollTo(A,S))}else{const{value:L}=a;L&&L.scrollTo(A,S)}}function k(){const{"onUpdate:collapsed":A,onUpdateCollapsed:S,onExpand:L,onCollapse:te}=e,{value:ne}=h;S&&ie(S,!ne),A&&ie(A,!ne),f.value=!ne,ne?L&&ie(L):te&&ie(te)}let T=0,m=0;const p=A=>{var S;const L=A.target;T=L.scrollLeft,m=L.scrollTop,(S=e.onScroll)===null||S===void 0||S.call(e,A)};Nn(()=>{if(e.nativeScrollbar){const A=n.value;A&&(A.scrollTop=m,A.scrollLeft=T)}}),Pt($a,{collapsedRef:h,collapseModeRef:H(e,"collapseMode")});const{mergedClsPrefixRef:g,inlineThemeDisabled:y}=Nt(e),c=Ne("Layout","-layout-sider",Pa,jn,e,g);function u(A){var S,L;A.propertyName==="max-width"&&(h.value?(S=e.onAfterLeave)===null||S===void 0||S.call(e):(L=e.onAfterEnter)===null||L===void 0||L.call(e))}const _={scrollTo:s},R=U(()=>{const{common:{cubicBezierEaseInOut:A},self:S}=c.value,{siderToggleButtonColor:L,siderToggleButtonBorder:te,siderToggleBarColor:ne,siderToggleBarColorHover:B}=S,ee={"--n-bezier":A,"--n-toggle-button-color":L,"--n-toggle-button-border":te,"--n-toggle-bar-color":ne,"--n-toggle-bar-color-hover":B};return e.inverted?(ee["--n-color"]=S.siderColorInverted,ee["--n-text-color"]=S.textColorInverted,ee["--n-border-color"]=S.siderBorderColorInverted,ee["--n-toggle-button-icon-color"]=S.siderToggleButtonIconColorInverted,ee.__invertScrollbar=S.__invertScrollbar):(ee["--n-color"]=S.siderColor,ee["--n-text-color"]=S.textColor,ee["--n-border-color"]=S.siderBorderColor,ee["--n-toggle-button-icon-color"]=S.siderToggleButtonIconColor),ee}),I=y?Ft("layout-sider",U(()=>e.inverted?"a":"b"),R,e):void 0;return Object.assign({scrollableElRef:n,scrollbarInstRef:a,mergedClsPrefix:g,mergedTheme:c,styleMaxWidth:r,mergedCollapsed:h,scrollContainerStyle:l,siderPlacement:d,handleNativeElScroll:p,handleTransitionend:u,handleTriggerClick:k,inlineThemeDisabled:y,cssVars:R,themeClass:I==null?void 0:I.themeClass,onRender:I==null?void 0:I.onRender},_)},render(){var e;const{mergedClsPrefix:t,mergedCollapsed:n,showTrigger:a}=this;return(e=this.onRender)===null||e===void 0||e.call(this),C("aside",{class:[`${t}-layout-sider`,this.themeClass,`${t}-layout-sider--${this.position}-positioned`,`${t}-layout-sider--${this.siderPlacement}-placement`,this.bordered&&`${t}-layout-sider--bordered`,n&&`${t}-layout-sider--collapsed`,(!n||this.showCollapsedContent)&&`${t}-layout-sider--show-content`],onTransitionend:this.handleTransitionend,style:[this.inlineThemeDisabled?void 0:this.cssVars,{maxWidth:this.styleMaxWidth,width:pt(this.width)}]},this.nativeScrollbar?C("div",{class:[`${t}-layout-sider-scroll-container`,this.contentClass],onScroll:this.handleNativeElScroll,style:[this.scrollContainerStyle,{overflow:"auto"},this.contentStyle],ref:"scrollableElRef"},this.$slots):C(Dt,Object.assign({},this.scrollbarProps,{onScroll:this.onScroll,ref:"scrollbarInstRef",style:this.scrollContainerStyle,contentStyle:this.contentStyle,contentClass:this.contentClass,theme:this.mergedTheme.peers.Scrollbar,themeOverrides:this.mergedTheme.peerOverrides.Scrollbar,builtinThemeOverrides:this.inverted&&this.cssVars.__invertScrollbar==="true"?{colorHover:"rgba(255, 255, 255, .4)",color:"rgba(255, 255, 255, .3)"}:void 0}),this.$slots),a?a==="bar"?C(Da,{clsPrefix:t,class:n?this.collapsedTriggerClass:this.triggerClass,style:n?this.collapsedTriggerStyle:this.triggerStyle,onClick:this.handleTriggerClick}):C(Fa,{clsPrefix:t,class:n?this.collapsedTriggerClass:this.triggerClass,style:n?this.collapsedTriggerStyle:this.triggerStyle,onClick:this.handleTriggerClick}):null,this.bordered?C("div",{class:`${t}-layout-sider__border`}):null)}}),Aa=Object.assign(Object.assign({},Ne.props),{trigger:String,xScrollable:Boolean,onScroll:Function,size:Number}),Ea=le({name:"Scrollbar",props:Aa,setup(){const e=D(null);return Object.assign(Object.assign({},{scrollTo:(...n)=>{var a;(a=e.value)===null||a===void 0||a.scrollTo(n[0],n[1])},scrollBy:(...n)=>{var a;(a=e.value)===null||a===void 0||a.scrollBy(n[0],n[1])}}),{scrollbarInstRef:e})},render(){return C(Dt,Object.assign({ref:"scrollbarInstRef"},this.$props),this.$slots)}}),Ka=Ea,Gn=lt("n-tree-select"),Xe=lt("n-tree"),La=le({name:"NTreeSwitcher",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},expanded:Boolean,selected:Boolean,hide:Boolean,loading:Boolean,onClick:Function,tmNode:{type:Object,required:!0}},setup(e){const{renderSwitcherIconRef:t}=Pe(Xe,null);return()=>{const{clsPrefix:n,expanded:a,hide:r,indent:l,onClick:d}=e;return C("span",{"data-switcher":!0,class:[`${n}-tree-node-switcher`,a&&`${n}-tree-node-switcher--expanded`,r&&`${n}-tree-node-switcher--hide`],style:{width:`${l}px`},onClick:d},C("div",{class:`${n}-tree-node-switcher__icon`},C(Mo,null,{default:()=>{if(e.loading)return C(zo,{clsPrefix:n,key:"loading",radius:85,strokeWidth:20});const{value:f}=t;return f?f({expanded:e.expanded,selected:e.selected,option:e.tmNode.rawNode}):C(Pn,{clsPrefix:n,key:"switcher"},{default:()=>C(Ca,null)})}})))}}}),Ba=le({name:"NTreeNodeCheckbox",props:{clsPrefix:{type:String,required:!0},indent:{type:Number,required:!0},right:Boolean,focusable:Boolean,disabled:Boolean,checked:Boolean,indeterminate:Boolean,onCheck:Function},setup(e){const t=Pe(Xe);function n(r){const{onCheck:l}=e;l&&l(r)}function a(r){n(r)}return{handleUpdateValue:a,mergedTheme:t.mergedThemeRef}},render(){const{clsPrefix:e,mergedTheme:t,checked:n,indeterminate:a,disabled:r,focusable:l,indent:d,handleUpdateValue:f}=this;return C("span",{class:[`${e}-tree-node-checkbox`,this.right&&`${e}-tree-node-checkbox--right`],style:{width:`${d}px`},"data-checkbox":!0},C(jo,{focusable:l,disabled:r,theme:t.peers.Checkbox,themeOverrides:t.peerOverrides.Checkbox,checked:n,indeterminate:a,onUpdateChecked:f}))}}),Ma=le({name:"TreeNodeContent",props:{clsPrefix:{type:String,required:!0},disabled:Boolean,checked:Boolean,selected:Boolean,onClick:Function,onDragstart:Function,tmNode:{type:Object,required:!0},nodeProps:Object},setup(e){const{renderLabelRef:t,renderPrefixRef:n,renderSuffixRef:a,labelFieldRef:r}=Pe(Xe),l=D(null);function d(h){const{onClick:s}=e;s&&s(h)}function f(h){d(h)}return{selfRef:l,renderLabel:t,renderPrefix:n,renderSuffix:a,labelField:r,handleClick:f}},render(){const{clsPrefix:e,labelField:t,nodeProps:n,checked:a=!1,selected:r=!1,renderLabel:l,renderPrefix:d,renderSuffix:f,handleClick:h,onDragstart:s,tmNode:{rawNode:k,rawNode:{prefix:T,suffix:m,[t]:p}}}=this;return C("span",Object.assign({},n,{ref:"selfRef",class:[`${e}-tree-node-content`,n==null?void 0:n.class],onClick:h,draggable:s===void 0?void 0:!0,onDragstart:s}),d||T?C("div",{class:`${e}-tree-node-content__prefix`},d?d({option:k,selected:r,checked:a}):_t(T)):null,C("div",{class:`${e}-tree-node-content__text`},l?l({option:k,selected:r,checked:a}):_t(p)),f||m?C("div",{class:`${e}-tree-node-content__suffix`},f?f({option:k,selected:r,checked:a}):_t(m)):null)}});function hn({position:e,offsetLevel:t,indent:n,el:a}){const r={position:"absolute",boxSizing:"border-box",right:0};if(e==="inside")r.left=0,r.top=0,r.bottom=0,r.borderRadius="inherit",r.boxShadow="inset 0 0 0 2px var(--n-drop-mark-color)";else{const l=e==="before"?"top":"bottom";r[l]=0,r.left=`${a.offsetLeft+6-t*n}px`,r.height="2px",r.backgroundColor="var(--n-drop-mark-color)",r.transformOrigin=l,r.borderRadius="1px",r.transform=e==="before"?"translateY(-4px)":"translateY(4px)"}return C("div",{style:r})}function za({dropPosition:e,node:t}){return t.isLeaf===!1||t.children?!0:e!=="inside"}function ja(e){return U(()=>e.leafOnly?"child":e.checkStrategy)}function xe(e,t){return!!e.rawNode[t]}function qn(e,t,n,a){e==null||e.forEach(r=>{n(r),qn(r[t],t,n,a),a(r)})}function Ha(e,t,n,a,r){const l=new Set,d=new Set,f=[];return qn(e,a,h=>{if(f.push(h),r(t,h)){d.add(h[n]);for(let s=f.length-2;s>=0;--s)if(!l.has(f[s][n]))l.add(f[s][n]);else return}},()=>{f.pop()}),{expandedKeys:Array.from(l),highlightKeySet:d}}if(Ho&&Image){const e=new Image;e.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}function Va(e,t,n,a,r){const l=new Set,d=new Set,f=new Set,h=[],s=[],k=[];function T(p){p.forEach(g=>{if(k.push(g),t(n,g)){l.add(g[a]),f.add(g[a]);for(let c=k.length-2;c>=0;--c){const u=k[c][a];if(!d.has(u))d.add(u),l.has(u)&&l.delete(u);else break}}const y=g[r];y&&T(y),k.pop()})}T(e);function m(p,g){p.forEach(y=>{const c=y[a],u=l.has(c),_=d.has(c);if(!u&&!_)return;const R=y[r];if(R)if(u)g.push(y);else{h.push(c);const I=Object.assign(Object.assign({},y),{[r]:[]});g.push(I),m(R,I[r])}else g.push(y)})}return m(e,s),{filteredTree:s,highlightKeySet:f,expandedKeys:h}}const Ua=le({name:"TreeNode",props:{clsPrefix:{type:String,required:!0},tmNode:{type:Object,required:!0}},setup(e){const t=Pe(Xe),{droppingNodeParentRef:n,droppingMouseNodeRef:a,draggingNodeRef:r,droppingPositionRef:l,droppingOffsetLevelRef:d,nodePropsRef:f,indentRef:h,blockLineRef:s,checkboxPlacementRef:k,checkOnClickRef:T,disabledFieldRef:m,showLineRef:p,renderSwitcherIconRef:g,overrideDefaultNodeClickBehaviorRef:y}=t,c=fe(()=>!!e.tmNode.rawNode.checkboxDisabled),u=fe(()=>xe(e.tmNode,m.value)),_=fe(()=>t.disabledRef.value||u.value),R=U(()=>{const{value:$}=f;if($)return $({option:e.tmNode.rawNode})}),I=D(null),A={value:null};It(()=>{A.value=I.value.$el});function S(){const $=()=>{const{tmNode:z}=e;if(!z.isLeaf&&!z.shallowLoaded){if(!t.loadingKeysRef.value.has(z.key))t.loadingKeysRef.value.add(z.key);else return;const{onLoadRef:{value:Y}}=t;Y&&Y(z.rawNode).then(ae=>{ae!==!1&&t.handleSwitcherClick(z)}).finally(()=>{t.loadingKeysRef.value.delete(z.key)})}else t.handleSwitcherClick(z)};g.value?setTimeout($,0):$()}const L=fe(()=>!u.value&&t.selectableRef.value&&(t.internalTreeSelect?t.mergedCheckStrategyRef.value!=="child"||t.multipleRef.value&&t.cascadeRef.value||e.tmNode.isLeaf:!0)),te=fe(()=>t.checkableRef.value&&(t.cascadeRef.value||t.mergedCheckStrategyRef.value!=="child"||e.tmNode.isLeaf)),ne=fe(()=>t.displayedCheckedKeysRef.value.includes(e.tmNode.key)),B=fe(()=>{const{value:$}=te;if(!$)return!1;const{value:z}=T,{tmNode:Y}=e;return typeof z=="boolean"?!Y.disabled&&z:z(e.tmNode.rawNode)});function ee($){const{value:z}=t.expandOnClickRef,{value:Y}=L,{value:ae}=B;if(!Y&&!z&&!ae||an($,"checkbox")||an($,"switcher"))return;const{tmNode:ue}=e;Y&&t.handleSelect(ue),z&&!ue.isLeaf&&S(),ae&&E(!ne.value)}function we($){var z,Y;if(!_.value){const ae=y.value;let ue=!1;if(ae)switch(ae({option:e.tmNode.rawNode})){case"toggleCheck":ue=!0,E(!ne.value);break;case"toggleSelect":ue=!0,t.handleSelect(e.tmNode);break;case"toggleExpand":ue=!0,S(),ue=!0;break;case"none":ue=!0,ue=!0;return}ue||ee($)}(Y=(z=R.value)===null||z===void 0?void 0:z.onClick)===null||Y===void 0||Y.call(z,$)}function F($){s.value||we($)}function b($){s.value&&we($)}function E($){t.handleCheck(e.tmNode,$)}function X($){t.handleDragStart({event:$,node:e.tmNode})}function Se($){$.currentTarget===$.target&&t.handleDragEnter({event:$,node:e.tmNode})}function M($){$.preventDefault(),t.handleDragOver({event:$,node:e.tmNode})}function ce($){t.handleDragEnd({event:$,node:e.tmNode})}function Ce($){$.currentTarget===$.target&&t.handleDragLeave({event:$,node:e.tmNode})}function ct($){$.preventDefault(),l.value!==null&&t.handleDrop({event:$,node:e.tmNode,dropPosition:l.value})}const ut=U(()=>{const{clsPrefix:$}=e,{value:z}=h;if(p.value){const Y=[];let ae=e.tmNode.parent;for(;ae;)ae.isLastChild?Y.push(C("div",{class:`${$}-tree-node-indent`},C("div",{style:{width:`${z}px`}}))):Y.push(C("div",{class:[`${$}-tree-node-indent`,`${$}-tree-node-indent--show-line`]},C("div",{style:{width:`${z}px`}}))),ae=ae.parent;return Y.reverse()}else return Vo(e.tmNode.level,C("div",{class:`${e.clsPrefix}-tree-node-indent`},C("div",{style:{width:`${z}px`}})))});return{showDropMark:fe(()=>{const{value:$}=r;if(!$)return;const{value:z}=l;if(!z)return;const{value:Y}=a;if(!Y)return;const{tmNode:ae}=e;return ae.key===Y.key}),showDropMarkAsParent:fe(()=>{const{value:$}=n;if(!$)return!1;const{tmNode:z}=e,{value:Y}=l;return Y==="before"||Y==="after"?$.key===z.key:!1}),pending:fe(()=>t.pendingNodeKeyRef.value===e.tmNode.key),loading:fe(()=>t.loadingKeysRef.value.has(e.tmNode.key)),highlight:fe(()=>{var $;return($=t.highlightKeySetRef.value)===null||$===void 0?void 0:$.has(e.tmNode.key)}),checked:ne,indeterminate:fe(()=>t.displayedIndeterminateKeysRef.value.includes(e.tmNode.key)),selected:fe(()=>t.mergedSelectedKeysRef.value.includes(e.tmNode.key)),expanded:fe(()=>t.mergedExpandedKeysRef.value.includes(e.tmNode.key)),disabled:_,checkable:te,mergedCheckOnClick:B,checkboxDisabled:c,selectable:L,expandOnClick:t.expandOnClickRef,internalScrollable:t.internalScrollableRef,draggable:t.draggableRef,blockLine:s,nodeProps:R,checkboxFocusable:t.internalCheckboxFocusableRef,droppingPosition:l,droppingOffsetLevel:d,indent:h,checkboxPlacement:k,showLine:p,contentInstRef:I,contentElRef:A,indentNodes:ut,handleCheck:E,handleDrop:ct,handleDragStart:X,handleDragEnter:Se,handleDragOver:M,handleDragEnd:ce,handleDragLeave:Ce,handleLineClick:b,handleContentClick:F,handleSwitcherClick:S}},render(){const{tmNode:e,clsPrefix:t,checkable:n,expandOnClick:a,selectable:r,selected:l,checked:d,highlight:f,draggable:h,blockLine:s,indent:k,indentNodes:T,disabled:m,pending:p,internalScrollable:g,nodeProps:y,checkboxPlacement:c}=this,u=h&&!m?{onDragenter:this.handleDragEnter,onDragleave:this.handleDragLeave,onDragend:this.handleDragEnd,onDrop:this.handleDrop,onDragover:this.handleDragOver}:void 0,_=g?zn(e.key):void 0,R=c==="right",I=n?C(Ba,{indent:k,right:R,focusable:this.checkboxFocusable,disabled:m||this.checkboxDisabled,clsPrefix:t,checked:this.checked,indeterminate:this.indeterminate,onCheck:this.handleCheck}):null;return C("div",Object.assign({class:`${t}-tree-node-wrapper`},u),C("div",Object.assign({},s?y:void 0,{class:[`${t}-tree-node`,{[`${t}-tree-node--selected`]:l,[`${t}-tree-node--checkable`]:n,[`${t}-tree-node--highlight`]:f,[`${t}-tree-node--pending`]:p,[`${t}-tree-node--disabled`]:m,[`${t}-tree-node--selectable`]:r,[`${t}-tree-node--clickable`]:r||a||this.mergedCheckOnClick},y==null?void 0:y.class],"data-key":_,draggable:h&&s,onClick:this.handleLineClick,onDragstart:h&&s&&!m?this.handleDragStart:void 0}),T,e.isLeaf&&this.showLine?C("div",{class:[`${t}-tree-node-indent`,`${t}-tree-node-indent--show-line`,e.isLeaf&&`${t}-tree-node-indent--is-leaf`,e.isLastChild&&`${t}-tree-node-indent--last-child`]},C("div",{style:{width:`${k}px`}})):C(La,{clsPrefix:t,expanded:this.expanded,selected:l,loading:this.loading,hide:e.isLeaf,tmNode:this.tmNode,indent:k,onClick:this.handleSwitcherClick}),R?null:I,C(Ma,{ref:"contentInstRef",clsPrefix:t,checked:d,selected:l,onClick:this.handleContentClick,nodeProps:s?void 0:y,onDragstart:h&&!s&&!m?this.handleDragStart:void 0,tmNode:e}),h?this.showDropMark?hn({el:this.contentElRef.value,position:this.droppingPosition,offsetLevel:this.droppingOffsetLevel,indent:k}):this.showDropMarkAsParent?hn({el:this.contentElRef.value,position:"inside",offsetLevel:this.droppingOffsetLevel,indent:k}):null:null,R?I:null))}}),Wn=Ua;function Ga({props:e,fNodesRef:t,mergedExpandedKeysRef:n,mergedSelectedKeysRef:a,mergedCheckedKeysRef:r,handleCheck:l,handleSelect:d,handleSwitcherClick:f}){const{value:h}=a,s=Pe(Gn,null),k=s?s.pendingNodeKeyRef:D(h.length?h[h.length-1]:null);function T(m){var p;if(!e.keyboard)return{enterBehavior:null};const{value:g}=k;let y=null;if(g===null){if((m.key==="ArrowDown"||m.key==="ArrowUp")&&m.preventDefault(),["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(m.key)&&g===null){const{value:c}=t;let u=0;for(;u<c.length;){if(!c[u].disabled){k.value=c[u].key;break}u+=1}}}else{const{value:c}=t;let u=c.findIndex(_=>_.key===g);if(!~u)return{enterBehavior:null};if(m.key==="Enter"){const _=c[u];switch(y=((p=e.overrideDefaultNodeClickBehavior)===null||p===void 0?void 0:p.call(e,{option:_.rawNode}))||null,y){case"toggleCheck":l(_,!r.value.includes(_.key));break;case"toggleSelect":d(_);break;case"toggleExpand":f(_);break;case"none":break;case"default":default:y="default",d(_)}}else if(m.key==="ArrowDown")for(m.preventDefault(),u+=1;u<c.length;){if(!c[u].disabled){k.value=c[u].key;break}u+=1}else if(m.key==="ArrowUp")for(m.preventDefault(),u-=1;u>=0;){if(!c[u].disabled){k.value=c[u].key;break}u-=1}else if(m.key==="ArrowLeft"){const _=c[u];if(_.isLeaf||!n.value.includes(g)){const R=_.getParent();R&&(k.value=R.key)}else f(_)}else if(m.key==="ArrowRight"){const _=c[u];if(_.isLeaf)return{enterBehavior:null};if(!n.value.includes(g))f(_);else for(u+=1;u<c.length;){if(!c[u].disabled){k.value=c[u].key;break}u+=1}}}return{enterBehavior:y}}return{pendingNodeKeyRef:k,handleKeydown:T}}const qa=le({name:"TreeMotionWrapper",props:{clsPrefix:{type:String,required:!0},height:Number,nodes:{type:Array,required:!0},mode:{type:String,required:!0},onAfterEnter:{type:Function,required:!0}},render(){const{clsPrefix:e}=this;return C(Uo,{onAfterEnter:this.onAfterEnter,appear:!0,reverse:this.mode==="collapse"},{default:()=>C("div",{class:[`${e}-tree-motion-wrapper`,`${e}-tree-motion-wrapper--${this.mode}`],style:{height:Fn(this.height)}},this.nodes.map(t=>C(Wn,{clsPrefix:e,tmNode:t})))})}}),St=Go(),Wa=O("tree",`
 font-size: var(--n-font-size);
 outline: none;
`,[de("ul, li",`
 margin: 0;
 padding: 0;
 list-style: none;
 `),de(">",[O("tree-node",[de("&:first-child","margin-top: 0;")])]),O("tree-motion-wrapper",[j("expand",[rn({duration:"0.2s"})]),j("collapse",[rn({duration:"0.2s",reverse:!0})])]),O("tree-node-wrapper",`
 box-sizing: border-box;
 padding: var(--n-node-wrapper-padding);
 `),O("tree-node",`
 transform: translate3d(0,0,0);
 position: relative;
 display: flex;
 border-radius: var(--n-node-border-radius);
 transition: background-color .3s var(--n-bezier);
 `,[j("highlight",[O("tree-node-content",[Z("text","border-bottom-color: var(--n-node-text-color-disabled);")])]),j("disabled",[O("tree-node-content",`
 color: var(--n-node-text-color-disabled);
 cursor: not-allowed;
 `)]),Le("disabled",[j("clickable",[O("tree-node-content",`
 cursor: pointer;
 `)])])]),j("block-node",[O("tree-node-content",`
 flex: 1;
 min-width: 0;
 `)]),Le("block-line",[O("tree-node",[Le("disabled",[O("tree-node-content",[de("&:hover","background: var(--n-node-color-hover);")]),j("selectable",[O("tree-node-content",[de("&:active","background: var(--n-node-color-pressed);")])]),j("pending",[O("tree-node-content",`
 background: var(--n-node-color-hover);
 `)]),j("selected",[O("tree-node-content","background: var(--n-node-color-active);")])]),j("selected",[O("tree-node-content","background: var(--n-node-color-active);")])])]),j("block-line",[O("tree-node",[Le("disabled",[de("&:hover","background: var(--n-node-color-hover);"),j("pending",`
 background: var(--n-node-color-hover);
 `),j("selectable",[Le("selected",[de("&:active","background: var(--n-node-color-pressed);")])]),j("selected","background: var(--n-node-color-active);")]),j("selected","background: var(--n-node-color-active);"),j("disabled",`
 cursor: not-allowed;
 `)])]),O("tree-node-indent",`
 flex-grow: 0;
 flex-shrink: 0;
 `,[j("show-line","position: relative",[de("&::before",`
 position: absolute;
 left: 50%;
 border-left: 1px solid var(--n-line-color);
 transition: border-color .3s var(--n-bezier);
 transform: translate(-50%);
 content: "";
 top: var(--n-line-offset-top);
 bottom: var(--n-line-offset-bottom);
 `),j("last-child",[de("&::before",`
 bottom: 50%;
 `)]),j("is-leaf",[de("&::after",`
 position: absolute;
 content: "";
 left: calc(50% + 0.5px);
 right: 0;
 bottom: 50%;
 transition: border-color .3s var(--n-bezier);
 border-bottom: 1px solid var(--n-line-color);
 `)])]),Le("show-line","height: 0;")]),O("tree-node-switcher",`
 cursor: pointer;
 display: inline-flex;
 flex-shrink: 0;
 height: var(--n-node-content-height);
 align-items: center;
 justify-content: center;
 transition: transform .15s var(--n-bezier);
 vertical-align: bottom;
 `,[Z("icon",`
 position: relative;
 height: 14px;
 width: 14px;
 display: flex;
 color: var(--n-arrow-color);
 transition: color .3s var(--n-bezier);
 font-size: 14px;
 `,[O("icon",[St]),O("base-loading",`
 color: var(--n-loading-color);
 position: absolute;
 left: 0;
 top: 0;
 right: 0;
 bottom: 0;
 `,[St]),O("base-icon",[St])]),j("hide","visibility: hidden;"),j("expanded","transform: rotate(90deg);")]),O("tree-node-checkbox",`
 display: inline-flex;
 height: var(--n-node-content-height);
 vertical-align: bottom;
 align-items: center;
 justify-content: center;
 `),O("tree-node-content",`
 user-select: none;
 position: relative;
 display: inline-flex;
 align-items: center;
 min-height: var(--n-node-content-height);
 box-sizing: border-box;
 line-height: var(--n-line-height);
 vertical-align: bottom;
 padding: 0 6px 0 4px;
 cursor: default;
 border-radius: var(--n-node-border-radius);
 color: var(--n-node-text-color);
 transition:
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 border-color .3s var(--n-bezier);
 `,[de("&:last-child","margin-bottom: 0;"),Z("prefix",`
 display: inline-flex;
 margin-right: 8px;
 `),Z("text",`
 border-bottom: 1px solid #0000;
 transition: border-color .3s var(--n-bezier);
 flex-grow: 1;
 max-width: 100%;
 `),Z("suffix",`
 display: inline-flex;
 `)]),Z("empty","margin: auto;")]);var Ya=function(e,t,n,a){function r(l){return l instanceof n?l:new n(function(d){d(l)})}return new(n||(n=Promise))(function(l,d){function f(k){try{s(a.next(k))}catch(T){d(T)}}function h(k){try{s(a.throw(k))}catch(T){d(T)}}function s(k){k.done?l(k.value):r(k.value).then(f,h)}s((a=a.apply(e,t||[])).next())})};function Ja(e,t,n,a){return{getIsGroup(){return!1},getKey(l){return l[e]},getChildren:a||(l=>l[t]),getDisabled(l){return!!(l[n]||l.checkboxDisabled)}}}const Xa={allowCheckingNotLoaded:Boolean,filter:Function,defaultExpandAll:Boolean,expandedKeys:Array,keyField:{type:String,default:"key"},labelField:{type:String,default:"label"},childrenField:{type:String,default:"children"},disabledField:{type:String,default:"disabled"},defaultExpandedKeys:{type:Array,default:()=>[]},indeterminateKeys:Array,renderSwitcherIcon:Function,onUpdateIndeterminateKeys:[Function,Array],"onUpdate:indeterminateKeys":[Function,Array],onUpdateExpandedKeys:[Function,Array],"onUpdate:expandedKeys":[Function,Array],overrideDefaultNodeClickBehavior:Function},Qa=Object.assign(Object.assign(Object.assign(Object.assign({},Ne.props),{accordion:Boolean,showIrrelevantNodes:{type:Boolean,default:!0},data:{type:Array,default:()=>[]},expandOnDragenter:{type:Boolean,default:!0},expandOnClick:Boolean,checkOnClick:{type:[Boolean,Function],default:!1},cancelable:{type:Boolean,default:!0},checkable:Boolean,draggable:Boolean,blockNode:Boolean,blockLine:Boolean,showLine:Boolean,disabled:Boolean,checkedKeys:Array,defaultCheckedKeys:{type:Array,default:()=>[]},selectedKeys:Array,defaultSelectedKeys:{type:Array,default:()=>[]},multiple:Boolean,pattern:{type:String,default:""},onLoad:Function,cascade:Boolean,selectable:{type:Boolean,default:!0},scrollbarProps:Object,indent:{type:Number,default:24},allowDrop:{type:Function,default:za},animated:{type:Boolean,default:!0},checkboxPlacement:{type:String,default:"left"},virtualScroll:Boolean,watchProps:Array,renderLabel:Function,renderPrefix:Function,renderSuffix:Function,nodeProps:Function,keyboard:{type:Boolean,default:!0},getChildren:Function,onDragenter:[Function,Array],onDragleave:[Function,Array],onDragend:[Function,Array],onDragstart:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onUpdateCheckedKeys:[Function,Array],"onUpdate:checkedKeys":[Function,Array],onUpdateSelectedKeys:[Function,Array],"onUpdate:selectedKeys":[Function,Array]}),Xa),{internalTreeSelect:Boolean,internalScrollable:Boolean,internalScrollablePadding:String,internalRenderEmpty:Function,internalHighlightKeySet:Object,internalUnifySelectCheck:Boolean,internalCheckboxFocusable:{type:Boolean,default:!0},internalFocusable:{type:Boolean,default:!0},checkStrategy:{type:String,default:"all"},leafOnly:Boolean}),Za=le({name:"Tree",props:Qa,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:n,mergedRtlRef:a}=Nt(e),r=qo("Tree",a,t),l=Ne("Tree","-tree",Wa,Yo,e,t),d=D(null),f=D(null),h=D(null);function s(){var o;return(o=h.value)===null||o===void 0?void 0:o.listElRef}function k(){var o;return(o=h.value)===null||o===void 0?void 0:o.itemsElRef}const T=U(()=>{const{filter:o}=e;if(o)return o;const{labelField:i}=e;return(v,w)=>{if(!v.length)return!0;const x=w[i];return typeof x=="string"?x.toLowerCase().includes(v.toLowerCase()):!1}}),m=U(()=>{const{pattern:o}=e;return o?!o.length||!T.value?{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}:Va(e.data,T.value,o,e.keyField,e.childrenField):{filteredTree:e.data,highlightKeySet:null,expandedKeys:void 0}}),p=U(()=>Jo(e.showIrrelevantNodes?e.data:m.value.filteredTree,Ja(e.keyField,e.childrenField,e.disabledField,e.getChildren))),g=Pe(Gn,null),y=e.internalTreeSelect?g.dataTreeMate:p,{watchProps:c}=e,u=D([]);c!=null&&c.includes("defaultCheckedKeys")?Ue(()=>{u.value=e.defaultCheckedKeys}):u.value=e.defaultCheckedKeys;const _=H(e,"checkedKeys"),R=We(_,u),I=U(()=>y.value.getCheckedKeys(R.value,{cascade:e.cascade,allowNotLoaded:e.allowCheckingNotLoaded})),A=ja(e),S=U(()=>I.value.checkedKeys),L=U(()=>{const{indeterminateKeys:o}=e;return o!==void 0?o:I.value.indeterminateKeys}),te=D([]);c!=null&&c.includes("defaultSelectedKeys")?Ue(()=>{te.value=e.defaultSelectedKeys}):te.value=e.defaultSelectedKeys;const ne=H(e,"selectedKeys"),B=We(ne,te),ee=D([]),we=o=>{ee.value=e.defaultExpandAll?y.value.getNonLeafKeys():o===void 0?e.defaultExpandedKeys:o};c!=null&&c.includes("defaultExpandedKeys")?Ue(()=>{we(void 0)}):Ue(()=>{we(e.defaultExpandedKeys)});const F=H(e,"expandedKeys"),b=We(F,ee),E=U(()=>p.value.getFlattenedNodes(b.value)),{pendingNodeKeyRef:X,handleKeydown:Se}=Ga({props:e,mergedCheckedKeysRef:R,mergedSelectedKeysRef:B,fNodesRef:E,mergedExpandedKeysRef:b,handleCheck:yt,handleSelect:bt,handleSwitcherClick:Qt});let M=null,ce=null;const Ce=D(new Set),ct=U(()=>e.internalHighlightKeySet||m.value.highlightKeySet),ut=We(ct,Ce),$=D(new Set),z=U(()=>b.value.filter(o=>!$.value.has(o)));let Y=0;const ae=D(null),ue=D(null),Qe=D(null),Ze=D(null),et=D(0),lo=U(()=>{const{value:o}=ue;return o?o.parent:null});let ft=!1;be(H(e,"data"),()=>{ft=!0,ve(()=>{ft=!1}),$.value.clear(),X.value=null,Ve()},{deep:!1});let ht=!1;const vt=()=>{ht=!0,ve(()=>{ht=!1})};let He;be(H(e,"pattern"),(o,i)=>{if(e.showIrrelevantNodes)if(He=void 0,o){const{expandedKeys:v,highlightKeySet:w}=Ha(e.data,e.pattern,e.keyField,e.childrenField,T.value);Ce.value=w,vt(),De(v,ge(v),{node:null,action:"filter"})}else Ce.value=new Set;else if(!o.length)He!==void 0&&(vt(),De(He,ge(He),{node:null,action:"filter"}));else{i.length||(He=b.value);const{expandedKeys:v}=m.value;v!==void 0&&(vt(),De(v,ge(v),{node:null,action:"filter"}))}});function Jt(o){return Ya(this,void 0,void 0,function*(){const{onLoad:i}=e;if(!i){yield Promise.resolve();return}const{value:v}=$;if(!v.has(o.key)){v.add(o.key);try{(yield i(o.rawNode))===!1&&Ie()}catch(w){console.error(w),Ie()}v.delete(o.key)}})}Ue(()=>{var o;const{value:i}=p;if(!i)return;const{getNode:v}=i;(o=b.value)===null||o===void 0||o.forEach(w=>{const x=v(w);x&&!x.shallowLoaded&&Jt(x)})});const Fe=D(!1),$e=D([]);be(z,(o,i)=>{if(!e.animated||ht){ve(tt);return}if(ft)return;const v=Ge(l.value.self.nodeHeight),w=new Set(i);let x=null,Q=null;for(const G of o)if(!w.has(G)){if(x!==null)return;x=G}const he=new Set(o);for(const G of i)if(!he.has(G)){if(Q!==null)return;Q=G}if(x===null&&Q===null)return;const{virtualScroll:ye}=e,Ae=(ye?h.value.listElRef:d.value).offsetHeight,Ee=Math.ceil(Ae/v)+1;let me;if(x!==null&&(me=i),Q!==null&&(me===void 0?me=o:me=me.filter(G=>G!==Q)),Fe.value=!0,$e.value=p.value.getFlattenedNodes(me),x!==null){const G=$e.value.findIndex(pe=>pe.key===x);if(~G){const pe=$e.value[G].children;if(pe){const ke=dn(pe,o);$e.value.splice(G+1,0,{__motion:!0,mode:"expand",height:ye?ke.length*v:void 0,nodes:ye?ke.slice(0,Ee):ke})}}}if(Q!==null){const G=$e.value.findIndex(pe=>pe.key===Q);if(~G){const pe=$e.value[G].children;if(!pe)return;Fe.value=!0;const ke=dn(pe,o);$e.value.splice(G+1,0,{__motion:!0,mode:"collapse",height:ye?ke.length*v:void 0,nodes:ye?ke.slice(0,Ee):ke})}}});const io=U(()=>Xo(E.value)),so=U(()=>Fe.value?$e.value:E.value);function tt(){const{value:o}=f;o&&o.sync()}function co(){Fe.value=!1,e.virtualScroll&&ve(tt)}function ge(o){const{getNode:i}=y.value;return o.map(v=>{var w;return((w=i(v))===null||w===void 0?void 0:w.rawNode)||null})}function De(o,i,v){const{"onUpdate:expandedKeys":w,onUpdateExpandedKeys:x}=e;ee.value=o,w&&ie(w,o,i,v),x&&ie(x,o,i,v)}function Xt(o,i,v){const{"onUpdate:checkedKeys":w,onUpdateCheckedKeys:x}=e;u.value=o,x&&ie(x,o,i,v),w&&ie(w,o,i,v)}function uo(o,i){const{"onUpdate:indeterminateKeys":v,onUpdateIndeterminateKeys:w}=e;v&&ie(v,o,i),w&&ie(w,o,i)}function gt(o,i,v){const{"onUpdate:selectedKeys":w,onUpdateSelectedKeys:x}=e;te.value=o,x&&ie(x,o,i,v),w&&ie(w,o,i,v)}function fo(o){const{onDragenter:i}=e;i&&ie(i,o)}function ho(o){const{onDragleave:i}=e;i&&ie(i,o)}function vo(o){const{onDragend:i}=e;i&&ie(i,o)}function go(o){const{onDragstart:i}=e;i&&ie(i,o)}function yo(o){const{onDragover:i}=e;i&&ie(i,o)}function bo(o){const{onDrop:i}=e;i&&ie(i,o)}function Ve(){mo(),Re()}function mo(){ae.value=null}function Re(){et.value=0,ue.value=null,Qe.value=null,Ze.value=null,Ie()}function Ie(){M&&(window.clearTimeout(M),M=null),ce=null}function yt(o,i){if(e.disabled||xe(o,e.disabledField))return;if(e.internalUnifySelectCheck&&!e.multiple){bt(o);return}const v=i?"check":"uncheck",{checkedKeys:w,indeterminateKeys:x}=y.value[v](o.key,S.value,{cascade:e.cascade,checkStrategy:A.value,allowNotLoaded:e.allowCheckingNotLoaded});Xt(w,ge(w),{node:o.rawNode,action:v}),uo(x,ge(x))}function po(o){if(e.disabled)return;const{key:i}=o,{value:v}=b,w=v.findIndex(x=>x===i);if(~w){const x=Array.from(v);x.splice(w,1),De(x,ge(x),{node:o.rawNode,action:"collapse"})}else{const x=p.value.getNode(i);if(!x||x.isLeaf)return;let Q;if(e.accordion){const he=new Set(o.siblings.map(({key:ye})=>ye));Q=v.filter(ye=>!he.has(ye)),Q.push(i)}else Q=v.concat(i);De(Q,ge(Q),{node:o.rawNode,action:"expand"})}}function Qt(o){e.disabled||Fe.value||po(o)}function bt(o){if(!(e.disabled||!e.selectable)){if(X.value=o.key,e.internalUnifySelectCheck){const{value:{checkedKeys:i,indeterminateKeys:v}}=I;e.multiple?yt(o,!(i.includes(o.key)||v.includes(o.key))):Xt([o.key],ge([o.key]),{node:o.rawNode,action:"check"})}if(e.multiple){const i=Array.from(B.value),v=i.findIndex(w=>w===o.key);~v?e.cancelable&&i.splice(v,1):~v||i.push(o.key),gt(i,ge(i),{node:o.rawNode,action:~v?"unselect":"select"})}else B.value.includes(o.key)?e.cancelable&&gt([],[],{node:o.rawNode,action:"unselect"}):gt([o.key],ge([o.key]),{node:o.rawNode,action:"select"})}}function _o(o){if(M&&(window.clearTimeout(M),M=null),o.isLeaf)return;ce=o.key;const i=()=>{if(ce!==o.key)return;const{value:v}=Qe;if(v&&v.key===o.key&&!b.value.includes(o.key)){const w=b.value.concat(o.key);De(w,ge(w),{node:o.rawNode,action:"expand"})}M=null,ce=null};o.shallowLoaded?M=window.setTimeout(()=>{i()},1e3):M=window.setTimeout(()=>{Jt(o).then(()=>{i()})},1e3)}function ko({event:o,node:i}){!e.draggable||e.disabled||xe(i,e.disabledField)||(Zt({event:o,node:i},!1),fo({event:o,node:i.rawNode}))}function Co({event:o,node:i}){!e.draggable||e.disabled||xe(i,e.disabledField)||ho({event:o,node:i.rawNode})}function So(o){o.target===o.currentTarget&&Re()}function wo({event:o,node:i}){Ve(),!(!e.draggable||e.disabled||xe(i,e.disabledField))&&vo({event:o,node:i.rawNode})}function $o({event:o,node:i}){!e.draggable||e.disabled||xe(i,e.disabledField)||(Y=o.clientX,ae.value=i,go({event:o,node:i.rawNode}))}function Zt({event:o,node:i},v=!0){var w;if(!e.draggable||e.disabled||xe(i,e.disabledField))return;const{value:x}=ae;if(!x)return;const{allowDrop:Q,indent:he}=e;v&&yo({event:o,node:i.rawNode});const ye=o.currentTarget,{height:Ae,top:Ee}=ye.getBoundingClientRect(),me=o.clientY-Ee;let G;Q({node:i.rawNode,dropPosition:"inside",phase:"drag"})?me<=8?G="before":me>=Ae-8?G="after":G="inside":me<=Ae/2?G="before":G="after";const{value:ke}=io;let V,se;const Ke=ke(i.key);if(Ke===null){Re();return}let nt=!1;G==="inside"?(V=i,se="inside"):G==="before"?i.isFirstChild?(V=i,se="before"):(V=E.value[Ke-1],se="after"):(V=i,se="after"),!V.isLeaf&&b.value.includes(V.key)&&(nt=!0,se==="after"&&(V=E.value[Ke+1],V?se="before":(V=i,se="inside")));const tn=V;if(Qe.value=tn,!nt&&x.isLastChild&&x.key===V.key&&(se="after"),se==="after"){let nn=Y-o.clientX,mt=0;for(;nn>=he/2&&V.parent!==null&&V.isLastChild&&mt<1;)nn-=he,mt+=1,V=V.parent;et.value=mt}else et.value=0;if((x.contains(V)||se==="inside"&&((w=x.parent)===null||w===void 0?void 0:w.key)===V.key)&&!(x.key===tn.key&&x.key===V.key)){Re();return}if(!Q({node:V.rawNode,dropPosition:se,phase:"drag"})){Re();return}if(x.key===V.key)Ie();else if(ce!==V.key)if(se==="inside"){if(e.expandOnDragenter){if(_o(V),!V.shallowLoaded&&ce!==V.key){Ve();return}}else if(!V.shallowLoaded){Ve();return}}else Ie();else se!=="inside"&&Ie();Ze.value=se,ue.value=V}function xo({event:o,node:i,dropPosition:v}){if(!e.draggable||e.disabled||xe(i,e.disabledField))return;const{value:w}=ae,{value:x}=ue,{value:Q}=Ze;if(!(!w||!x||!Q)&&e.allowDrop({node:x.rawNode,dropPosition:Q,phase:"drag"})&&w.key!==x.key){if(Q==="before"){const he=w.getNext({includeDisabled:!0});if(he&&he.key===x.key){Re();return}}if(Q==="after"){const he=w.getPrev({includeDisabled:!0});if(he&&he.key===x.key){Re();return}}bo({event:o,node:x.rawNode,dragNode:w.rawNode,dropPosition:v}),Ve()}}function To(){tt()}function Ro(){tt()}function No(o){var i;if(e.virtualScroll||e.internalScrollable){const{value:v}=f;if(!((i=v==null?void 0:v.containerRef)===null||i===void 0)&&i.contains(o.relatedTarget))return;X.value=null}else{const{value:v}=d;if(v!=null&&v.contains(o.relatedTarget))return;X.value=null}}be(X,o=>{var i,v;if(o!==null){if(e.virtualScroll)(i=h.value)===null||i===void 0||i.scrollTo({key:o});else if(e.internalScrollable){const{value:w}=f;if(w===null)return;const x=(v=w.contentRef)===null||v===void 0?void 0:v.querySelector(`[data-key="${zn(o)}"]`);if(!x)return;w.scrollTo({el:x})}}}),Pt(Xe,{loadingKeysRef:$,highlightKeySetRef:ut,displayedCheckedKeysRef:S,displayedIndeterminateKeysRef:L,mergedSelectedKeysRef:B,mergedExpandedKeysRef:b,mergedThemeRef:l,mergedCheckStrategyRef:A,nodePropsRef:H(e,"nodeProps"),disabledRef:H(e,"disabled"),checkableRef:H(e,"checkable"),selectableRef:H(e,"selectable"),expandOnClickRef:H(e,"expandOnClick"),onLoadRef:H(e,"onLoad"),draggableRef:H(e,"draggable"),blockLineRef:H(e,"blockLine"),indentRef:H(e,"indent"),cascadeRef:H(e,"cascade"),checkOnClickRef:H(e,"checkOnClick"),checkboxPlacementRef:e.checkboxPlacement,droppingMouseNodeRef:Qe,droppingNodeParentRef:lo,draggingNodeRef:ae,droppingPositionRef:Ze,droppingOffsetLevelRef:et,fNodesRef:E,pendingNodeKeyRef:X,showLineRef:H(e,"showLine"),disabledFieldRef:H(e,"disabledField"),internalScrollableRef:H(e,"internalScrollable"),internalCheckboxFocusableRef:H(e,"internalCheckboxFocusable"),internalTreeSelect:e.internalTreeSelect,renderLabelRef:H(e,"renderLabel"),renderPrefixRef:H(e,"renderPrefix"),renderSuffixRef:H(e,"renderSuffix"),renderSwitcherIconRef:H(e,"renderSwitcherIcon"),labelFieldRef:H(e,"labelField"),multipleRef:H(e,"multiple"),overrideDefaultNodeClickBehaviorRef:H(e,"overrideDefaultNodeClickBehavior"),handleSwitcherClick:Qt,handleDragEnd:wo,handleDragEnter:ko,handleDragLeave:Co,handleDragStart:$o,handleDrop:xo,handleDragOver:Zt,handleSelect:bt,handleCheck:yt});function Po(o,i){var v,w;typeof o=="number"?(v=h.value)===null||v===void 0||v.scrollTo(o,i||0):(w=h.value)===null||w===void 0||w.scrollTo(o)}const Fo={handleKeydown:Se,scrollTo:Po,getCheckedData:()=>{if(!e.checkable)return{keys:[],options:[]};const{checkedKeys:o}=I.value;return{keys:o,options:ge(o)}},getIndeterminateData:()=>{if(!e.checkable)return{keys:[],options:[]};const{indeterminateKeys:o}=I.value;return{keys:o,options:ge(o)}}},en=U(()=>{const{common:{cubicBezierEaseInOut:o},self:{fontSize:i,nodeBorderRadius:v,nodeColorHover:w,nodeColorPressed:x,nodeColorActive:Q,arrowColor:he,loadingColor:ye,nodeTextColor:Ae,nodeTextColorDisabled:Ee,dropMarkColor:me,nodeWrapperPadding:G,nodeHeight:pe,lineHeight:ke,lineColor:V}}=l.value,se=kt(G,"top"),Ke=kt(G,"bottom"),nt=Fn(Ge(pe)-Ge(se)-Ge(Ke));return{"--n-arrow-color":he,"--n-loading-color":ye,"--n-bezier":o,"--n-font-size":i,"--n-node-border-radius":v,"--n-node-color-active":Q,"--n-node-color-hover":w,"--n-node-color-pressed":x,"--n-node-text-color":Ae,"--n-node-text-color-disabled":Ee,"--n-drop-mark-color":me,"--n-node-wrapper-padding":G,"--n-line-offset-top":`-${se}`,"--n-line-offset-bottom":`-${Ke}`,"--n-node-content-height":nt,"--n-line-height":ke,"--n-line-color":V}}),Oe=n?Ft("tree",void 0,en,e):void 0;return Object.assign(Object.assign({},Fo),{mergedClsPrefix:t,mergedTheme:l,rtlEnabled:r,fNodes:so,aip:Fe,selfElRef:d,virtualListInstRef:h,scrollbarInstRef:f,handleFocusout:No,handleDragLeaveTree:So,handleScroll:To,getScrollContainer:s,getScrollContent:k,handleAfterEnter:co,handleResize:Ro,cssVars:n?void 0:en,themeClass:Oe==null?void 0:Oe.themeClass,onRender:Oe==null?void 0:Oe.onRender})},render(){var e;const{fNodes:t,internalRenderEmpty:n}=this;if(!t.length&&n)return n();const{mergedClsPrefix:a,blockNode:r,blockLine:l,draggable:d,disabled:f,internalFocusable:h,checkable:s,handleKeydown:k,rtlEnabled:T,handleFocusout:m,scrollbarProps:p}=this,g=h&&!f,y=g?"0":void 0,c=[`${a}-tree`,T&&`${a}-tree--rtl`,s&&`${a}-tree--checkable`,(l||r)&&`${a}-tree--block-node`,l&&`${a}-tree--block-line`],u=R=>"__motion"in R?C(qa,{height:R.height,nodes:R.nodes,clsPrefix:a,mode:R.mode,onAfterEnter:this.handleAfterEnter}):C(Wn,{key:R.key,tmNode:R,clsPrefix:a});if(this.virtualScroll){const{mergedTheme:R,internalScrollablePadding:I}=this,A=kt(I||"0");return C(sn,Object.assign({},p,{ref:"scrollbarInstRef",onDragleave:d?this.handleDragLeaveTree:void 0,container:this.getScrollContainer,content:this.getScrollContent,class:c,theme:R.peers.Scrollbar,themeOverrides:R.peerOverrides.Scrollbar,tabindex:y,onKeydown:g?k:void 0,onFocusout:g?m:void 0}),{default:()=>{var S;return(S=this.onRender)===null||S===void 0||S.call(this),t.length?C(Wo,{ref:"virtualListInstRef",items:this.fNodes,itemSize:Ge(R.self.nodeHeight),ignoreItemResize:this.aip,paddingTop:A.top,paddingBottom:A.bottom,class:this.themeClass,style:[this.cssVars,{paddingLeft:A.left,paddingRight:A.right}],onScroll:this.handleScroll,onResize:this.handleResize,showScrollbar:!1,itemResizable:!0},{default:({item:L})=>u(L)}):ln(this.$slots.empty,()=>[C(cn,{class:`${a}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})])}})}const{internalScrollable:_}=this;return c.push(this.themeClass),(e=this.onRender)===null||e===void 0||e.call(this),_?C(sn,Object.assign({},p,{class:c,tabindex:y,onKeydown:g?k:void 0,onFocusout:g?m:void 0,style:this.cssVars,contentStyle:{padding:this.internalScrollablePadding}}),{default:()=>C("div",{onDragleave:d?this.handleDragLeaveTree:void 0,ref:"selfElRef"},this.fNodes.map(u))}):C("div",{class:c,tabindex:y,ref:"selfElRef",style:this.cssVars,onKeydown:g?k:void 0,onFocusout:g?m:void 0,onDragleave:d?this.handleDragLeaveTree:void 0},t.length?t.map(u):ln(this.$slots.empty,()=>[C(cn,{class:`${a}-tree__empty`,theme:this.mergedTheme.peers.Empty,themeOverrides:this.mergedTheme.peerOverrides.Empty})]))}}),er={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},tr=oe("g",{fill:"none"},[oe("path",{d:"M6 2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7.414a1.5 1.5 0 0 0-.44-1.06l-3.914-3.915A1.5 1.5 0 0 0 10.586 2H6zM5 4a1 1 0 0 1 1-1h4v3.5A1.5 1.5 0 0 0 11.5 8H15v8a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V4zm9.793 3H11.5a.5.5 0 0 1-.5-.5V3.207L14.793 7z",fill:"currentColor"})],-1),nr=[tr],or=le({name:"Document20Regular",render:function(t,n){return N(),W("svg",er,nr)}}),ar={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},rr=oe("g",{fill:"none"},[oe("path",{d:"M7.167 3c.27 0 .535.073.765.21l.135.09l1.6 1.2H15.5a2.5 2.5 0 0 1 2.479 2.174l.016.162L18 7v7.5a2.5 2.5 0 0 1-2.336 2.495L15.5 17h-11a2.5 2.5 0 0 1-2.495-2.336L2 14.5v-9a2.5 2.5 0 0 1 2.336-2.495L4.5 3h2.667zm.99 4.034a1.5 1.5 0 0 1-.933.458l-.153.008L3 7.499V14.5a1.5 1.5 0 0 0 1.356 1.493L4.5 16h11a1.5 1.5 0 0 0 1.493-1.355L17 14.5V7a1.5 1.5 0 0 0-1.355-1.493L15.5 5.5H9.617l-1.46 1.534zM7.168 4H4.5a1.5 1.5 0 0 0-1.493 1.356L3 5.5v.999l4.071.001a.5.5 0 0 0 .302-.101l.06-.054L8.694 5.02L7.467 4.1a.5.5 0 0 0-.22-.093L7.167 4z",fill:"currentColor"})],-1),lr=[rr],ir=le({name:"Folder20Regular",render:function(t,n){return N(),W("svg",ar,lr)}}),sr={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},dr=oe("g",{fill:"none"},[oe("path",{d:"M5 3a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V6.621a2 2 0 0 0-.586-1.414l-1.621-1.621A2 2 0 0 0 11.379 3H5zM4 5a1 1 0 0 1 1-1h1v1.5A1.5 1.5 0 0 0 7.5 7h2A1.5 1.5 0 0 0 11 5.5V4h.379a1 1 0 0 1 .707.293l1.621 1.621a1 1 0 0 1 .293.707V13a1 1 0 0 1-1 1v-3.5A1.5 1.5 0 0 0 11.5 9h-5A1.5 1.5 0 0 0 5 10.5V14a1 1 0 0 1-1-1V5zm3 .5V4h3v1.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5zm5 5V14H6v-3.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5zM8.5 17a3.489 3.489 0 0 1-2.45-1h7.45a2.5 2.5 0 0 0 2.5-2.5V6.05c.618.632 1 1.497 1 2.45v5a3.5 3.5 0 0 1-3.5 3.5h-5z",fill:"currentColor"})],-1),cr=[dr],ur=le({name:"SaveMultiple20Regular",render:function(t,n){return N(),W("svg",sr,cr)}});var fr=Array.isArray,zt=fr,hr=typeof ot=="object"&&ot&&ot.Object===Object&&ot,vr=hr,gr=vr,yr=typeof self=="object"&&self&&self.Object===Object&&self,br=gr||yr||Function("return this")(),jt=br,mr=jt,pr=mr.Symbol,Ht=pr,vn=Ht,Yn=Object.prototype,_r=Yn.hasOwnProperty,kr=Yn.toString,qe=vn?vn.toStringTag:void 0;function Cr(e){var t=_r.call(e,qe),n=e[qe];try{e[qe]=void 0;var a=!0}catch{}var r=kr.call(e);return a&&(t?e[qe]=n:delete e[qe]),r}var Sr=Cr,wr=Object.prototype,$r=wr.toString;function xr(e){return $r.call(e)}var Tr=xr,gn=Ht,Rr=Sr,Nr=Tr,Pr="[object Null]",Fr="[object Undefined]",yn=gn?gn.toStringTag:void 0;function Dr(e){return e==null?e===void 0?Fr:Pr:yn&&yn in Object(e)?Rr(e):Nr(e)}var Jn=Dr;function Ir(e){return e!=null&&typeof e=="object"}var Or=Ir,Ar=Jn,Er=Or,Kr="[object Symbol]";function Lr(e){return typeof e=="symbol"||Er(e)&&Ar(e)==Kr}var Vt=Lr,Br=zt,Mr=Vt,zr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,jr=/^\w*$/;function Hr(e,t){if(Br(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||Mr(e)?!0:jr.test(e)||!zr.test(e)||t!=null&&e in Object(t)}var Vr=Hr;function Ur(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ut=Ur,Gr=Jn,qr=Ut,Wr="[object AsyncFunction]",Yr="[object Function]",Jr="[object GeneratorFunction]",Xr="[object Proxy]";function Qr(e){if(!qr(e))return!1;var t=Gr(e);return t==Yr||t==Jr||t==Wr||t==Xr}var Zr=Qr,el=jt,tl=el["__core-js_shared__"],nl=tl,wt=nl,bn=function(){var e=/[^.]+$/.exec(wt&&wt.keys&&wt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function ol(e){return!!bn&&bn in e}var al=ol,rl=Function.prototype,ll=rl.toString;function il(e){if(e!=null){try{return ll.call(e)}catch{}try{return e+""}catch{}}return""}var sl=il,dl=Zr,cl=al,ul=Ut,fl=sl,hl=/[\\^$.*+?()[\]{}|]/g,vl=/^\[object .+?Constructor\]$/,gl=Function.prototype,yl=Object.prototype,bl=gl.toString,ml=yl.hasOwnProperty,pl=RegExp("^"+bl.call(ml).replace(hl,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function _l(e){if(!ul(e)||cl(e))return!1;var t=dl(e)?pl:vl;return t.test(fl(e))}var kl=_l;function Cl(e,t){return e==null?void 0:e[t]}var Sl=Cl,wl=kl,$l=Sl;function xl(e,t){var n=$l(e,t);return wl(n)?n:void 0}var Gt=xl,Tl=Gt,Rl=Tl(Object,"create"),it=Rl,mn=it;function Nl(){this.__data__=mn?mn(null):{},this.size=0}var Pl=Nl;function Fl(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Dl=Fl,Il=it,Ol="__lodash_hash_undefined__",Al=Object.prototype,El=Al.hasOwnProperty;function Kl(e){var t=this.__data__;if(Il){var n=t[e];return n===Ol?void 0:n}return El.call(t,e)?t[e]:void 0}var Ll=Kl,Bl=it,Ml=Object.prototype,zl=Ml.hasOwnProperty;function jl(e){var t=this.__data__;return Bl?t[e]!==void 0:zl.call(t,e)}var Hl=jl,Vl=it,Ul="__lodash_hash_undefined__";function Gl(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Vl&&t===void 0?Ul:t,this}var ql=Gl,Wl=Pl,Yl=Dl,Jl=Ll,Xl=Hl,Ql=ql;function Be(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}Be.prototype.clear=Wl;Be.prototype.delete=Yl;Be.prototype.get=Jl;Be.prototype.has=Xl;Be.prototype.set=Ql;var Zl=Be;function ei(){this.__data__=[],this.size=0}var ti=ei;function ni(e,t){return e===t||e!==e&&t!==t}var Xn=ni,oi=Xn;function ai(e,t){for(var n=e.length;n--;)if(oi(e[n][0],t))return n;return-1}var st=ai,ri=st,li=Array.prototype,ii=li.splice;function si(e){var t=this.__data__,n=ri(t,e);if(n<0)return!1;var a=t.length-1;return n==a?t.pop():ii.call(t,n,1),--this.size,!0}var di=si,ci=st;function ui(e){var t=this.__data__,n=ci(t,e);return n<0?void 0:t[n][1]}var fi=ui,hi=st;function vi(e){return hi(this.__data__,e)>-1}var gi=vi,yi=st;function bi(e,t){var n=this.__data__,a=yi(n,e);return a<0?(++this.size,n.push([e,t])):n[a][1]=t,this}var mi=bi,pi=ti,_i=di,ki=fi,Ci=gi,Si=mi;function Me(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}Me.prototype.clear=pi;Me.prototype.delete=_i;Me.prototype.get=ki;Me.prototype.has=Ci;Me.prototype.set=Si;var wi=Me,$i=Gt,xi=jt,Ti=$i(xi,"Map"),Ri=Ti,pn=Zl,Ni=wi,Pi=Ri;function Fi(){this.size=0,this.__data__={hash:new pn,map:new(Pi||Ni),string:new pn}}var Di=Fi;function Ii(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var Oi=Ii,Ai=Oi;function Ei(e,t){var n=e.__data__;return Ai(t)?n[typeof t=="string"?"string":"hash"]:n.map}var dt=Ei,Ki=dt;function Li(e){var t=Ki(this,e).delete(e);return this.size-=t?1:0,t}var Bi=Li,Mi=dt;function zi(e){return Mi(this,e).get(e)}var ji=zi,Hi=dt;function Vi(e){return Hi(this,e).has(e)}var Ui=Vi,Gi=dt;function qi(e,t){var n=Gi(this,e),a=n.size;return n.set(e,t),this.size+=n.size==a?0:1,this}var Wi=qi,Yi=Di,Ji=Bi,Xi=ji,Qi=Ui,Zi=Wi;function ze(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}ze.prototype.clear=Yi;ze.prototype.delete=Ji;ze.prototype.get=Xi;ze.prototype.has=Qi;ze.prototype.set=Zi;var es=ze,Qn=es,ts="Expected a function";function qt(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(ts);var n=function(){var a=arguments,r=t?t.apply(this,a):a[0],l=n.cache;if(l.has(r))return l.get(r);var d=e.apply(this,a);return n.cache=l.set(r,d)||l,d};return n.cache=new(qt.Cache||Qn),n}qt.Cache=Qn;var ns=qt,os=ns,as=500;function rs(e){var t=os(e,function(a){return n.size===as&&n.clear(),a}),n=t.cache;return t}var ls=rs,is=ls,ss=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ds=/\\(\\)?/g,cs=is(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(ss,function(n,a,r,l){t.push(r?l.replace(ds,"$1"):a||n)}),t}),us=cs;function fs(e,t){for(var n=-1,a=e==null?0:e.length,r=Array(a);++n<a;)r[n]=t(e[n],n,e);return r}var hs=fs,_n=Ht,vs=hs,gs=zt,ys=Vt,bs=1/0,kn=_n?_n.prototype:void 0,Cn=kn?kn.toString:void 0;function Zn(e){if(typeof e=="string")return e;if(gs(e))return vs(e,Zn)+"";if(ys(e))return Cn?Cn.call(e):"";var t=e+"";return t=="0"&&1/e==-bs?"-0":t}var ms=Zn,ps=ms;function _s(e){return e==null?"":ps(e)}var ks=_s,Cs=zt,Ss=Vr,ws=us,$s=ks;function xs(e,t){return Cs(e)?e:Ss(e,t)?[e]:ws($s(e))}var Wt=xs,Ts=Vt,Rs=1/0;function Ns(e){if(typeof e=="string"||Ts(e))return e;var t=e+"";return t=="0"&&1/e==-Rs?"-0":t}var Yt=Ns,Ps=Wt,Fs=Yt;function Ds(e,t){t=Ps(t,e);for(var n=0,a=t.length;e!=null&&n<a;)e=e[Fs(t[n++])];return n&&n==a?e:void 0}var eo=Ds,Is=eo;function Os(e,t,n){var a=e==null?void 0:Is(e,t);return a===void 0?n:a}var As=Os;const Es=Ot(As);var Ks=Gt,Ls=function(){try{var e=Ks(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Bs=Ls,Sn=Bs;function Ms(e,t,n){t=="__proto__"&&Sn?Sn(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var zs=Ms,js=zs,Hs=Xn,Vs=Object.prototype,Us=Vs.hasOwnProperty;function Gs(e,t,n){var a=e[t];(!(Us.call(e,t)&&Hs(a,n))||n===void 0&&!(t in e))&&js(e,t,n)}var qs=Gs,Ws=9007199254740991,Ys=/^(?:0|[1-9]\d*)$/;function Js(e,t){var n=typeof e;return t=t??Ws,!!t&&(n=="number"||n!="symbol"&&Ys.test(e))&&e>-1&&e%1==0&&e<t}var Xs=Js,Qs=qs,Zs=Wt,ed=Xs,wn=Ut,td=Yt;function nd(e,t,n,a){if(!wn(e))return e;t=Zs(t,e);for(var r=-1,l=t.length,d=l-1,f=e;f!=null&&++r<l;){var h=td(t[r]),s=n;if(h==="__proto__"||h==="constructor"||h==="prototype")return e;if(r!=d){var k=f[h];s=a?a(k,h,f):void 0,s===void 0&&(s=wn(k)?k:ed(t[r+1])?[]:{})}Qs(f,h,s),f=f[h]}return e}var od=nd,ad=od;function rd(e,t,n){return e==null?e:ad(e,t,n)}var ld=rd;const id=Ot(ld);function sd(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var dd=sd;function cd(e,t,n){var a=-1,r=e.length;t<0&&(t=-t>r?0:r+t),n=n>r?r:n,n<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var l=Array(r);++a<r;)l[a]=e[a+t];return l}var ud=cd,fd=eo,hd=ud;function vd(e,t){return t.length<2?e:fd(e,hd(t,0,-1))}var gd=vd,yd=Wt,bd=dd,md=gd,pd=Yt;function _d(e,t){return t=yd(t,e),e=md(e,t),e==null||delete e[pd(bd(t))]}var kd=_d,Cd=kd;function Sd(e,t){return e==null?!0:Cd(e,t)}var wd=Sd;const $d=Ot(wd),je=Qo("i18nToolMain",{state:()=>({dirTree:[],filePathArr:[],translatePath:"",changedLabelMap:{}})}),to=e=>{const t=je(),n=rt(),a=D(),r=async()=>{for(let d=0;d<a.value.length;d++)await a.value[d].saveChange({isSetValue:!0})};It(()=>{xt.on(Tt.ON_I18N_SAVE_ALL_CHANGES,r)}),At(()=>{xt.off(Tt.ON_I18N_SAVE_ALL_CHANGES,r)});const l=U(()=>n.isFoldersMode?t.dirTree.filter(d=>d.kind==="directory"):t.dirTree);return{handleSaveChanged:r,itemsRef:a,filePathArrFiltered:l}};async function xd(e,t){if(!t)return e;const n=t.split("/");let a=e;for(const r of n)a=await a.getDirectoryHandle(r,{create:!0});return console.log(`Folder "${t}" created successfully.`),a}async function Td(e,t,n){console.log("[createFile] 获取文件的可写入流");const a=await e.getFileHandle(t,{create:!0}),r=await a.createWritable();return console.log("[createFile] 将数据写入文件"),await r.write(n),console.log("[createFile] 关闭文件写入流"),await r.close(),console.log(`[createFile] ${t} created and written successfully.`),a}const no=e=>{const t=je(),n=rt(),{t:a}=Et(),r=D(!1),{dirItem:l}=Kt(e),d=U(()=>n.isFoldersMode?t.filePathArr.slice(1):t.filePathArr),f=()=>{let p=null;const g=(y,c,u=0)=>{const _=c[u];if(y)for(let R=0;R<y.length;R++){const I=y[R];if(I.label===_&&u===c.length-1)throw p=I,new Error("item found");I.children&&g(I.children,c,u+1)}};try{g(l.value.children,d.value)}catch{}return p},h=U(()=>n.isFoldersMode?f():l.value),s=async p=>{try{if(r.value=!0,!h.value)return;const g=h.value.entry;if(!g)return;const y=await g.createWritable();await y.write(p),await y.close();const c=l.value.label+": "+g.name;console.log("[handleSaveFile]",c),window.$message.success(`${c} `+a("msgs.saved"))}catch(g){throw console.error(g),window.$message.error(a("msgs.error")+g.message),g}finally{r.value=!1}},k=()=>{const p=document.querySelector(".js_reload_btn");p&&p.click()},T=D(!1);return{isLoading:r,currentItem:h,handleSaveFile:s,isLocalCreated:T,handleCreateFile:async p=>{try{if(r.value=!0,!l.value)return;const g=l.value.entry;if(!g)return;const y=d.value.join("/"),c=y.substring(0,y.lastIndexOf("/")),u=await xd(g,c),_=JSON.stringify({},null,2),R=await Td(u,y.substring(y.lastIndexOf("/")+1),_);window.$message.success("Created "+y),T.value=!0,typeof p=="function"&&await p(),setTimeout(()=>{k()})}catch(g){console.error(g),window.$message.error(g.message)}finally{r.value=!1}},handleReload:k,subFilePathArr:d}},Rd=le({name:"SubGuiItem",components:{CcFlag:$n,Delete20Regular:Do,FieldEdit:xn,DialogTextEdit:Tn,SaveMultiple20Regular:ur,ClipboardPaste20Regular:Zo},props:{dirItem:{type:Object,required:!0}},emits:["saveChanged"],setup(e,{emit:t}){Kt(e),Et();const n=je(),a=rt(),{isLoading:r,currentItem:l,handleSaveFile:d,isLocalCreated:f,handleCreateFile:h,handleReload:s,subFilePathArr:k}=no(e);let T=Dn(null);const m=D(null),p=D(!1),g=()=>Es(T.value,n.translatePath,null),y=b=>{try{id(T.value,n.translatePath,b)}catch(E){throw console.error(E),window.$message.error(E.message),E}},c=()=>{$d(T.value,n.translatePath),m.value=null,p.value=!0},u=()=>{T.value=null,m.value=null,ve(()=>{p.value=!1})};At(()=>{u()}),be(l,async b=>{if(!b){u();return}const E=await b.entry.getFile(),X=await Lt(E);T.value=JSON.parse(X),m.value=g(),ve(()=>{p.value=!1})},{immediate:!0}),be(m,()=>{p.value=!0}),be(()=>n.translatePath,b=>{m.value=g(),ve(()=>{p.value=!1})});const _=D(),R=D(!1),I=b=>{y(b),m.value=b,R.value=!0,ve(()=>{_.value.focus()})},A=b=>(b=ta(b,a.autoPasteTextConvertMode,{isTrimQuotes:a.autoPasteTrimQuotes}),b),S=async()=>{const b=await ea();I(A(b))},L=async({isEmit:b=!1,isSetValue:E=!1}={})=>{p.value&&(E&&y(m.value),await d(JSON.stringify(T.value,null,2)),p.value=!1,b&&t("saveChanged"))},te=()=>{if(R.value){c(),R.value=!1;return}m.value=g(),ve(()=>{p.value=!1})},ne=D(!1),B=D("");return be(ne,b=>{b||(B.value="")}),{i18nMainStore:n,i18nSetStore:a,currentItem:l,translateObj:T,fieldValue:m,isChanged:p,createField:I,pasteCreateField:S,saveChange:L,cancelChange:te,inputRef:_,isLocalCreated:f,handleCreateFile:h,handleReload:s,isShowArrayEdit:ne,currentArrayString:B,handlePreviewArrayText:()=>{B.value=JSON.stringify(m.value,null,2),ne.value=!0},handleSaveArray:b=>{try{m.value=JSON.parse(b),ne.value=!1}catch(E){console.error(E),window.$message.error(E.message)}},handleDeleteField:()=>{c(),L()},isLoading:r,subFilePathArr:k}}}),Nd={key:0,class:"mc-loading-container"},Pd={class:"card-header"},Fd={class:"card-title-wrap"},Dd={class:"card-title"},Id={class:"text-red"},Od={class:"translate-path"},Ad={key:1,class:"tip-not-exist"},Ed={key:3,style:{color:"gray"}};function Kd(e,t,n,a,r,l){const d=Mt,f=$n,h=Ye("Delete20Regular"),s=Bt,k=In,T=xn,m=Ye("SaveMultiple20Regular"),p=na,g=On,y=Ye("ClipboardPaste20Regular"),c=Tn,u=An;return N(),re(u,{size:"small",class:"batch-translate-item"},{default:P(()=>[e.isLoading?(N(),W("div",Nd,[K(d,{size:"small"})])):_e("",!0),oe("div",Pd,[oe("div",Fd,[oe("span",Dd,[e.i18nSetStore.enableFlag?(N(),re(f,{key:0,cc:e.dirItem.label},null,8,["cc"])):_e("",!0),oe("span",Id,J(e.dirItem.label),1),e.i18nSetStore.isFoldersMode?(N(),W(Te,{key:1},[q(J("/"+e.subFilePathArr.join("/")),1)],64)):_e("",!0)]),oe("span",Od,J(e.i18nMainStore.translatePath),1)]),e.currentItem&&e.fieldValue!==null?(N(),re(k,{key:0,onPositiveClick:e.handleDeleteField},{trigger:P(()=>[K(s,{size:"small",tertiary:"",type:"error",title:"Delete Field"},{icon:P(()=>[K(h)]),_:1})]),default:P(()=>[q(" "+J(e.$t("msgs.remove_item")),1)]),_:1},8,["onPositiveClick"])):_e("",!0)]),e.currentItem?e.i18nMainStore.translatePath?(N(),W(Te,{key:2},[e.fieldValue!==null?(N(),re(g,{key:0,align:"center",size:"small"},{default:P(()=>[K(T,{ref:"inputRef",modelValue:e.fieldValue,"onUpdate:modelValue":t[1]||(t[1]=_=>e.fieldValue=_),onPreviewArray:e.handlePreviewArrayText},null,8,["modelValue","onPreviewArray"]),e.isChanged?(N(),re(p,{key:0},{default:P(()=>[K(s,{size:"small",type:"primary",onClick:t[2]||(t[2]=_=>e.saveChange({isEmit:!0,isSetValue:!0})),title:"Batch Save"},{icon:P(()=>[K(m)]),_:1}),K(s,{secondary:"",size:"small",onClick:e.cancelChange},{default:P(()=>[q(J(e.$t("actions.cancel")),1)]),_:1},8,["onClick"])]),_:1})):_e("",!0)]),_:1})):(N(),re(p,{key:1},{default:P(()=>[K(s,{size:"small",onClick:t[3]||(t[3]=_=>e.pasteCreateField()),type:"primary",title:`Auto Paste Create (${e.i18nSetStore.autoPasteTextConvertMode})`},{icon:P(()=>[K(y)]),_:1},8,["title"]),K(s,{size:"small",onClick:t[4]||(t[4]=_=>e.createField("")),type:"primary"},{default:P(()=>[q(J(e.$t("actions.create_text")),1)]),_:1}),K(s,{size:"small",onClick:t[5]||(t[5]=_=>e.createField([]))},{default:P(()=>[q(J(e.$t("actions.create_array")),1)]),_:1})]),_:1}))],64)):(N(),W("div",Ed,J(e.$t("msgs.please_select_a_tran")),1)):(N(),W("div",Ad,[e.isLocalCreated?(N(),re(s,{key:0,secondary:"",size:"small",onClick:e.handleReload},{default:P(()=>[q(J(e.$t("actions.reload")),1)]),_:1},8,["onClick"])):(N(),W(Te,{key:1},[q(" File does not exist, please "),oe("b",{style:{"text-decoration":"underline",cursor:"pointer"},onClick:t[0]||(t[0]=(..._)=>e.handleCreateFile&&e.handleCreateFile(..._))}," create it "),q(" on your local file system ")],64))])),e.isShowArrayEdit?(N(),re(c,{key:4,"is-textarea":"",title:e.$t("common.array_detail"),placeholder:e.$t("common.array_json_string"),visible:e.isShowArrayEdit,"onUpdate:visible":t[6]||(t[6]=_=>e.isShowArrayEdit=_),text:e.currentArrayString,onOnSave:e.handleSaveArray},null,8,["title","placeholder","visible","text","onOnSave"])):_e("",!0)]),_:1})}const oo=Je(Rd,[["render",Kd]]),Ld=le({name:"BatchTranslate",components:{SubGuiItem:oo},props:{},setup(e,{emit:t}){const{handleSaveChanged:n,itemsRef:a,filePathArrFiltered:r}=to();return{handleSaveChanged:n,itemsRef:a,filePathArrFiltered:r}}}),Bd={class:"batch-translate"};function Md(e,t,n,a,r,l){const d=oo;return N(),W("div",Bd,[(N(!0),W(Te,null,at(e.filePathArrFiltered,f=>(N(),re(d,{ref_for:!0,ref:"itemsRef",key:f.key,"dir-item":f,onSaveChanged:e.handleSaveChanged},null,8,["dir-item","onSaveChanged"]))),128))])}const zd=Je(Ld,[["render",Md],["__scopeId","data-v-8fa4c85c"]]),jd=le({name:"SubTextItem",components:{TranslateTreeItem:Rt,VueMonaco:En},props:{visible:{type:Boolean,default:!0},dirItem:{type:Object,required:!0},translatePath:{type:String,default:""}},emits:["saveChanged"],setup(e,{emit:t}){const{visible:n,dirItem:a}=Kt(e),r=je(),{isLoading:l,currentItem:d,handleSaveFile:f,isLocalCreated:h,handleCreateFile:s,handleReload:k,subFilePathArr:T}=no(e),m=D(""),p=D(),g=()=>{setTimeout(()=>{p.value.getInstance().focus()},100)},y=U(()=>r.changedLabelMap[a.value.label]),c=S=>{r.changedLabelMap[a.value.label]=S};be(m,()=>{c(!0)}),be(n,S=>{S&&(ve(()=>{var L;(L=p.value)==null||L.resize()}),g())});const u=oa(500,!1,()=>{ve(()=>{var S;(S=p.value)==null||S.resize()})}),_=()=>{m.value="",ve(()=>{c(!1)})};It(()=>{window.addEventListener("resize",u),ve(()=>{u()})}),At(()=>{_(),window.removeEventListener("resize",u)});const R=async()=>{const S=await d.value.entry.getFile(),L=await Lt(S);m.value=L,await ve(()=>{var te;c(!1),(te=p.value)==null||te.resize()})};return be(d,async S=>{if(!S){_();return}await R()},{immediate:!0}),{isLoading:l,valueText:m,currentItem:d,vueMonacoRef:p,saveChange:async({isEmit:S=!1}={})=>{y.value&&(await f(m.value),c(!1),S&&t("saveChanged"))},isChanged:y,handleCreateFile:async()=>{await s()},subFilePathArr:T}}}),Hd={class:"sub-text-editor"},Vd={key:0,class:"mc-loading-container"},Ud={class:"editor-action-row"},Gd={class:"editor-content-wrap"},qd={key:0,class:"tip-not-exist"};function Wd(e,t,n,a,r,l){const d=Mt,f=Bt,h=En;return Kn((N(),W("div",Hd,[e.isLoading?(N(),W("div",Vd,[K(d,{size:"small"})])):_e("",!0),oe("div",Ud,[K(f,{size:"small",type:"primary",disabled:!e.isChanged,onClick:t[0]||(t[0]=s=>e.saveChange({isEmit:!0}))},{default:P(()=>[q(" Save All ")]),_:1},8,["disabled"]),q(" "+J(e.subFilePathArr.join("/"))+" "+J(e.dirItem.label),1)]),oe("div",Gd,[e.currentItem?(N(),re(h,{key:1,ref:"vueMonacoRef",modelValue:e.valueText,"onUpdate:modelValue":t[2]||(t[2]=s=>e.valueText=s),language:"json","show-line-numbers":""},null,8,["modelValue"])):(N(),W("div",qd,[q(" File does not exist, please "),oe("b",{style:{"text-decoration":"underline",cursor:"pointer"},onClick:t[1]||(t[1]=(...s)=>e.handleCreateFile&&e.handleCreateFile(...s))}," create it "),q(" on your local file system ")]))])],512)),[[Ln,e.visible]])}const ao=Je(jd,[["render",Wd],["__scopeId","data-v-930c855b"]]),Yd=le({name:"BatchText",components:{SubTextItem:ao},props:{},setup(e,{emit:t}){const n=je(),{handleSaveChanged:a,itemsRef:r,filePathArrFiltered:l}=to(),d=D("");return be(l,f=>{if(!d.value){d.value=f[0].key;return}f.find(s=>s.key===d.value)||(d.value=f[0].key)},{immediate:!0}),{i18nMainStore:n,handleSaveChanged:a,itemsRef:r,filePathArrFiltered:l,currentTab:d}}}),Jd={class:"batch-text-editor"},Xd={class:"editor-tabs-wrap"},Qd={class:"editor-wrap"};function Zd(e,t,n,a,r,l){const d=_a,f=ka,h=ao;return N(),W("div",Jd,[oe("div",Xd,[K(f,{size:"small",type:"card",animated:"",value:e.currentTab,"onUpdate:value":t[0]||(t[0]=s=>e.currentTab=s)},{default:P(()=>[(N(!0),W(Te,null,at(e.filePathArrFiltered,s=>(N(),re(d,{style:{padding:"0"},name:s.key,tab:(e.i18nMainStore.changedLabelMap[s.label]?"* ":"")+s.label,key:s.key},null,8,["name","tab"]))),128))]),_:1},8,["value"])]),oe("div",Qd,[(N(!0),W(Te,null,at(e.filePathArrFiltered,s=>(N(),re(h,{ref_for:!0,ref:"itemsRef",key:s.key,"dir-item":s,visible:s.key===e.currentTab,onSaveChanged:e.handleSaveChanged},null,8,["dir-item","visible","onSaveChanged"]))),128))])])}const ec=Je(Yd,[["render",Zd],["__scopeId","data-v-ab2c01f3"]]),$t=(e={})=>({key:e.key,kind:e.kind,label:e.label,entry:e.entry,parentDirs:e.parentDirs,children:e.children||null,prefix:()=>C(ua,{size:18},{default:()=>C(e.kind==="directory"?ir:or)})});var ro=(e=>(e.TEXT="text",e.GUI="gui",e.BATCH="batch",e))(ro||{});const tc=[{label:"TEXT",value:"text"},{label:"SINGLE",value:"gui"},{label:"BATCH",value:"batch"}],nc=le({name:"VueI18nBatchTool",components:{TabLayout:Bn,BatchTextEditor:ec,I18nToolSettings:Rn,TranslateTreeItem:Rt,BatchTranslate:zd,DropZone:Mn},setup(){const{t:e}=Et(),t=aa(),n=je(),a=rt(),r=D(!1),{data:l,set:d}=Io(ra.I18N_FOLDER_HANDLE_HISTORY,[]),f=un("vue_i18n_dir_tool_expanded_keys",[]),h=F=>!a.ignoreFoldersMap[F],s=async(F,b=0,E=[],X=[],Se="")=>{for await(const M of F.values())if(M.kind==="directory"&&h(M.name)){let ce=[];const Ce=`${Se}${b}-${M.name}`;E.push($t({key:Ce,kind:M.kind,label:M.name,entry:M,parentDirs:X,children:ce})),await s(M,b+1,ce,[...X,M.name],Ce+"_")}else if(/\.json$/gi.test(M.name)){const Ce=`${Se}${b}-${M.name}`;E.push($t({key:Ce,kind:M.kind,label:M.name,entry:M,parentDirs:X,children:null}))}return E.sort((M,ce)=>M.kind==="directory"&&ce.kind==="file"?-1:M.kind==="file"&&ce.kind==="directory"?1:0),E},k=async(F,b=[])=>{let E=0;for await(const X of F.values())if(E++,X.kind!=="directory"&&/\.json$/gi.test(X.name)){const M=`${E}-${X.kind}-${X.name}`;b.push($t({key:M,kind:X.kind,label:X.name,entry:X,parentDirs:[],children:null}))}return console.log("[readJsonFiles]",b),b},T=async F=>{console.log(F);const b=[...l.value];b.push({handle:F,lastOpened:Date.now()}),await d(b.slice(0,5))},m=Dn(),p=async()=>{const F=await window.showDirectoryPicker();await T(F),m.value=F,await g()},g=async()=>{try{r.value=!0;const F=m.value;let b=[];a.isFoldersMode?b=await s(F):b=await k(F),b.length||window.$message.error("The content is empty, please check the folder directory structure!"),n.dirTree=b}catch(F){console.error(F),window.$message.error(F.message)}finally{r.value=!1}},y=async F=>{try{r.value=!0;for(const b of F.dataTransfer.items)if(b.kind==="file"){const E=await b.getAsFileSystemHandle();if(E.kind==="directory"){await T(E),m.value=E,await g();break}else window.$message.error("Please drag and drop a folder here!")}}catch(b){console.error(b),window.$message.error(b.message)}finally{r.value=!1}},c=()=>{m.value=null,u.value=null,_.value=null,n.dirTree=[],n.filePathArr=[]},u=D(null),_=D(null),R=async()=>{try{r.value=!0;const F=u.value;if(!F)return;const b=await F.createWritable();if(I.value!=="text"&&(_.value=JSON.stringify(da(A.value),null,2)),!_.value)throw new Error("editingTextValue is empty!");await b.write(_.value),await b.close(),await g(),window.$message.success(e("msgs.saved"))}catch(F){console.error(F),window.$message.error("Save Failed!"+F.message)}finally{r.value=!1}},I=un("vue_i18n_dir_tool_edit_mode","batch"),A=D([la()]),S=()=>{if(I.value!=="text"){if(!_.value){A.value=[];return}const F=JSON.parse(_.value);A.value=ca.parseWithRoot(F)}};be(I,F=>{S()});const{metaTitle:L}=ya();ia(()=>{if(u.value&&I.value==="gui"){R();return}xt.emit(Tt.ON_I18N_SAVE_ALL_CHANGES)});const te=D();sa(()=>!!m.value);const ne=D(!1),B=({option:F})=>({async onClick(){try{if(r.value=!0,F.kind==="file"){const b=F.entry;u.value=b;const E=await Lt(await b.getFile());_.value=E,n.filePathArr=[...F.parentDirs,F.label],n.translatePath="",S()}}catch(b){console.error(b),window.$message.error(b.message)}finally{r.value=!1}}}),ee=(F,b)=>{const E=".translate-item";n.translatePath=F,Array.from(document.querySelectorAll(E)).forEach(Se=>{Se.classList.remove("active")}),b.target.closest(E).classList.add("active")},we=U(()=>{if(l.value.length)return[...l.value.reverse().map(F=>{const{handle:b}=F;return{label:b.name,props:{onClick:async()=>{await Ao(b)&&(m.value=b,await g())}}}}),{label:"🧹 Clear History",props:{onClick:()=>{l.value=[]}}}]});return{metaTitle:L,i18nMainStore:n,iconTranslate:Oo,handlePickDir:p,handleCloseDir:c,dirHandle:m,reloadPickedDir:g,vueMonacoRef:te,nodeProps:B,editingTextValue:_,currentEditEntry:u,handleSaveFile:R,editMode:I,EditMode:ro,editModeOptions:tc,translateTreeRoot:A,handleKeyClick:ee,...ba({cb:y}),i18nSetStore:a,mainStore:t,isShowToolSettings:ne,isLoading:r,expandedKeys:f,historyOptions:we}}}),oc={key:0,class:"mc-loading-container position-fixed"},ac={class:"vp-panel navbar-wrap"},rc={class:"_container"},lc={class:"main-edit-wrap"},ic={key:1,class:"edit-content-wrap batch-mode"},sc={key:1,class:"null-intro"},dc={key:0,class:"intro-title"},cc={key:1,class:"font-code"},uc=["value"];function fc(e,t,n,a,r,l){const d=Mt,f=Mn,h=pa,s=Bt,k=Bn,T=In,m=va,p=On,g=ma,y=Za,c=Ka,u=Oa,_=Ye("BatchTextEditor"),R=An,I=Rt,A=Ye("BatchTranslate"),S=ga,L=Na,te=Ra,ne=Rn;return N(),W("div",{class:"vue-i18n-dir-tool i18n-style",onDragover:t[9]||(t[9]=Ct((...B)=>e.fileDragover&&e.fileDragover(...B),["prevent","stop"])),onDragleave:t[10]||(t[10]=Ct(B=>e.showDropzone=!1,["prevent","stop"])),onDrop:t[11]||(t[11]=Ct((...B)=>e.fileDrop&&e.fileDrop(...B),["prevent","stop"]))},[K(fn,{name:"mc-fade"},{default:P(()=>[e.isLoading?(N(),W("div",oc,[K(d)])):_e("",!0)]),_:1}),K(fn,{name:"mc-fade"},{default:P(()=>[Kn(K(f,{"position-fixed":"",text:e.$t("msgs.drag_folder_here")},null,8,["text"]),[[Ln,e.showDropzone]])]),_:1}),oe("div",ac,[K(g,{subtitle:"",onBack:t[5]||(t[5]=B=>e.$router.push({name:"HomePage"}))},{title:P(()=>[q(J(e.metaTitle),1)]),avatar:P(()=>[K(h,{src:e.iconTranslate,style:{background:"none"}},null,8,["src"])]),extra:P(()=>[K(p,{align:"center"},{default:P(()=>[K(s,{secondary:"",size:"small",onClick:t[0]||(t[0]=B=>e.isShowToolSettings=!0)},{default:P(()=>[q(J(e.$t("common.settings")),1)]),_:1}),K(s,{secondary:"",size:"small",onClick:t[1]||(t[1]=B=>e.mainStore.isShowQuickLaunch=!0)},{default:P(()=>[q(J(e.$t("common.tools")),1)]),_:1}),e.currentEditEntry&&e.editMode===e.EditMode.GUI?(N(),re(s,{key:0,size:"small",secondary:"",type:"primary",onClick:e.handleSaveFile},{default:P(()=>[q(J(e.$t("actions.save_changes")),1)]),_:1},8,["onClick"])):_e("",!0),q(" "+J(e.$t("common.edit_mode"))+": ",1),K(k,{modelValue:e.editMode,"onUpdate:modelValue":t[2]||(t[2]=B=>e.editMode=B),horizontal:"","tab-list":e.editModeOptions},null,8,["modelValue","tab-list"]),e.dirHandle?(N(),re(T,{key:1,onPositiveClick:t[3]||(t[3]=B=>e.handleCloseDir())},{trigger:P(()=>[K(s,{secondary:"",type:"primary",size:"small"},{default:P(()=>[q(J(e.$t("actions.close"))+" Folder ",1)]),_:1})]),default:P(()=>[q(" Confirm close folder? Unsaved contents will be lost. ")]),_:1})):(N(),re(m,{key:2,size:"small",options:e.historyOptions},{default:P(()=>[K(s,{type:"primary",size:"small",onClick:e.handlePickDir},{default:P(()=>[q(J(e.$t("actions.pick_i18n_directory")),1)]),_:1},8,["onClick"])]),_:1},8,["options"])),e.dirHandle?(N(),re(T,{key:3,onPositiveClick:t[4]||(t[4]=B=>e.reloadPickedDir())},{trigger:P(()=>[K(s,{secondary:"",size:"small",class:"js_reload_btn"},{default:P(()=>[q(J(e.$t("actions.reload")),1)]),_:1})]),default:P(()=>[q(" "+J(e.$t("msgs.confirm_reload_files")),1)]),_:1})):_e("",!0)]),_:1})]),_:1})]),oe("div",rc,[K(te,{style:{height:"100%"},"has-sider":""},{default:P(()=>[K(u,{"collapse-mode":"width","collapsed-width":0,width:300,"show-trigger":"arrow-circle","content-style":"padding: 10px;",bordered:""},{default:P(()=>[K(c,{style:{height:"100%"}},{default:P(()=>[K(y,{"block-line":"",data:e.i18nMainStore.dirTree,"node-props":e.nodeProps,"default-expand-all":!1,"expand-on-click":"",selectable:"",class:"font-code","virtual-scroll":"","expanded-keys":e.expandedKeys,"onUpdate:expandedKeys":t[6]||(t[6]=B=>e.expandedKeys=B)},null,8,["data","node-props","expanded-keys"])]),_:1})]),_:1}),K(L,null,{default:P(()=>[oe("div",lc,[e.currentEditEntry?(N(),W(Te,{key:0},[e.editMode===e.EditMode.TEXT?(N(),re(_,{key:0})):(N(),W("div",ic,[K(c,{class:"gui-edit-gui",style:fa({width:e.editMode===e.EditMode.BATCH?"500px":"100%"})},{default:P(()=>[e.editMode===e.EditMode.BATCH?(N(),re(R,{key:0,class:"action-row"},{default:P(()=>[K(s,{size:"tiny"},{default:P(()=>[q("Analyse")]),_:1})]),_:1})):_e("",!0),(N(!0),W(Te,null,at(e.translateTreeRoot,(B,ee)=>(N(),re(I,{key:ee,index:ee,item:B,"is-lite":e.editMode===e.EditMode.BATCH,title:e.i18nMainStore.filePathArr.join("/"),onOnKeyClick:e.handleKeyClick},null,8,["index","item","is-lite","title","onOnKeyClick"]))),128))]),_:1},8,["style"]),e.editMode===e.EditMode.BATCH?(N(),re(c,{key:0,class:"gui-edit-batch"},{default:P(()=>[K(A)]),_:1})):_e("",!0)]))],64)):(N(),W("div",sc,[e.i18nMainStore.dirTree.length?(N(),W("div",dc,"👈 "+J(e.$t("msgs.please_select_a_json")),1)):(N(),W("div",cc,[K(p,{align:"center",class:"intro-title"},{default:P(()=>[K(S,{size:"large",value:e.i18nSetStore.isFoldersMode,"onUpdate:value":t[7]||(t[7]=B=>e.i18nSetStore.isFoldersMode=B)},{checked:P(()=>[q(J(e.$t("common.folders_mode")),1)]),unchecked:P(()=>[q(J(e.$t("common.files_mode")),1)]),_:1},8,["value"]),q(" 📁 "+J(e.$t("msgs.recommended_i18n_fol"))+": ",1)]),_:1}),oe("textarea",{class:ha(["font-code",{_alt:!e.i18nSetStore.isFoldersMode}]),readonly:"",cols:"50",rows:"20",value:e.i18nSetStore.isFoldersMode?`└─[locales]    --> ${e.$t("msgs.drag_folder_here")}!
   ├─de-DE
   │  └─index.json
   ├─en-US
   │  └─index.json
   ├─es-ES
   │  └─index.json
   ├─fr-FR
   │  └─index.json
   ├─ja-JP
   │  └─index.json
   ├─kr-KR
   │  └─index.json
   ├─zh-CN
   │  └─index.json
   └─zh-TW
      └─index.json`:`└─[locales]    --> ${e.$t("msgs.drag_folder_here")}!
   ├─ ar.json
   ├─ cn.json
   ├─ de.json
   ├─ en.json
   ├─ es.json
   ├─ fr.json
   ├─ it.json
   ├─ jp.json
   └─ kr.json
`},null,10,uc)]))]))])]),_:1})]),_:1})]),K(ne,{visible:e.isShowToolSettings,"onUpdate:visible":t[8]||(t[8]=B=>e.isShowToolSettings=B)},null,8,["visible"])],32)}const bc=Je(nc,[["render",fc]]);export{bc as default};
