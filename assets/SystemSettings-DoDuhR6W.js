import{d as e,D as a,c7 as t,c8 as o,_ as s,o as n,p as l,M as i,b as r,F as c,m,bV as d,bW as u,r as p,K as g,L as b,aN as _,a as y,c9 as h,u as f,ab as w,c as v,ca as k,cb as S,a5 as C,cc as I,k as x,x as T,Z as j,aM as A,U as L,af as D,G as W,Q as P,f as V,P as $,X as K,e as O,T as B,g as U}from"./index-Dcsrw7an.js";import{_ as E}from"./index.vue_vue_type_style_index_0_lang-Df9XRKpL.js";import{T as F}from"./TabLayout-C1UfuSWM.js";/* empty css                   */import{S as N,_ as R}from"./index.vue_vue_type_script_setup_true_lang-D-CNzH-9.js";/* empty css                  */import{u as M}from"./useIDBKeyval-DAptoUO-.js";import{_ as H}from"./SettingsAi.vue_vue_type_script_setup_true_lang-CKnPlJ2w.js";import{I as z}from"./I18nToolSettings-B23Yc7qA.js";import"./use-model-wrapper-D-qKYU8I.js";/* empty css                  */import"./RectSwitch-DyIQ1C31.js";import"./use-common-ai-BUoKJvYz.js";import"./enum-CdO7LyZZ.js";import"./i18n-tool-settings-DxxnBFQw.js";const G=s(e({name:"LanguageChooser",setup(){const{t:e}=a();return{languages:t,handleLanguageSelect(a){o(a),window.$dialog.confirm(e("msgs.refresh_page"),e("actions.confirm"),{type:"warning"}).then((()=>{location.reload()})).catch()}}}}),[["render",function(e,a,t,o,s,p){const g=d,b=u;return n(),l(b,{class:"language-chooser",modelValue:e.$i18n.locale,"onUpdate:modelValue":a[0]||(a[0]=a=>e.$i18n.locale=a),onChange:e.handleLanguageSelect},{default:i((()=>[(n(!0),r(c,null,m(e.languages,(e=>(n(),l(g,{key:e.locale,label:e.name,value:e.locale},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])}],["__scopeId","data-v-5abd5f5f"]]),Q=e({__name:"SettingsCommon",setup(e){const{t:t}=a(),o=y(),{themeOptions:s}=h(),i=()=>{let e='<b><a style="color: inherit" href="https://www.dujin.org/12142.html" target="_blank">随机壁纸API</a></b>';return[{label:"Bing",url:"https://api.dujin.org/bing/1920.php"}].forEach((a=>{e+=`<br>${a.label}: <a style="color: inherit" href="${a.url}" target="_blank">${a.url}</a>`})),e},r=f(),c=w(),{isLoading:m,importAllSettings:d,exportAllSettings:u}=(()=>{const e=p(!1);a();const t=(e,a)=>{const{set:t,data:o,isFinished:s}=M(e,{});return new Promise((e=>{g(s,(s=>{s&&(t(a),e(o.value))}))}))},o=e=>{const{set:a,data:t,isFinished:o}=M(e,{});return new Promise((e=>{g(o,(a=>{a&&e(t.value)}))}))};return{isLoading:e,idbRestoreData:t,idbBackupData:o,importAllSettings:async()=>{try{e.value=!0;const a=await window.$mcUtils.handleImportJson();if(!a.backupSettingsVersion)throw new Error("Invalid settings json file!");for(const e in a.localStorageData){const t=a.localStorageData[e];t&&localStorage.setItem(e,t)}for(const e in a.idbKeyValData){const o=a.idbKeyValData[e];o&&await t(e,o)}location.reload()}catch(a){window.$message.error(a.message),console.error(a)}finally{e.value=!1}},exportAllSettings:async()=>{try{e.value=!0;const a={backupSettingsVersion:1,localStorageData:{},idbKeyValData:{}};Object.values(b).forEach((e=>{const t=localStorage.getItem(e);console.log("[LS_SettingsKey] Backup: ",{key:e,data:t}),a.localStorageData[e]=t}));for(const e in _){const t=_[e];if(/_handle_history$/.test(t))console.warn(`[IDBSettingsKey] Skip backup ${t} because it contains FileSystemFileHandle`);else{const e=await o(t);console.log("[IDBSettingsKey] Backup: ",{key:t,data:e}),a.idbKeyValData[t]=e}}console.log(a.idbKeyValData),window.$mcUtils.handleExportFile(await window.$mcUtils.promptGetFileName(void 0,"PageCraft_Toolbox_All_Settings"),JSON.stringify(a,null,2),".json")}catch(a){window.$message.error(a.message),console.error(a)}finally{e.value=!1}}}})(),A=v((()=>[{label:t("common.personalization"),key:"personalization",children:[{label:t("common.theme_color"),key:"themeColor",iconClass:"mdi mdi-palette",store:o,type:N.COLOR_PICKER},{label:t("common.wallpaper"),key:"desktopWallpaper",iconClass:"mdi mdi-wallpaper",store:o,type:N.INPUT,tips:i(),placeholder:"optional"},!o.desktopWallpaper&&{label:t("common.bg_color"),key:"desktopBgColor",iconClass:"mdi mdi-format-color-fill",store:o,type:N.COLOR_PICKER},{label:t("common.theme"),key:"customTheme",iconClass:"mdi mdi-palette-swatch-variant",store:o,type:N.SELECT,options:s.value,props:{"onUpdate:value":e=>{o.ldTheme=k.LIGHT}}},{label:t("actions.toggle_ld_theme"),key:"ldTheme",iconClass:"mdi mdi-brightness-4",store:o,type:N.MULTIPLE_SWITCH,options:S},{label:t("common.disable_animation"),subtitle:t("common.eink_optimization"),key:"disableAnimation",iconClass:"mdi mdi-transition",store:o,type:N.SWITCH}].filter(Boolean)},{label:"PageCraft",key:"pagecraft",children:[{label:t("common.top_layout"),key:"enableTopLayout",iconClass:"mdi mdi-dock-top",store:o,type:N.SWITCH},{label:t("common.sound_fx"),key:"enableSoundFx",iconClass:"mdi mdi-music-accidental-flat",store:o,type:N.SWITCH}]},{label:t("common.common"),key:"common",children:[{label:t("msgs.focus_auto_action")+" (ctrl+alt+a)",subtitle:t("msgs.focus_auto_action_desc"),iconClass:"mdi mdi-button-pointer",tips:'⚡ 搭配AHK脚本使用，效率更佳！<br><pre style="max-height: 300px;overflow: auto;color: greenyellow;box-sizing:border-box;padding:5px;background-color: black">\n#Persistent ; 让脚本持续运行\nSetTitleMatchMode, 2 ; 设置窗口标题匹配模式为包含模式\n; 按F2执行操作\nF2::\n    ; 按下 Ctrl+C\n    Send, ^c\n    ; 获取当前活动窗口的句柄\n    WinGet, originalWindow, ID, A\n    ; 切换到标题包含 "PageCraft" 的窗口\n    IfWinExist, PageCraft\n    {\n        WinActivate ; 激活找到的窗口\n        Sleep, 50 ; 等待50毫秒\n    }\n    ; 切换回原窗口\n    If (originalWindow)\n    {\n        WinActivate, ahk_id %originalWindow% ; 激活之前活动的窗口\n    }\n    ; 按下 Ctrl+V\n    Send, ^v\nreturn\n</pre>',key:"enableFocusAutoAction",store:o,type:N.SWITCH},{label:t("msgs.bei_fen_yu_huan_yuan"),subtitle:t("msgs.dao_ru_dao_chu_quan"),iconClass:"mdi mdi-backup-restore",actionRender:()=>C("div",{class:"flex-row-center-gap"},[C("button",{class:"vp-button",onClick(){window.$dialog.confirm(t("msgs.will_override_existe"),t("actions.confirm"),{type:"warning"}).then((()=>{d()}))}},t("actions.import")),C("button",{class:"vp-button",onClick(){u()}},t("actions.export"))])}]},{label:t("common.system"),key:"system",children:[{label:"Language",key:"language",iconClass:"mdi mdi-translate",actionRender:C(G)},window.__TAURI__&&{label:t("msgs.auto_check_update"),key:"autoCheckUpdate",iconClass:"mdi mdi-cellphone-arrow-down",subtitle:r.upgradeInfo,store:o,type:N.SWITCH},{label:I(),subtitle:`Copyright © 2022-${(new Date).getFullYear()} canwdev`,iconClass:"mdi mdi-github",actionRender:()=>C("div",{class:"flex-row-center-gap"},[C("button",{class:"vp-button",onClick(){r.isShowQuickLaunch=!1,r.isShowSettings=!1,c.push({name:"RichTextTool",query:{is_release_notes:"1"}})}},t("msgs.release_notes")),C("a",{style:"color: inherit;",href:"https://github.com/canwdev/page-craft-vite",target:"_blank",rel:"noopener noreferrer"},"Github")])}].filter(Boolean)}]));return(e,a)=>{const t=j;return x((n(),l(R,{"option-list":T(A)},null,8,["option-list"])),[[t,T(m)]])}}}),q={class:"settings-content"},J=s(e({__name:"SystemSettings",props:{visible:{type:Boolean,default:!1}},emits:["update:visible"],setup(e,{emit:t}){const{t:o}=a(),s=p([{label:o("common.common"),value:A.COMMON},{label:"AI",value:A.AI},{label:o("i18n_tools.i18_n"),value:A.I18N}]),r=p(A.COMMON),c=L(e,"visible",t);return D(W.OPEN_SETTINGS,(e=>{c.value=!0,e&&(r.value=e)})),(e,a)=>(n(),l(E,{visible:T(c),"onUpdate:visible":a[1]||(a[1]=e=>K(c)?c.value=e:null),class:"system-settings-window",wid:"settings","init-win-options":{width:"380px",height:"500px"}},{titleBarLeft:i((()=>[P("⚙️ "+V(T(o)("common.settings")),1)])),default:i((()=>[$(F,{class:"system-settings",horizontal:"",modelValue:T(r),"onUpdate:modelValue":a[0]||(a[0]=e=>K(r)?r.value=e:null),options:T(s)},{default:i((()=>[O("div",q,[$(B,{mode:"out-in",name:"fade-up"},{default:i((()=>[T(r)===T(A).COMMON?(n(),l(Q,{key:0})):T(r)===T(A).AI?(n(),l(H,{key:1})):T(r)===T(A).I18N?(n(),l(z,{key:2})):U("",!0)])),_:1})])])),_:1},8,["modelValue","options"])])),_:1},8,["visible"]))}}),[["__scopeId","data-v-0db3059d"]]);export{J as default};
