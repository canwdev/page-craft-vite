import{K as e,d as n,t,r as o,I as a,J as i,aG as r,aH as l,a5 as s,O as u,U as d,aI as c,_ as m,i as p,o as f,b as v,P as y,a9 as g,e as h,k as b,v as k,x as C,X as w,q as V,L as S,u as _,M as x,p as E,g as M,av as j}from"./index-Dcsrw7an.js";import{C as D}from"./CommonNavbar-CYqCX-Ap.js";import{T as L}from"./TabLayout-C1UfuSWM.js";import{_ as O}from"./MarkdownRender.vue_vue_type_script_setup_true_lang-DujZSKAj.js";import"./use-model-wrapper-D-qKYU8I.js";var A,U=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],B=function(e){return-1!==U.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},I=function(n,t,o,a,i,r){a.setContent(r()),o.attrs["onUpdate:modelValue"]&&function(n,t,o,a){var i=n.modelEvents?n.modelEvents:null,r=Array.isArray(i)?i.join(" "):i;e(a,(function(e,t){o&&"string"==typeof e&&e!==t&&e!==o.getContent({format:n.outputFormat})&&o.setContent(e)})),o.on(r||"change input undo redo",(function(){t.emit("update:modelValue",o.getContent({format:n.outputFormat}))}))}(t,o,a,i),function(e,n,t){Object.keys(n).filter(B).forEach((function(o){var a=n[o];"function"==typeof a&&("onInit"===o?a(e,t):t.on(o.substring(2),(function(e){return a(e,t)})))}))}(n,o.attrs,a)},P=0,R=function(e){var n=Date.now();return e+"_"+Math.floor(1e9*Math.random())+ ++P+String(n)},T=function(e){return void 0===e||""===e?[]:Array.isArray(e)?e:e.split(" ")},K=function(){return{listeners:[],scriptId:R("tiny-script"),scriptLoaded:!1}},F=(A=K(),{load:function(e,n,t){A.scriptLoaded?t():(A.listeners.push(t),e.getElementById(A.scriptId)||function(e,n,t,o){var a=n.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=e,a.src=t;var i=function(){a.removeEventListener("load",i),o()};a.addEventListener("load",i),n.head&&n.head.appendChild(a)}(A.scriptId,e,n,(function(){A.listeners.forEach((function(e){return e()})),A.scriptLoaded=!0})))},reinitialize:function(){A=K()}}),N=function(){var e="undefined"!=typeof window?window:global;return e&&e.tinymce?e.tinymce:null},z={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return"html"===e||"text"===e}}},G=function(){return G=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},G.apply(this,arguments)},H={selector:void 0,target:void 0},q=n({props:z,setup:function(n,d){var c=n.init?G(G({},n.init),H):G({},H),m=t(n),p=m.disabled,f=m.modelValue,v=m.tagName,y=o(null),g=null,h=n.id||R("tiny-vue"),b=n.init&&n.init.inline||n.inline,k=!!d.attrs["onUpdate:modelValue"],C=!0,w=n.initialValue?n.initialValue:"",V="",S=function(){var e,t,o,a=(e=C,k?function(){return(null==f?void 0:f.value)?f.value:""}:function(){return e?w:V}),i=G(G({},c),{readonly:n.disabled,target:y.value,plugins:(t=c.plugins,o=n.plugins,T(t).concat(T(o))),toolbar:n.toolbar||c.toolbar,inline:b,setup:function(e){g=e,e.on("init",(function(t){return I(t,n,d,e,f,a)})),"function"==typeof c.setup&&c.setup(e)}});(function(e){return null!==e&&"textarea"===e.tagName.toLowerCase()})(y.value)&&(y.value.style.visibility=""),N().init(i),C=!1};e(p,(function(e){var n;null!==g&&("function"==typeof(null===(n=g.mode)||void 0===n?void 0:n.set)?g.mode.set(e?"readonly":"design"):g.setMode(e?"readonly":"design"))})),e(v,(function(e){var n;k||(V=g.getContent()),null===(n=N())||void 0===n||n.remove(g),u((function(){return S()}))})),a((function(){if(null!==N())S();else if(y.value&&y.value.ownerDocument){var e=n.cloudChannel?n.cloudChannel:"6",t=n.apiKey?n.apiKey:"no-api-key",o=null==n.tinymceScriptSrc?"https://cdn.tiny.cloud/1/".concat(t,"/tinymce/").concat(e,"/tinymce.min.js"):n.tinymceScriptSrc;F.load(y.value.ownerDocument,o,S)}})),i((function(){null!==N()&&N().remove(g)})),b||(r((function(){C||S()})),l((function(){var e;k||(V=g.getContent()),null===(e=N())||void 0===e||e.remove(g)})));return d.expose({rerender:function(e){var n;V=g.getContent(),null===(n=N())||void 0===n||n.remove(g),c=G(G(G({},c),e),H),u((function(){return S()}))},getEditor:function(){return g}}),function(){return b?function(e,n,t,o){return e(o||"div",{id:n,ref:t})}(s,h,y,n.tagName):s("textarea",{id:h,visibility:"hidden",ref:y})}}});const J=n({name:"TinyMceEditor",components:{Editor:q},inheritAttrs:!1,props:{modelValue:{type:String,default:""},minimal:{type:Boolean,default:!1},dark:{type:Boolean,default:!1},contentCss:{type:String,default:"dark"}},emits:["update:modelValue","valueChange"],setup(e,{emit:n}){const{contentCss:a,minimal:i,dark:r}=t(e),l=o({body_class:"detail-rich-text",skin:r.value?"oxide-dark":"oxide",content_css:a.value,verify_html:!1,plugins:["advlist","autolink","link","image","lists","charmap","preview","anchor","pagebreak","searchreplace","wordcount","visualblocks","visualchars","code","fullscreen","insertdatetime","media","table","emoticons","template","help"],menubar:i.value?"":"edit view insert format tools table help",height:600,content_style:"img {max-width: 100%;}",toolbar:i.value?["styles bold italic alignleft aligncenter alignright alignjustify bullist numlist forecolor backcolor"]:["undo redo | styles | bold italic | alignleft aligncenter alignright alignjustify | ","bullist numlist outdent indent | link image | print preview media fullscreen | forecolor backcolor emoticons"],relative_urls:!1,remove_script_host:!1,image_dimensions:!1}),s=d(e,"modelValue",n),u=o(!1);return c("lib/tinymce-6.0.3/tinymce.min.js",(e=>{u.value=!0})),{mValue:s,initOptions:l,isLoaded:u}}}),X={key:0,class:"tiny-mce-editor"},$={key:1};const Q=m(J,[["render",function(e,n,t,o,a,i){const r=p("Editor");return e.isLoaded?(f(),v("div",X,[y(r,g({modelValue:e.mValue,"onUpdate:modelValue":n[0]||(n[0]=n=>e.mValue=n),init:e.initOptions},e.$attrs),null,16,["modelValue","init"])])):(f(),v("div",$,"Loading..."))}]]),W={class:"markdown-editor"},Y={class:"editor-container"},Z={class:"editor-input font-code"},ee=n({__name:"MarkdownEditor",props:{modelValue:{default:""},dark:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:n}){const t=d(e,"modelValue",n);return(e,n)=>(f(),v("div",W,[h("div",Y,[h("div",Z,[b(h("textarea",{class:"vp-input","onUpdate:modelValue":n[0]||(n[0]=e=>w(t)?t.value=e:null),placeholder:"Input markdown content"},null,512),[[k,C(t)]])]),y(O,{class:"editor-preview",dark:e.dark,text:C(t)},null,8,["dark","text"])])]))}}),ne={class:"rich-text-tool-wrap scrollbar-mini"},te=m(n({__name:"RichTextTool",setup(n){const t=V(S.RICH_TEXT_TOOL_VALUE,""),a=_(),i=j(),r=o("markdown");return e((()=>i.query),(e=>{e&&e.is_release_notes&&(async()=>{const e=await fetch("./release-notes.md");t.value=await e.text()})()}),{immediate:!0}),(e,n)=>(f(),v("div",ne,[y(D),y(L,{class:"rich-text-tool-main",horizontal:"",modelValue:C(r),"onUpdate:modelValue":n[2]||(n[2]=e=>w(r)?r.value=e:null),options:[{label:"Markdown",value:"markdown"},{label:"Tiny MCE",value:"tinymce"}]},{default:x((()=>["markdown"===C(r)?(f(),E(ee,{key:0,dark:C(a).isAppDarkMode,modelValue:C(t),"onUpdate:modelValue":n[0]||(n[0]=e=>w(t)?t.value=e:null)},null,8,["dark","modelValue"])):"tinymce"===C(r)?(f(),E(Q,{key:1,dark:C(a).isAppDarkMode,"content-css":C(a).isAppDarkMode?"dark":"",modelValue:C(t),"onUpdate:modelValue":n[1]||(n[1]=e=>w(t)?t.value=e:null)},null,8,["dark","content-css","modelValue"])):M("",!0)])),_:1},8,["modelValue"])]))}}),[["__scopeId","data-v-b962ea3e"]]);export{te as default};
