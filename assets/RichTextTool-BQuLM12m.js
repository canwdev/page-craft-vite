import{P as e,d as n,t,r as o,N as a,O as i,c8 as r,c9 as l,a8 as s,S as u,Y as d,ca as c,_ as p,q as m,e as f,o as v,U as g,ac as y,f as h,k,v as b,y as C,a1 as S,s as V,L as w,u as _,aB as x,Q as E,p as M,g as D}from"./index-BJklM7uy.js";import{T as O}from"./TabLayout-r0pFeegw.js";import{_ as j}from"./MarkdownRender.vue_vue_type_script_setup_true_lang-5feYFoeZ.js";import"./use-model-wrapper-Cm8bqa9M.js";var A,L=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],P=function(e){return-1!==L.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},U=function(n,t,o,a,i,r){a.setContent(r()),o.attrs["onUpdate:modelValue"]&&function(n,t,o,a){var i=n.modelEvents?n.modelEvents:null,r=Array.isArray(i)?i.join(" "):i;e(a,(function(e,t){o&&"string"==typeof e&&e!==t&&e!==o.getContent({format:n.outputFormat})&&o.setContent(e)})),o.on(r||"change input undo redo",(function(){t.emit("update:modelValue",o.getContent({format:n.outputFormat}))}))}(t,o,a,i),function(e,n,t){Object.keys(n).filter(P).forEach((function(o){var a=n[o];"function"==typeof a&&("onInit"===o?a(e,t):t.on(o.substring(2),(function(e){return a(e,t)})))}))}(n,o.attrs,a)},B=0,I=function(e){var n=Date.now();return e+"_"+Math.floor(1e9*Math.random())+ ++B+String(n)},R=function(e){return void 0===e||""===e?[]:Array.isArray(e)?e:e.split(" ")},T=function(){return{listeners:[],scriptId:I("tiny-script"),scriptLoaded:!1}},N=(A=T(),{load:function(e,n,t){A.scriptLoaded?t():(A.listeners.push(t),e.getElementById(A.scriptId)||function(e,n,t,o){var a=n.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=e,a.src=t;var i=function(){a.removeEventListener("load",i),o()};a.addEventListener("load",i),n.head&&n.head.appendChild(a)}(A.scriptId,e,n,(function(){A.listeners.forEach((function(e){return e()})),A.scriptLoaded=!0})))},reinitialize:function(){A=T()}}),F=function(){var e="undefined"!=typeof window?window:global;return e&&e.tinymce?e.tinymce:null},K={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return"html"===e||"text"===e}}},z=function(){return z=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var a in n=arguments[t])Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},z.apply(this,arguments)},G={selector:void 0,target:void 0},H=n({props:K,setup:function(n,d){var c=n.init?z(z({},n.init),G):z({},G),p=t(n),m=p.disabled,f=p.modelValue,v=p.tagName,g=o(null),y=null,h=n.id||I("tiny-vue"),k=n.init&&n.init.inline||n.inline,b=!!d.attrs["onUpdate:modelValue"],C=!0,S=n.initialValue?n.initialValue:"",V="",w=function(){var e,t,o,a=(e=C,b?function(){return(null==f?void 0:f.value)?f.value:""}:function(){return e?S:V}),i=z(z({},c),{readonly:n.disabled,target:g.value,plugins:(t=c.plugins,o=n.plugins,R(t).concat(R(o))),toolbar:n.toolbar||c.toolbar,inline:k,setup:function(e){y=e,e.on("init",(function(t){return U(t,n,d,e,f,a)})),"function"==typeof c.setup&&c.setup(e)}});(function(e){return null!==e&&"textarea"===e.tagName.toLowerCase()})(g.value)&&(g.value.style.visibility=""),F().init(i),C=!1};e(m,(function(e){var n;null!==y&&("function"==typeof(null===(n=y.mode)||void 0===n?void 0:n.set)?y.mode.set(e?"readonly":"design"):y.setMode(e?"readonly":"design"))})),e(v,(function(e){var n;b||(V=y.getContent()),null===(n=F())||void 0===n||n.remove(y),u((function(){return w()}))})),a((function(){if(null!==F())w();else if(g.value&&g.value.ownerDocument){var e=n.cloudChannel?n.cloudChannel:"6",t=n.apiKey?n.apiKey:"no-api-key",o=null==n.tinymceScriptSrc?"https://cdn.tiny.cloud/1/".concat(t,"/tinymce/").concat(e,"/tinymce.min.js"):n.tinymceScriptSrc;N.load(g.value.ownerDocument,o,w)}})),i((function(){null!==F()&&F().remove(y)})),k||(r((function(){C||w()})),l((function(){var e;b||(V=y.getContent()),null===(e=F())||void 0===e||e.remove(y)})));return d.expose({rerender:function(e){var n;V=y.getContent(),null===(n=F())||void 0===n||n.remove(y),c=z(z(z({},c),e),G),u((function(){return w()}))},getEditor:function(){return y}}),function(){return k?function(e,n,t,o){return e(o||"div",{id:n,ref:t})}(s,h,g,n.tagName):s("textarea",{id:h,visibility:"hidden",ref:g})}}});const q=n({name:"TinyMceEditor",components:{Editor:H},inheritAttrs:!1,props:{modelValue:{type:String,default:""},minimal:{type:Boolean,default:!1},dark:{type:Boolean,default:!1},contentCss:{type:String,default:"dark"}},emits:["update:modelValue","valueChange"],setup(e,{emit:n}){const{contentCss:a,minimal:i,dark:r}=t(e),l=o({body_class:"detail-rich-text",skin:r.value?"oxide-dark":"oxide",content_css:a.value,verify_html:!1,plugins:["advlist","autolink","link","image","lists","charmap","preview","anchor","pagebreak","searchreplace","wordcount","visualblocks","visualchars","code","fullscreen","insertdatetime","media","table","emoticons","template","help"],menubar:i.value?"":"edit view insert format tools table help",height:600,content_style:"img {max-width: 100%;}",toolbar:i.value?["styles bold italic alignleft aligncenter alignright alignjustify bullist numlist forecolor backcolor"]:["undo redo | styles | bold italic | alignleft aligncenter alignright alignjustify | ","bullist numlist outdent indent | link image | print preview media fullscreen | forecolor backcolor emoticons"],relative_urls:!1,remove_script_host:!1,image_dimensions:!1}),s=d(e,"modelValue",n),u=o(!1);return c("lib/tinymce-6.0.3/tinymce.min.js",(e=>{u.value=!0})),{mValue:s,initOptions:l,isLoaded:u}}}),Q={key:0,class:"tiny-mce-editor"},X={key:1};const Y=p(q,[["render",function(e,n,t,o,a,i){const r=m("Editor");return e.isLoaded?(v(),f("div",Q,[g(r,y({modelValue:e.mValue,"onUpdate:modelValue":n[0]||(n[0]=n=>e.mValue=n),init:e.initOptions},e.$attrs),null,16,["modelValue","init"])])):(v(),f("div",X,"Loading..."))}]]),$={class:"markdown-editor"},J={class:"editor-container"},W={class:"editor-input font-code"},Z=n({__name:"MarkdownEditor",props:{modelValue:{default:""},dark:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:n}){const t=d(e,"modelValue",n);return(e,n)=>(v(),f("div",$,[h("div",J,[h("div",W,[k(h("textarea",{class:"vp-input","onUpdate:modelValue":n[0]||(n[0]=e=>S(t)?t.value=e:null),placeholder:"Input markdown content"},null,512),[[b,C(t)]])]),g(j,{class:"editor-preview",dark:e.dark,text:C(t)},null,8,["dark","text"])])]))}}),ee={class:"rich-text-tool-wrap scrollbar-mini"},ne=p(n({__name:"RichTextTool",props:{appParams:{}},setup(n){const t=n,a=V(w.RICH_TEXT_TOOL_VALUE,"",localStorage,{listenToStorageChanges:!1}),i=_();x();const r=o("markdown");return e((()=>t.appParams),(()=>{console.log(t.appParams),t.appParams&&t.appParams.isReleaseNotes&&(async()=>{const e=await fetch("./release-notes.md");a.value=await e.text()})()}),{immediate:!0}),(e,n)=>(v(),f("div",ee,[g(O,{class:"rich-text-tool-main",horizontal:"",modelValue:C(r),"onUpdate:modelValue":n[2]||(n[2]=e=>S(r)?r.value=e:null),options:[{label:"Markdown",value:"markdown"},{label:"Tiny MCE",value:"tinymce"}]},{default:E((()=>["markdown"===C(r)?(v(),M(Z,{key:0,dark:C(i).isAppDarkMode,modelValue:C(a),"onUpdate:modelValue":n[0]||(n[0]=e=>S(a)?a.value=e:null)},null,8,["dark","modelValue"])):"tinymce"===C(r)?(v(),M(Y,{key:1,dark:C(i).isAppDarkMode,"content-css":C(i).isAppDarkMode?"dark":"",modelValue:C(a),"onUpdate:modelValue":n[1]||(n[1]=e=>S(a)?a.value=e:null)},null,8,["dark","content-css","modelValue"])):D("",!0)])),_:1},8,["modelValue"])]))}}),[["__scopeId","data-v-186c1c4b"]]);export{ne as default};
