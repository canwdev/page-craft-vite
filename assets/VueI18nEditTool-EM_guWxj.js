import{_ as e,a,u as s,i as o}from"./file-history-3D-TXPmd.js";import{d as t,c as l,x as i,B as n,R as r,g as c,h as u,r as d,S as p,L as m,i as v,k as w,U as g,m as h,V as f,W as y,b,y as S,z as k,A as _,J as x,K as T,D,C as O,F as H,G as F,H as C,I as N,e as R}from"./index-rEcj-vtq.js";import{_ as z,u as V,a as $,c as A,d as I,b as J}from"./use-meta-1H3LyBl7.js";const B={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},W=[n("g",{fill:"none"},[n("path",{d:"M3 5a2 2 0 0 1 2-2h8.379a2 2 0 0 1 1.414.586l1.621 1.621A2 2 0 0 1 17 6.621V15a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5zm2-1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1v-4.5A1.5 1.5 0 0 1 6.5 10h7a1.5 1.5 0 0 1 1.5 1.5V16a1 1 0 0 0 1-1V6.621a1 1 0 0 0-.293-.707l-1.621-1.621A1 1 0 0 0 13.379 4H13v2.5A1.5 1.5 0 0 1 11.5 8h-4A1.5 1.5 0 0 1 6 6.5V4H5zm2 0v2.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5V4H7zm7 12v-4.5a.5.5 0 0 0-.5-.5h-7a.5.5 0 0 0-.5.5V16h8z",fill:"currentColor"})],-1)],L=t({name:"Save20Regular",render:function(e,a){return l(),i("svg",B,W)}}),j={types:[{description:"JSON",accept:{"application/JSON":[".json"]}}]},E=t({name:"VueI18nEditTool",components:{QuickOptions:r,I18nToolSettings:e,TranslateTreeItem:a,DropZone:z,Save20Regular:L},setup(){const{t:e}=c(),a=u(),t=d(p.parseWithRoot()),l=d(!1),{appendHistory:i,historyMenuOptions:n}=s(m.I18N_FILE_HANDLE_HISTORY,(async e=>{r.value=e;const a=await e.getFile();await b(a)})),r=v(),b=async e=>{try{l.value=!0;const a=await f(e),s=JSON.parse(a);t.value=p.parseWithRoot(s)}catch(a){console.error(a),window.$message.error(a.message)}finally{l.value=!1}},S=async()=>{const[e]=await window.showOpenFilePicker(j);await i(e),r.value=e;const a=await e.getFile();await b(a)},k=()=>{r.value=void 0,t.value=p.parseWithRoot()},_=async()=>{try{if(l.value=!0,!r.value)return;const a=await r.value.createWritable(),s=JSON.stringify(y(t.value),null,2);await a.write(s),await a.close(),window.$message.success(e("msgs.saved"))}catch(a){console.error(a),window.$message.error(a.message)}finally{l.value=!1}},x=async()=>{var a;try{l.value=!0,console.log(t.value);const s=JSON.stringify(y(t.value),null,2),o=await window.showSaveFilePicker({suggestedName:null==(a=r.value)?void 0:a.name,...j}),i=await o.createWritable();await i.write(s),await i.close(),window.$message.success(e("msgs.saved"))}catch(s){console.error(s),window.$message.error(s.message)}finally{l.value=!1}},{metaTitle:T}=V();w((()=>{r.value?_():x()})),g((()=>!!r.value));const D=d(!1),O=()=>{t.value=p.parseWithRoot({hello_world:{section_a:{test_str:"This is a test string",test_arr:["line 1","line 2","line 3"],test_number:114514},section_b:{"":"Blur this input and it'll generate the key automatically!"},section_c:{"":"ä¸­æ–‡ is Supported"}}})},H=h((()=>[{label:e("common.settings"),props:{onClick:()=>{D.value=!0}}},{label:e("common.tools"),props:{onClick:()=>{a.isShowQuickLaunch=!0}}},r.value?{label:"ðŸ’» "+e("actions.close")+" JSON",children:[{label:e(e("msgs.confirm_close")),props:{onClick:k,isBack:!0}}]}:{label:"ðŸ’»  "+e("actions.open")+" JSON",props:{onClick:()=>{S()}},dropdown:n.value},r.value?{label:"ðŸ’¾ "+e("actions.save"),props:{onClick:()=>{_()}}}:null,{label:e("actions.save_as")+"...",props:{onClick:()=>{x()}}},{label:e("common.demo"),children:[{label:e("msgs.load_demo_this_will"),props:{onClick:O,isBack:!0}}]}].filter(Boolean)));return{metaTitle:T,translateTreeRoot:t,fileHandle:r,handleImport:b,handleSelectFile:S,handleCloseFile:k,handleSaveFile:_,handleExport:x,loadDemo:O,iconTranslate:o,...$({cb:async e=>{try{l.value=!0;for(const a of e.dataTransfer.items)if("file"===a.kind){const e=await a.getAsFileSystemHandle();if("directory"!==e.kind){await i(e),r.value=e;const a=await e.getFile();await b(a)}else window.$message.error("Please drag and drop a json file here!")}}catch(a){console.error(a),window.$message.error(a.message)}finally{l.value=!1}}}),mainStore:a,isShowToolSettings:D,isLoading:l,menuOptions:H}}}),P={key:0,class:"mc-loading-container position-fixed"},M={class:"vp-bg navbar-wrap",style:{position:"sticky",top:"0","z-index":"100","margin-bottom":"10px"}},Q={class:"_container"},U=n("div",{class:"height-placeholder"},null,-1);const G=b(E,[["render",function(s,o,t,c,u,d){const p=I,m=z,v=J,w=r,g=A,h=a,f=e;return l(),i("div",{class:"vue-i18n-edit-tool i18n-style",onDragover:o[2]||(o[2]=D(((...e)=>s.fileDragover&&s.fileDragover(...e)),["prevent","stop"])),onDragleave:o[3]||(o[3]=D((e=>s.showDropzone=!1),["prevent","stop"])),onDrop:o[4]||(o[4]=D(((...e)=>s.fileDrop&&s.fileDrop(...e)),["prevent","stop"]))},[S(_,{name:"mc-fade"},{default:k((()=>[s.isLoading?(l(),i("div",P,[S(p)])):O("",!0)])),_:1}),S(_,{name:"mc-fade"},{default:k((()=>[H(S(m,{"position-fixed":"",text:s.$t("msgs.drag_file_here")},null,8,["text"]),[[F,s.showDropzone]])])),_:1}),n("div",M,[S(g,{subtitle:"",onBack:o[0]||(o[0]=e=>s.$router.push({name:"HomePage"}))},{title:k((()=>[C(N(s.metaTitle),1)])),avatar:k((()=>[S(v,{src:s.iconTranslate,style:{background:"none"}},null,8,["src"])])),extra:k((()=>[S(w,{"is-static":"",options:s.menuOptions,horizontal:"","auto-focus":!1,"item-cls":"vp-button"},null,8,["options"])])),_:1})]),n("div",Q,[(l(!0),i(x,null,T(s.translateTreeRoot,((e,a)=>{var o;return l(),R(h,{key:a,item:e,index:a,title:null==(o=s.fileHandle)?void 0:o.name},null,8,["item","index","title"])})),128))]),U,S(f,{visible:s.isShowToolSettings,"onUpdate:visible":o[1]||(o[1]=e=>s.isShowToolSettings=e)},null,8,["visible"])],32)}]]);export{G as default};
